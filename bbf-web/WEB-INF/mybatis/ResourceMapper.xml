<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.newland.boss.kpi.admin.dao.ResourceDao">

	<resultMap type="com.newland.boss.kpi.admin.model.Resource" id="resourceResultMap">
		<id column="RESOURCE_ID" property="resourceId" jdbcType="INTEGER" />
		<result column="SUPER_RESOURCE_ID" property="superResourceId" jdbcType="INTEGER" />
		<result column="RESOURCE_NAME" property="resourceName" jdbcType="VARCHAR" />
		<result column="RESOURCE_URL" property="resourceUrl" jdbcType="VARCHAR" />
		<result column="RESOURCE_TYPE" property="resourceType" jdbcType="INTEGER" />
		<result column="CREATE_TIME" property="createTime" jdbcType="TIMESTAMP" />
		<result column="MODIFY_TIME" property="modifyTime" jdbcType="TIMESTAMP" />
		<result column="MODIFY_OPERATOR_ID" property="modifyOperatorId" jdbcType="INTEGER" />
	</resultMap>
	
	<!-- 查找所有资源 -->
	<select id="selectAllResource" resultMap="resourceResultMap">
		SELECT * FROM T_RESOURCE ORDER BY RESOURCE_ID
	</select>
	
	<!-- 添加资源 -->
	<insert id="insertResource" parameterType="com.newland.boss.kpi.admin.model.Resource">
		INSERT INTO T_RESOURCE(RESOURCE_ID,SUPER_RESOURCE_ID,RESOURCE_NAME,RESOURCE_URL
			,RESOURCE_TYPE,CREATE_TIME,MODIFY_TIME,MODIFY_OPERATOR_ID)
       		VALUES(seq_resource.nextval,#{superResourceId},#{resourceName},#{resourceUrl},#{resourceType}
       		,sysdate,#{modifyTime,jdbcType=VARCHAR},#{modifyOperatorId})
	</insert>
	
	<!-- 通过ID找到资源 -->
	<select id="selectResourceById" parameterType="INTEGER" resultMap="resourceResultMap">
		SELECT * FROM T_RESOURCE WHERE RESOURCE_ID = #{resourceId}
	</select>
	
	<!-- 资源修改 -->
	<update id="updateResource" parameterType="com.newland.boss.kpi.admin.model.Resource">
		UPDATE T_RESOURCE SET RESOURCE_NAME = #{resourceName}
    	 	,RESOURCE_URL = #{resourceUrl},RESOURCE_TYPE = #{resourceType},
    	 	MODIFY_TIME = sysdate ,MODIFY_OPERATOR_ID = #{modifyOperatorId}
    	 	WHERE RESOURCE_ID = #{resourceId}
	</update>

	<!-- 删除资源 -->
	<delete id="deleteResource" parameterType="INTEGER">
		DELETE FROM T_RESOURCE WHERE RESOURCE_ID = #{resourceId}
	</delete>
	
	<!-- 模糊搜索资源 -->
	<select id="fuzzySearchResource" resultMap="resourceResultMap">
		SELECT * FROM T_RESOURCE WHERE 1=1
		<if test="resourceId!=null">
			AND RESOURCE_ID  LIKE '%'||#{resourceId}||'%'  
		</if>
		<if test="resourceName!=null">
			AND RESOURCE_NAME  LIKE '%'||#{resourceName}||'%'  
		</if>
		ORDER BY RESOURCE_ID
	</select>

	<!-- 通过角色ID找到资源 -->
	<!--  
	<select id="selectResourceByRoleId" resultMap="resourceResultMap">
		SELECT a.RESOURCE_ID,SUPER_RESOURCE_ID,RESOURCE_NAME,RESOURCE_URL FROM T_RESOURCE a,T_ROLE_AUTH b 
       		WHERE a.RESOURCE_ID = b.RESOURCE_ID AND ROLE_ID = #{roleId} 
	</select>
	-->
</mapper>