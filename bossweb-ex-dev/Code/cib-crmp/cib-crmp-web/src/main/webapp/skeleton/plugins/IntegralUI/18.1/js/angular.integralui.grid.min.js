/*
  filename: angular.integralui.grid.min.js
  version : 4.1.0
  Copyright © 2014-2017 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Studio for Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
angular.module("integralui").factory("IntegralUIGridService",["$rootScope",function(c){var f=null;return{addColumn:function(l,g){c.$broadcast(l+"-add-column",g)},clearColumns:function(l){c.$broadcast(l+"-clear-columns")},insertColumnAt:function(l,g,f){c.$broadcast(l+"-insert-column-at",g,f)},insertColumnBefore:function(l,g,f){c.$broadcast(l+"-insert-column-before",g,f)},insertColumnAfter:function(l,g,f){c.$broadcast(l+"-insert-column-after",g,f)},removeColumn:function(l,g){c.$broadcast(l+"-remove-column",
g)},removeColumnAt:function(l,g){c.$broadcast(l+"-remove-column-at",g)},addGroup:function(l,g){c.$broadcast(l+"-add-group",g)},clearGroups:function(l){c.$broadcast(l+"-clear-groups")},insertGroupAt:function(l,g,f){c.$broadcast(l+"-insert-group-at",g,f)},insertGroupBefore:function(l,g,f){c.$broadcast(l+"-insert-group-before",g,f)},insertGroupAfter:function(l,g,f){c.$broadcast(l+"-insert-group-after",g,f)},removeGroup:function(l,g){c.$broadcast(l+"-remove-group",g)},removeGroupAt:function(l,g){c.$broadcast(l+
"-remove-group-at",g)},addRow:function(l,g){c.$broadcast(l+"-add-row",g)},clearRows:function(l){c.$broadcast(l+"-clear-rows")},insertRowAt:function(l,g,f){c.$broadcast(l+"-insert-row-at",g,f)},insertRowBefore:function(l,g,f){c.$broadcast(l+"-insert-row-before",g,f)},insertRowAfter:function(l,g,f){c.$broadcast(l+"-insert-row-after",g,f)},removeRow:function(l,g){c.$broadcast(l+"-remove-row",g)},removeRowAt:function(l,g){c.$broadcast(l+"-remove-row-at",g)},exportToJSON:function(l,g,f,m){c.$broadcast(l+
"-export-json",g,f,m);l=this.getTempData();this.clearTempData();return l?l:""},loadData:function(l,g,f){c.$broadcast(l+"-load-data",g,f)},openEditor:function(l,g){c.$broadcast(l+"-open-editor",g)},closeEditor:function(l,g){c.$broadcast(l+"-close-editor",g)},filter:function(l,g,f){c.$broadcast(l+"-filter",g,f)},findRowById:function(l,g){c.$broadcast(l+"-find-row-by-id",g);var f=this.getTempData();this.clearTempData();return f?f:null},findRowByText:function(l,g){c.$broadcast(l+"-find-row-by-text",g);
var f=this.getTempData();this.clearTempData();return f?f:null},getCellAt:function(l,g){c.$broadcast(l+"-get-cell-at",g);var f=this.getTempData();this.clearTempData();return f?f:null},getRowAt:function(l,g){c.$broadcast(l+"-get-row-at",g);var f=this.getTempData();this.clearTempData();return f?f:null},focus:function(l,g){c.$broadcast(l+"-focus",g)},clearTempData:function(){f=null},ensureVisible:function(l,g){c.$broadcast(l+"-ensure-visible",g)},getTempData:function(){return f},getHoverColumn:function(l,
g){c.$broadcast(l+"-get-hover-column",g);var f=this.getTempData();this.clearTempData();return f?f:null},getList:function(l){c.$broadcast(l+"-get-list");l=this.getTempData();this.clearTempData();return l?l:[]},setTempData:function(c){f=c},topRow:function(l,g){if(g)c.$broadcast(l+"-set-top-row",g);else return c.$broadcast(l+"-get-top-row"),g=this.getTempData(),this.clearTempData(),g?g:null},beginLoad:function(l,g){c.$broadcast(l+"-begin-load",g)},endLoad:function(l){c.$broadcast(l+"-end-load")},moveColumn:function(l,
g,f){c.$broadcast(l+"-move-column",g,f)},moveRow:function(l,g,f,m,ba){c.$broadcast(l+"-move-row",g,f,m,ba)},getScrollPos:function(l){c.$broadcast(l+"-get-scroll-pos");l=this.getTempData();this.clearTempData();return l?l:{x:0,y:0}},getMaxScrollPos:function(l){c.$broadcast(l+"-get-max-scroll-pos");l=this.getTempData();this.clearTempData();return l?l:{x:0,y:0}},setScrollPos:function(l,g){c.$broadcast(l+"-set-scroll-pos",g)},scrollTo:function(l,g,f){c.$broadcast(l+"-scroll-to",g,f)},currentPage:function(l,
f){if(void 0!=f&&null!=f)c.$broadcast(l+"-set-current-page",f);else{c.$broadcast(l+"-get-current-page");var g=this.getTempData();this.clearTempData();return void 0!=g?g:-1}},firstPage:function(l){c.$broadcast(l+"-first-page")},lastPage:function(l){c.$broadcast(l+"-last-page")},nextPage:function(l){c.$broadcast(l+"-next-page")},prevPage:function(l){c.$broadcast(l+"-prev-page")},clearSelection:function(l){c.$broadcast(l+"-clear-selection")},selectedColumn:function(l,f){if(f)c.$broadcast(l+"-set-selected-column",
f);else{c.$broadcast(l+"-get-selected-column");var g=this.getTempData();this.clearTempData();return g?g:null}},selectedColumns:function(f,g){if(g)c.$broadcast(f+"-set-selected-columns",g);else{c.$broadcast(f+"-get-selected-columns");var l=this.getTempData();this.clearTempData();return l?l:null}},selectedRow:function(f,g){if(g)c.$broadcast(f+"-set-selected-row",g);else{c.$broadcast(f+"-get-selected-row");var l=this.getTempData();this.clearTempData();return l?l:null}},selectedRows:function(f,g){if(g)c.$broadcast(f+
"-set-selected-rows",g);else{c.$broadcast(f+"-get-selected-rows");var l=this.getTempData();this.clearTempData();return l?l:null}},sort:function(f,g,K,m){c.$broadcast(f+"-sort",g,K,m)},refresh:function(f,g,K){c.$broadcast(f+"-refresh",g,K)},resumeLayout:function(f,g){c.$broadcast(f+"-resume-layout",g)},suspendLayout:function(f,g){c.$broadcast(f+"-suspend-layout",g)},updateCurrentLayout:function(f){c.$broadcast(f+"-update-current-layout")},updateLayout:function(f,g){c.$broadcast(f+"-update-layout",
g)},updateView:function(f){c.$broadcast(f+"-update-view")}}}]).controller("IntegralUIGridController",["$scope","$element","$timeout","$window","$interval","IntegralUIInternalService","IntegralUIDataService","IntegralUIGridService","IntegralUIDragDrop","IntegralUIFilter",function(c,f,l,g,K,m,ba,p,q,Ac){var a=this;this.suppressProcess=!1;this.hoverCell=this.hoverRow=this.hoverColumn=null;a.defaultCheckBoxStyle={general:"iui-checkbox",box:{general:"iui-checkbox-box",disabled:"iui-checkbox-box-disabled",
checked:"iui-checkbox-checked",indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}};a.defaultStyle={general:"iui-grid",column:{general:{content:"iui-grid-column-cell-content",disabled:"iui-grid-column-disabled",normal:"iui-grid-column",hovered:"iui-grid-column-hovered",selected:"iui-grid-column-selected"},header:{content:"iui-grid-column-header-cell-content",disabled:"iui-grid-column-header-disabled",normal:"iui-grid-column-header",hovered:"iui-grid-column-header-hovered",
selected:"iui-grid-column-header-selected"},body:{content:"iui-grid-column-body-cell-content",disabled:"iui-grid-column-body-disabled",normal:"iui-grid-column-body",hovered:"iui-grid-column-body-hovered",selected:"iui-grid-column-body-selected"},footer:{content:"iui-grid-column-footer-cell-content",disabled:"iui-grid-column-footer-disabled",normal:"iui-grid-column-footer",hovered:"iui-grid-column-footer-hovered",selected:"iui-grid-column-footer-selected"}},row:{general:{disabled:"iui-grid-row-disabled",
focused:"iui-grid-row-focused",normal:"iui-grid-row",hovered:"iui-grid-row-hovered",selected:"iui-grid-row-selected"},checkBox:{general:"iui-checkbox",box:{general:"iui-checkbox-box",disabled:"iui-checkbox-box-disabled",checked:"iui-checkbox-checked",indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}},expandBox:{general:"iui-grid-expand-box",animated:"iui-grid-expand-box-load",expanded:"iui-grid-expand-box-open",collapsed:"iui-grid-expand-box-close"},cell:{content:"iui-grid-row-cell-content",
general:"iui-grid-row-cell",disabled:"iui-grid-row-cell-disabled",focused:"iui-grid-row-cell-focused",normal:"iui-grid-row-cell",hovered:"iui-grid-row-cell-hovered",selected:"iui-grid-row-cell-selected"},fixed:{disabled:"iui-grid-row-fixed-disabled",normal:"iui-grid-row-fixed",hovered:"iui-grid-row-fixed-hovered"}},cell:{content:"iui-grid-row-cell-content",general:"iui-grid-row-cell",disabled:"iui-grid-row-cell-disabled",focused:"iui-grid-row-cell-focused",normal:"iui-grid-row-cell",hovered:"iui-grid-row-cell-hovered",
selected:"iui-grid-row-cell-selected"}};this.updateGrouping=function(b){a.options.grouping=b?{enabled:m.isFieldAvailable(b.enabled,!1),showColumns:m.isFieldAvailable(b.showColumns,!1)}:{enabled:!1,showColumns:!1}};this.updatePaging=function(b){a.options.paging=b?{enabled:m.isFieldAvailable(b.enabled,!1),showControlPanel:m.isFieldAvailable(b.showControlPanel,!0),pageSize:m.isFieldAvailable(b.pageSize,100)}:{enabled:!1,showControlPanel:!0,pageSize:100}};this.updateShowScroll=function(b){a.options.showScroll=
b?{horizontal:m.isFieldAvailable(b.horizontal,!0),vertical:m.isFieldAvailable(b.vertical,!0)}:{horizontal:!0,vertical:!0}};this.updateOptions=function(b){b?(a.options={allowAnimation:m.isFieldAvailable(b.allowAnimation,!0),allowCellFocus:m.isFieldAvailable(b.allowCellFocus,!0),allowColumnReorder:m.isFieldAvailable(b.allowColumnReorder,!1),allowDrag:m.isFieldAvailable(b.allowDrag,!1),allowDrop:m.isFieldAvailable(b.allowDrop,!0),allowFilter:m.isFieldAvailable(b.allowFilter,!1),allowFocus:m.isFieldAvailable(b.allowFocus,
!0),animationSpeed:200,autoExpand:m.isFieldAvailable(b.autoExpand,!0),autoUpdate:m.isFieldAvailable(b.autoUpdate,!0),controlStyle:a.defaultStyle,displayMode:m.isFieldAvailable(b.displayMode,"normal"),editorSettings:{activate:"click"},enabled:m.isFieldAvailable(b.enabled,!0),expandColIndex:m.isFieldAvailable(b.expandColIndex,void 0!=a.options.expandColIndex?a.options.expandColIndex:0),fillSpace:m.isFieldAvailable(b.fillSpace,!1),gridLines:m.isFieldAvailable(b.gridLines,"both"),hoverSelection:m.isFieldAvailable(b.hoverSelection,
!1),indent:m.isFieldAvailable(b.indent,15),labelEdit:m.isFieldAvailable(b.labelEdit,!1),loadRows:[],mouseWheelSpeed:m.isFieldAvailable(b.mouseWheelSpeed,"normal"),pathSeparator:m.isFieldAvailable(b.pathSeparator,"\\"),rowHeight:m.isFieldAvailable(b.rowHeight,-1),rtl:m.isFieldAvailable(b.rtl,!1),selectedColumn:m.isFieldAvailable(b.selectedColumn,a.options.selectedColumn?a.options.selectedColumn:null),selectedColumns:a.options.selectedColumns?a.options.selectedColumns:[],selectedIndex:-1,selectedRow:m.isFieldAvailable(b.selectedRow,
a.options.selectedRow?a.options.selectedRow:null),selectedRows:a.options.selectedRows?a.options.selectedRows:[],selectionMode:m.isFieldAvailable(b.selectionMode,"one"),showFooter:m.isFieldAvailable(b.showFooter,!0),showHeader:m.isFieldAvailable(b.showHeader,!0),showIcons:m.isFieldAvailable(b.showIcons,!0),sorting:m.isFieldAvailable(b.sorting,"none")},a.updateGrouping(b.grouping),a.updatePaging(b.paging),a.updateShowScroll(b.showScroll),a.updateDataFields(b.dataFields),a.updateControlStyle(b.controlStyle)):
(a.options={allowAnimation:!0,allowCellFocus:!0,allowColumnReorder:!1,allowDrag:!1,allowDrop:!0,allowFilter:!1,allowFocus:!0,animationSpeed:200,autoExpand:!0,autoUpdate:!0,controlStyle:a.defaultStyle,displayMode:"normal",editorSettings:{activate:"click"},enabled:!0,expandColIndex:0,fillSpace:!1,gridLines:"both",hoverSelection:!1,indent:15,labelEdit:!1,loadRows:[],mouseWheelSpeed:"normal",pathSeparator:"\\",rowHeight:-1,rtl:!1,selectedColumn:null,selectedColumns:[],selectedIndex:-1,selectedRow:null,
selectedRows:[],selectionMode:"one",showFooter:!0,showHeader:!0,showIcons:!0,sorting:"none"},a.updateGrouping(),a.updatePaging(),a.updateShowScroll(),a.updateDataFields())};a.options={};this.updateColumnFields=function(b){a.options.columnFields=b?{allowDrag:b.allowDrag?b.allowDrag:"allowDrag",allowDrop:b.allowDrop?b.allowDrop:"allowDrop",allowFilter:b.allowFilter?b.allowFilter:"allowFilter",allowGrouping:b.allowGrouping?b.allowGrouping:"allowGrouping",cellTemplateUrl:b.cellTemplateUrl?b.cellTemplateUrl:
"cellTemplateUrl",columns:b.columns?b.columns:"columns",comparer:b.comparer?b.comparer:"comparer",contentAlignment:b.contentAlignment?b.contentAlignment:"contentAlignment",contextMenu:b.contextMenu?b.contextMenu:"contextMenu",editorType:b.editorType?b.editorType:"editorType",editorSettings:b.editorSettings?b.editorSettings:"editorSettings",editorTemplate:b.editorTemplate?b.editorTemplate:"editorTemplate",filterParams:b.filterParams?b.filterParams:"filterParams",filterTemplate:b.filterTemplate?b.filterTemplate:
"filterTemplate",fixed:b.fixed?b.fixed:"fixed",fixedWidth:b.fixedWidth?b.fixedWidth:"fixedWidth",footerAlignment:b.footerAlignment?b.footerAlignment:"footerAlignment",footerContent:b.footerContent?b.footerContent:"footerContent",footerTemplate:b.footerTemplate?b.footerTemplate:"footerTemplate",footerTemplateModel:b.footerTemplateModel?b.footerTemplateModel:"footerTemplateModel",footerText:b.footerText?b.footerText:"footerText",footerTooltip:b.footerTooltip?b.footerTooltip:"footerTooltip",groupText:b.groupText?
b.groupText:"groupText",headerAlignment:b.headerAlignment?b.headerAlignment:"headerAlignment",headerContent:b.headerContent?b.headerContent:"headerContent",headerTemplate:b.headerTemplate?b.headerTemplate:"headerTemplate",headerTemplateModel:b.headerTemplateModel?b.headerTemplateModel:"headerTemplateModel",headerText:b.headerText?b.headerText:"headerText",headerTooltip:b.headerTooltip?b.headerTooltip:"headerTooltip",icon:b.icon?b.icon:"icon",id:b.id?b.id:"id",objects:b.columns?b.columns:"columns",
pid:b.pid?b.pid:"pid",minWidth:b.minWidth?b.minWidth:"minWidth",maxWidth:b.maxWidth?b.maxWidth:"maxWidth",selected:b.selected?b.selected:"selected",style:b.style?b.style:"style",templateSettings:b.templateSettings?b.templateSettings:"templateSettings",visible:b.visible?b.visible:"visible",width:b.width?b.width:"width"}:{allowDrag:"allowDrag",allowDrop:"allowDrop",allowFilter:"allowFilter",allowGrouping:"allowGrouping",cellTemplateUrl:"cellTemplateUrl",columns:"columns",comparer:"comparer",contentAlignment:"contentAlignment",
contextMenu:"contextMenu",editorType:"editorType",editorSettings:"editorSettings",editorTemplate:"editorTemplate",filterParams:"filterParams",filterTemplate:"filterTemplate",footerTemplateModel:"footerTemplateModel",fixed:"fixed",fixedWidth:"fixedWidth",footerAlignment:"footerAlignment",footerContent:"footerContent",footerTemplate:"footerTemplate",footerText:"footerText",footerTooltip:"footerTooltip",groupText:"groupText",headerAlignment:"headerAlignment",headerContent:"headerContent",headerTemplate:"headerTemplate",
headerTemplateModel:"headerTemplateModel",headerText:"headerText",headerTooltip:"headerTooltip",icon:"icon",id:"id",objects:"columns",pid:"pid",minWidth:"minWidth",maxWidth:"maxWidth",selected:"selected",style:"style",templateSettings:"templateSettings",visible:"visible",width:"width"};a.columnsObj&&a.columnsObj.updateDataFields(a.options.columnFields)};this.updateRowFields=function(b){a.options.rowFields=b?{allowDrag:b.allowDrag?b.allowDrag:"allowDrag",allowDrop:b.allowDrop?b.allowDrop:"allowDrop",
allowFocus:b.allowFocus?b.allowFocus:"allowFocus",cells:b.cells?b.cells:"cells",content:b.content?b.content:"content",contextMenu:b.contextMenu?b.contextMenu:"contextMenu",enabled:b.enabled?b.enabled:"enabled",expanded:b.expanded?b.expanded:"expanded",fixed:b.fixed?b.fixed:"fixed",hasChildren:b.hasChildren?b.hasChildren:"hasChildren",icon:b.icon?b.icon:"icon",id:b.id?b.id:"id",objects:b.rows?b.rows:"rows",pid:b.pid?b.pid:"pid",rows:b.rows?b.rows:"rows",selected:b.selected?b.selected:"selected",statusIcon:b.statusIcon?
b.statusIcon:"statusIcon",style:b.style?b.style:"style",subobjects:b.cells?b.cells:"cells",text:b.text?b.text:"text",tooltip:b.tooltip?b.tooltip:"tooltip",visible:b.visible?b.visible:"visible"}:{allowDrag:"allowDrag",allowDrop:"allowDrop",allowFocus:"allowFocus",cells:"cells",content:"content",contextMenu:"contextMenu",enabled:"enabled",expanded:"expanded",fixed:"fixed",hasChildren:"hasChildren",icon:"icon",id:"id",objects:"rows",pid:"pid",rows:"rows",selected:"selected",statusIcon:"statusIcon",style:"style",
subobjects:"cells",text:"text",tooltip:"tooltip",visible:"visible"};a.rowsObj&&a.rowsObj.updateDataFields(a.getRowFields(a.options.rowFields))};this.updateCellFields=function(b){a.options.cellFields=b?{allowEdit:b.allowEdit?b.allowEdit:"allowEdit",cid:b.cid?b.cid:"cid",content:b.content?b.content:"content",contextMenu:b.contextMenu?b.contextMenu:"contextMenu",enabled:b.enabled?b.enabled:"enabled",labelEdit:b.labelEdit?b.labelEdit:"labelEdit",rid:b.rid?b.rid:"rid",selected:b.selected?b.selected:"selected",
style:b.style?b.style:"style",templateObj:b.templateObj?b.templateObj:"templateObj",text:b.text?b.text:"text",tooltip:b.tooltip?b.tooltip:"tooltip",value:b.value?b.value:"value"}:{allowEdit:"allowEdit",cid:"cid",content:"content",contextMenu:"contextMenu",enabled:"enabled",labelEdit:"labelEdit",rid:"rid",selected:"selected",style:"style",templateObj:"templateObj",text:"text",tooltip:"tooltip",value:"value"}};this.updateDataFields=function(b){b?(a.updateColumnFields(b.column),a.updateRowFields(b.row),
a.updateCellFields(b.cell)):(a.updateColumnFields(),a.updateRowFields(),a.updateCellFields())};a.updateOptions();c.$on(c.name+"-add-column",function(b,e){a.columnsObj.insertAt(e,-1,null,a.columnIsAdded)});c.$on(c.name+"-clear-columns",function(b){a.columnsObj.clear(null,a.columnsAreCleared)});c.$on(c.name+"-insert-column-at",function(b,e,c){a.columnsObj.insertAt(e,c,null,a.columnIsAdded)});c.$on(c.name+"-insert-column-after",function(b,e,c){a.columnsObj.insertByRef(e,c,!0,a.columnIsAdded)});c.$on(c.name+
"-insert-column-before",function(b,e,c){a.columnsObj.insertByRef(e,c,!1,a.columnIsAdded)});c.$on(c.name+"-remove-column",function(b,e){a.columnsObj.removeAt(e,-1,null,a.columnIsRemoved)});c.$on(c.name+"-remove-column-at",function(b,e){a.columnsObj.removeAt(null,e,null,a.columnIsRemoved)});this.columnsAreCleared=function(){a.options.selectedColumn&&(a.options.selectedColumn[a.options.columnFields.selected]=!1);a.options.selectedColumn=null;a.updateLayout()};a.columnIsAdded=function(){a.updateLayout()};
a.columnIsRemoved=function(){a.updateLayout()};c.$on(c.name+"-add-group",function(b,e){0>a.groupsObj.getList().indexOf(e)&&a.groupsObj.insertAt(e,-1,null,a.groupIsAdded)});c.$on(c.name+"-clear-groups",function(b){a.groupsObj.clear(null,a.groupsAreCleared)});c.$on(c.name+"-insert-group-at",function(b,e,c){0>a.groupsObj.getList().indexOf(e)&&a.groupsObj.insertAt(e,c,null,a.groupIsAdded)});c.$on(c.name+"-insert-group-after",function(b,e,c){0>a.groupsObj.getList().indexOf(e)&&a.groupsObj.insertByRef(e,
c,!0,a.groupIsAdded)});c.$on(c.name+"-insert-group-before",function(b,e,c){0>a.groupsObj.getList().indexOf(e)&&a.groupsObj.insertByRef(e,c,!1,a.groupIsAdded)});c.$on(c.name+"-remove-group",function(b,e){a.groupsObj.removeAt(e,-1,null,a.groupIsRemoved)});c.$on(c.name+"-remove-group-at",function(b,e){a.groupsObj.removeAt(null,e,null,a.groupIsRemoved)});this.groupsAreCleared=function(){a.updateLayout();a.callGroupChange()};a.groupIsAdded=function(b){a.updateLayout();a.callGroupChange(b)};a.groupIsRemoved=
function(b){a.updateLayout();a.callGroupChange(b)};c.$on(c.name+"-add-row",function(b,e){a.rowsObj.insertAt(e,-1,null,a.rowIsAdded)});c.$on(c.name+"-clear-rows",function(b){a.rowsObj.clear(null,a.rowsAreCleared)});c.$on(c.name+"-insert-row-at",function(b,e,c){a.rowsObj.insertAt(e,c,null,a.rowIsAdded)});c.$on(c.name+"-insert-row-after",function(b,e,c){a.rowsObj.insertByRef(e,c,!0,a.rowIsAdded)});c.$on(c.name+"-insert-row-before",function(b,e,c){a.rowsObj.insertByRef(e,c,!1,a.rowIsAdded)});c.$on(c.name+
"-remove-row",function(b,e){a.rowsObj.removeAt(e,-1,null,a.rowIsRemoved)});c.$on(c.name+"-remove-row-at",function(b,e){a.rowsObj.removeAt(null,e,null,a.rowIsRemoved)});this.rowsAreCleared=function(b){b||(a.clearPrevSelection(),a.options.selectedRow=null,a.setScrollPos({x:0,y:0}));a.updateCurrentLayout()};this.rowIsAdded=function(){a.updateCurrentLayout()};this.rowIsRemoved=function(){a.updateCurrentLayout()};this.objIsRemoved=function(){a.updateCurrentLayout()};a.groups=[];a.groupList=[];a.groupLevel=
-1;this.updateGroupList=function(){a.groupList.length=0;var b=a.groupsObj.getList();b&&(a.groups=b);if(a.options.grouping.enabled&&0<a.groups.length&&(b=a.rowsObj.getList()))for(var e=0;e<b.length;e++){var c=b[e],t=c[a.options.rowFields.cells];if(t&&0<t.length){for(var D,f=null,g=0;g<a.groups.length;g++){D=a.groups[g];D=D[a.options.columnFields.id];var l=g;D&&(l=a.getCellIndexById(t,g,D));if(0<=l&&l<t.length){(D=t[l][a.options.cellFields.text])&&""!=D||(D=void 0!=t[l][a.options.cellFields.value]?
t[l][a.options.cellFields.value].toString():"undefined");l=null;var m=a.groupList;f&&(m=f[a.options.rowFields.rows]);if(m)for(var p=0;p<m.length;p++)if(m[p][a.options.rowFields.text]==D){l=m[p];break}l||(l={},l[a.options.rowFields.text]=D,l[a.options.rowFields.cells]=[{cid:a.columnList[a.options.expandColIndex][a.options.columnFields.id],text:D}],l.type="group",f?(f[a.options.rowFields.rows]||(f[a.options.rowFields.rows]=[]),f[a.options.rowFields.rows].push(l)):a.groupList.push(l));f=l}}f&&(f[a.options.rowFields.rows]||
(f[a.options.rowFields.rows]=[]),f[a.options.rowFields.rows].push(c))}}};this.callGroupRemoving=function(a){return angular.isDefined(c.events)&&c.events.groupRemoving?c.events.groupRemoving({group:a}):c.groupRemoving({e:{group:a}})};this.callGroupRemoved=function(a){return angular.isDefined(c.events)&&c.events.groupRemoved?c.events.groupRemoved({group:a}):c.groupRemoved({e:{group:a}})};this.callGroupChange=function(a){angular.isDefined(c.events)&&c.events.groupChange?c.events.groupChange({group:a}):
c.groupChange({e:{group:a}})};a.columnList=[];a.columnFilterList=[];a.completeColumnList=[];a.currentColumnList=[];a.maxColumnLevels=0;a.relatedColumns=[];a.isThereLeftFixedColumns=!1;a.isThereRightFixedColumns=!1;var bd=function(b,e){if(b&&0!=b.length)for(var c=0;c<b.length;c++)a.isColumnWithChildenVisible(b[c])&&(a.maxColumnLevels<e&&(a.maxColumnLevels=e),bd(b[c][a.options.columnFields.columns],e+1))},O=function(b){var e=0;if(!b[a.options.columnFields.columns]||0==b[a.options.columnFields.columns].length)return 1;
for(var c=0;c<b[a.options.columnFields.columns].length;c++)e+=O(b[a.options.columnFields.columns][c]);return e};this.isColumnWithChildenVisible=function(b){var e=!1;if(b&&(e=a.isColumnVisible(b))&&(b=b[a.options.columnFields.columns])&&0<b.length){for(var c=e=0;c<b.length;c++)a.isColumnWithChildenVisible(b[c])&&e++;e=0<e?!0:!1}return e};var Ca=function(b,e,c){if(b)for(var r=0;r<b.length;){if(a.isColumnWithChildenVisible(b[r])){c&&(b[r][a.options.columnFields.pid]=c);var D={colSpan:b[r][a.options.columnFields.columns]?
O(b[r]):0,column:b[r],isRoot:0==e?!0:!1,rowSpan:b[r][a.options.columnFields.columns]&&0!=b[r][a.options.columnFields.columns].length?0:a.maxColumnLevels-e};a.completeColumnList[e].push(D);Ca(b[r][a.options.columnFields.columns],e+1,b[r][a.options.columnFields.id])}r++}};this.updateColumnCompleteList=function(){bd(a.currentColumnList,1);for(var b=1;b<=a.maxColumnLevels;b++)a.completeColumnList.push([]);Ca(a.currentColumnList,0)};var Q=function(b){b.type="column";b[a.options.columnFields.id]||(b[a.options.columnFields.id]=
m.getUniqueId());if(a.isColumnWithChildenVisible(b))if(b[a.options.columnFields.columns])for(var e=0;e<b[a.options.columnFields.columns].length;e++)Q(b[a.options.columnFields.columns][e]);else e=!0,a.options.grouping.enabled&&(e=0<=a.groups.indexOf(b)?a.options.grouping.showColumns:!0),e&&(e=(e=b[a.options.columnFields.filterParams])?Ac.createTree(e.conditions,e.formula):null,a.columnFilterList.push({cid:b[a.options.columnFields.id],tree:e}),a.columnList.push(b))};this.updateColumnList=function(){a.columnList.length=
0;a.columnFilterList.length=0;a.completeColumnList.length=0;a.currentColumnList.length=0;a.maxColumnLevels=0;a.relatedColumns.length=0;a.isThereLeftFixedColumns=!1;a.isThereRightFixedColumns=!1;var b=a.columnsObj.getList();if(b){for(var e=0;e<b.length;e++){var c=b[e];c.type="column";c[a.options.columnFields.id]||(c[a.options.columnFields.id]=m.getUniqueId());if(a.isColumnWithChildenVisible(c))switch(a.currentColumnList.push(c),c[a.options.columnFields.fixed]){case "left":a.isThereLeftFixedColumns||
(a.isThereLeftFixedColumns=!0);break;case "right":a.isThereRightFixedColumns||(a.isThereRightFixedColumns=!0)}}a.updateColumnCompleteList();for(e=0;e<a.currentColumnList.length;e++)Q(a.currentColumnList[e])}b=a.columnRelationsObj.getList();F(b)};var F=function(b,e){if(b)for(var c=0;c<b.length;c++)a.isRootColumn(b[c].column)&&(b[c].id||(b[c].id=m.getUniqueId()),e&&(b[c].pid=e),a.relatedColumns.push(b[c]),b[c].children&&F(b[c].children,b[c].id))};this.isRootColumn=function(b){var e=!1;if(b&&a.completeColumnList&&
0<a.completeColumnList.length)for(var c=0;c<a.completeColumnList[0].length;c++){var t=a.completeColumnList[0][c].column;if(t==b||m.isEqual(t[a.options.columnFields.id],b[a.options.columnFields.id])){e=!0;break}}return e};this.isColumnRelated=function(b){var e=!1;if(b&&a.relatedColumns)for(var c=0;c<a.relatedColumns.length;c++){var t=a.relatedColumns[c].column;if(t&&(t==b||m.isEqual(t[a.options.columnFields.id],b[a.options.columnFields.id]))){e=!0;break}}return e};this.getColumnRelatedObject=function(b){for(var e=
null,c=0;c<a.relatedColumns.length;c++){var t=a.relatedColumns[c];if(t.column&&(t.column==b||m.isEqual(t.column[a.options.columnFields.id],b[a.options.columnFields.id]))){e=t;break}}return e};this.isTherePrevRelatedColumn=function(b){var e=a.relatedColumns.indexOf(b);return 0<e&&(a.relatedColumns[e-1].id==b.pid||b.pid&&b.pid==a.relatedColumns[e-1].pid)?!0:!1};this.isThereNextRelatedColumn=function(b){var e=a.relatedColumns.indexOf(b);return 0<=e&&e<a.relatedColumns.length-1&&(b.children&&0<b.children.length||
b.pid&&b.pid==a.relatedColumns[e+1].pid)?!0:!1};var hb=function(b){for(var e=null,c=0;c<a.columnFilterList.length;c++)if(a.columnFilterList[c].cid==b){e=a.columnFilterList[c].tree;break}return e},Xa=function(b,e){if("group"!=b.type&&0==b[a.options.rowFields.visible])return!1;if(0==a.options.allowFilter||"group"==b.type)return!0;var c=!0;if(b)for(var t,D,f,l=0;l<b[a.options.rowFields.cells].length;l++){c=!0;f=b[a.options.rowFields.cells][l];t=f[a.options.cellFields.cid];D=a.getColumnById(t);!D&&l<
a.columnList.length&&(D=a.columnList[l]);if(D&&D[a.options.columnFields.filterParams]){D=D[a.options.columnFields.filterParams];var g=f[a.options.cellFields.value]?f[a.options.cellFields.value]:f[a.options.cellFields.text];D&&(c=D.callback?D.callback(g,f,b):Ac.match(g,D.conditions,D.formula,hb(t),D.caseSensitive))}if(!c)break}return c},Da=a.options.indent;a.currentPageList=[];a.pageList=[];a.onlyCurrentPage=!1;a.currentList=[];a.fullIndentList=[];a.fullList=[];a.indentList=[];a.longestRow=null;a.isThereChildRows=
!1;a.pageRowCount=0;a.pageNumber=0;a.currentPageNumber=1;a.currentTopList=[];a.currentBottomList=[];this.isThereVisibleChildren=function(b){var e=!1;if(b&&(b=b[a.options.rowFields.rows])&&0<b.length)for(var c=0;c<b.length;c++)if(Xa(b[c])&&!a.isRowFixed(b[c])){e=!0;break}return e};var nb=function(b,e,c,t){b.type||(b.type="row");b[a.options.rowFields.id]||(b[a.options.rowFields.id]=m.getUniqueId());c&&(b[a.options.rowFields.pid]=c);c=!0;var r=b[a.options.rowFields.cells];if(r&&0<r.length){c=Xa(b,t);
for(var f,l,g,p=0;p<a.columnList.length;p++){g=a.columnList[p];f=g[a.options.columnFields.id];l=g[a.options.columnFields.editorType];g=g[a.options.columnFields.editorSettings];var q=p;f&&(q=a.getCellIndexById(r,p,f));0<=q&&q<r.length&&(r[q].type="cell",r[q][a.options.cellFields.rid]=b[a.options.rowFields.id],a.setDefaultCellValue(r[q],l,g))}}if(c)if(t)a.fullList.push(b),a.fullIndentList.push(e);else if(a.options.paging.enabled)a.onlyCurrentPage?a.currentPageList.push({row:b,indent:e}):(b[a.options.rowFields.pid]||
a.pageRowCount++,a.pageRowCount>a.options.paging.pageSize&&(a.pageRowCount=1,a.pageNumber++,a.pageList.push([])),a.pageList[a.pageNumber].push({row:b,indent:e}));else switch(b[a.options.rowFields.fixed]){case "top":a.currentTopList.push(b);break;case "bottom":a.currentBottomList.push(b);break;default:a.currentList.push(b),a.indentList.push(e)}return c},Cb=function(b,e,c,t){if(!b[a.options.rowFields.rows])return c=nb(b,e,c,t);if((c=nb(b,e,c,t))&&!a.isRowFixed(b)){var r=0,f;if("group"==b.type&&(t||
a.isRowExpanded(b))){var l=b[a.options.rowFields.rows];if(l){a.applySorting(l);for(var g=0;g<l.length;g++)(f=Cb(l[g],e+Da,b[a.options.rowFields.id],t))&&r++}}t||a.isThereChildRows||!(0<r||!a.isRowExpanded(b)&&b[a.options.rowFields.rows]&&0<b[a.options.rowFields.rows].length&&a.isThereVisibleChildren(b))||(a.isThereChildRows=!0)}return c};this.isRowFixed=function(b){return!b||"top"!=b[a.options.rowFields.fixed]&&"bottom"!=b[a.options.rowFields.fixed]?!1:!0};this.getFullList=function(){a.fullList.length=
0;a.fullIndentList.length=0;for(var b=a.rowsObj.getList(),e=0;e<b.length;e++)Cb(b[e],0,null,!0);return a.fullList};this.getCurrentList=function(){return a.currentList};this.updateCurrentList=function(){a.currentList.length=0;a.indentList.length=0;a.currentTopList.length=0;a.currentBottomList.length=0;Da=a.options.indent;if(a.options.paging.enabled){if(1<=a.currentPageNumber&&a.currentPageNumber<=a.pageList.length)for(var b=0;b<a.pageList[a.currentPageNumber-1].length;b++)a.currentList.push(a.pageList[a.currentPageNumber-
1][b].row),a.indentList.push(a.pageList[a.currentPageNumber-1][b].indent)}else{a.isThereChildRows=!1;var e=a.rowsObj.getList();a.options.grouping.enabled&&0<a.groups.length&&(e=a.groupList);if(e)for(a.applySorting(e),b=0;b<e.length;b++)Cb(e[b],0,null,!1)}};this.updatePageList=function(){a.pageList.length=0;a.pageRowCount=0;a.pageNumber=0;a.isThereChildRows=!1;Da=a.options.indent;var b=a.rowsObj.getList();a.options.grouping.enabled&&0<a.groups.length&&(b=a.groupList);if(b&&0<b.length){a.applySorting(b);
a.pageList.push([]);for(var e=0;e<b.length;e++)Cb(b[e],0,null,!1);0<a.pageList.length&&0==a.pageList[a.pageList.length-1].length&&a.pageList.splice(a.pageList.length-1,1)}};this.columnEvents={clear:function(a){return angular.isDefined(c.events)&&c.events.clearColumns?c.events.clearColumns():c.clearColumns(a)},objAdded:function(a){return angular.isDefined(c.events)&&c.events.columnAdded?c.events.columnAdded({column:a.e.column}):c.columnAdded(a)},objAdding:function(a){return angular.isDefined(c.events)&&
c.events.columnAdding?c.events.columnAdding({column:a.e.column}):c.columnAdding(a)},objRemoved:function(a){return angular.isDefined(c.events)&&c.events.columnRemoved?c.events.columnRemoved({column:a.e.column}):c.columnRemoved(a)},objRemoving:function(a){return angular.isDefined(c.events)&&c.events.columnRemoving?c.events.columnRemoving({column:a.e.column}):c.columnRemoving(a)}};this.groupEvents={clear:function(a){return angular.isDefined(c.events)&&c.events.clearGroups?c.events.clearGroups():c.clearGroups(a)},
objAdded:function(a){return angular.isDefined(c.events)&&c.events.groupAdded?c.events.groupAdded({group:a.e.group}):c.groupAdded(a)},objAdding:function(a){return angular.isDefined(c.events)&&c.events.groupAdding?c.events.groupAdding({group:a.e.group}):c.groupAdding(a)},objRemoved:function(a){return angular.isDefined(c.events)&&c.events.groupRemoved?c.events.groupRemoved({group:a.e.group}):c.groupRemoved(a)},objRemoving:function(a){return angular.isDefined(c.events)&&c.events.groupRemoving?c.events.groupRemoving({group:a.e.group}):
c.groupRemoving(a)}};this.rowEvents={clear:function(a){return angular.isDefined(c.events)&&c.events.clearRows?c.events.clearRows():c.clearRows(a)},objAdded:function(a){return angular.isDefined(c.events)&&c.events.rowAdded?c.events.rowAdded({row:a.e.row}):c.rowAdded(a)},objAdding:function(a){return angular.isDefined(c.events)&&c.events.rowAdding?c.events.rowAdding({row:a.e.row}):c.rowAdding(a)},objRemoved:function(a){return angular.isDefined(c.events)&&c.events.rowRemoved?c.events.rowRemoved({row:a.e.row}):
c.rowRemoved(a)},objRemoving:function(a){return angular.isDefined(c.events)&&c.events.rowRemoving?c.events.rowRemoving({row:a.e.row}):c.rowRemoving(a)}};this.getRowFields=function(a){return{content:a.content?a.content:"content",icon:a.icon?a.icon:"icon",id:a.id?a.id:"id",pid:a.pid?a.pid:"pid",objects:a.rows?a.rows:"rows",subobjects:a.cells?a.cells:"cells",text:a.text?a.text:"text"}};a.columnsObj=new ba({objects:c.columns,events:a.columnEvents,fields:a.options.columnFields});a.rowsObj=new ba({objects:c.rows,
events:a.rowEvents,fields:a.getRowFields(a.options.rowFields)});a.groupsObj=new ba({objects:c.groups,events:a.groupEvents,fields:a.options.columnFields});a.columnRelationsObj=new ba({objects:c.columnRelations,fields:a.options.columnFields});c.$on(c.name+"-load-data",function(b,e,c){a.loadData(e,c)});c.$on(c.name+"-export-json",function(b,e,c,t){p.setTempData(a.exportToJSON(e,c,t))});this.exportToJSON=function(b,e,c){var r=c;r=r?r:null;var f=a.columnsObj.getList();b=JSON.stringify(f,b?b:[a.options.columnFields.allowDrag,
a.options.columnFields.allowDrop,a.options.columnFields.allowFilter,a.options.columnFields.allowGrouping,a.options.columnFields.cellTemplateUrl,a.options.columnFields.columns,a.options.columnFields.contentAlignment,a.options.columnFields.contextMenu,a.options.columnFields.editorType,a.options.columnFields.editorSettings,a.options.columnFields.editorTemplate,a.options.columnFields.filterParams,a.options.columnFields.filterTemplate,a.options.columnFields.fixed,a.options.columnFields.fixedWidth,a.options.columnFields.footerAlignment,
a.options.columnFields.footerContent,a.options.columnFields.footerTemplate,a.options.columnFields.footerText,a.options.columnFields.footerTooltip,a.options.columnFields.groupText,a.options.columnFields.headerAlignment,a.options.columnFields.headerContent,a.options.columnFields.headerTemplate,a.options.columnFields.headerText,a.options.columnFields.headerTooltip,a.options.columnFields.icon,a.options.columnFields.id,a.options.columnFields.pid,a.options.columnFields.selected,a.options.columnFields.style,
a.options.columnFields.templateSettings,a.options.columnFields.visible,a.options.columnFields.width],r);c=c?c:null;r=a.getFullList();e=JSON.stringify(r,e?e:[a.options.rowFields.allowCellFocus,a.options.rowFields.allowDrag,a.options.rowFields.allowDrop,a.options.rowFields.allowFocus,a.options.rowFields.cells,a.options.rowFields.content,a.options.rowFields.contextMenu,a.options.rowFields.enabled,a.options.rowFields.expanded,a.options.rowFields.fixed,a.options.rowFields.hasChildren,a.options.rowFields.icon,
a.options.rowFields.id,a.options.rowFields.pid,a.options.rowFields.selected,a.options.rowFields.statusIcon,a.options.rowFields.style,a.options.rowFields.text,a.options.rowFields.tooltip,a.options.rowFields.visible,a.options.cellFields.rid],c);return'[\n{ "columns": '+b+' },\n{ "rows": '+e+" }\n]"};this.loadData=function(b,e){a.suspendLayout();a.updateDataFields(e);a.rowsObj.clear(null,a.rowsAreCleared);if(angular.isDefined(c.rows))for(var r=c.rows.length=0;r<b.length;r++)c.rows.push(b[r]);a.rowsObj=
new ba({objects:c.rows,events:a.rowEvents,fields:a.getRowFields(a.options.rowFields)});a.resumeLayout()};this.updateData=function(){a.options.rowFields.dataSource&&(a.loadData(a.options.rowFields.dataSource),a.rowsObj=new ba({objects:c.rows,events:a.rowEvents,fields:a.getRowFields(a.options.rowFields)}))};var H=!1;this.dragDropStatus=function(a){if(void 0!=a)H=a;else return H};this.getDnDSource=function(a){return{text:a.dataTransfer?a.dataTransfer.getData("text"):a.originalEvent.dataTransfer?a.originalEvent.dataTransfer.getData("text"):
""}};this.getTouchData=function(a){return a.changedTouches?a.changedTouches:a.originalEvent?a.originalEvent.changedTouches:null};var cd=angular.element('<div class="iui-drop-marker" data-element="dropmark"></div>');this.getDropMarkLine=function(){return dropMarkLine};a.getMousePos=function(a){return{x:a.pageX?a.pageX:a.originalEvent?a.originalEvent.pageX:0,y:a.pageY?a.pageY:a.originalEvent?a.originalEvent.pageY:0}};this.getGridName=function(){return angular.isDefined(c.name)?c.name:""};f.bind("dragenter",
function(b){b.preventDefault();if(a.options.enabled){var e=q.getData();e.source||(e.source=a.getDnDSource(b));b={event:b,sourceCtrl:e.sourceCtrl?e.sourceCtrl.getGridName():"",dragRow:e.source,targetCtrl:a.getGridName(),targetRow:e.target,mousePos:a.getMousePos(b)};a.callDragEnter(b)}});f.bind("dragover",function(b){b.preventDefault();if(!a.options.enabled||!a.isDropInRange(b)||a.options.grouping.enabled&&0<a.groups.length)a.dropMark(),b.dataTransfer?b.dataTransfer.dropEffect="none":b.originalEvent&&
b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect="none");else{var e=!0;b.dataTransfer?e="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(e="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(e)if(b.dataTransfer?b.dataTransfer.dropEffect=a.options.allowDrop?"move":"none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect=a.options.allowDrop?"move":"none"),e=q.getData(),e.source||(e.source=
a.getDnDSource(b)),q.setData({source:e.source,sourceCtrl:e.sourceCtrl,target:null,dropPos:-1}),e={event:b,sourceCtrl:e.sourceCtrl?e.sourceCtrl.getGridName():"",dragRow:e.source,targetCtrl:a.getGridName(),targetRow:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:a.getMousePos(b)},0==a.callDragOver(e))b.dataTransfer?b.dataTransfer.dropEffect="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect="none"),a.dropMark();else{e=a.getMousePos(b);b=e.y+16;
e=e.x+20;var r=a.getDropMarkWindow();r.empty();r.append("<span class='iui-drop-marker-move-end'></span><span class='iui-drop-marker-title'>"+(c.name?c.name:"Grid")+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),{top:b,left:e});a.dropMark(!0)}}});f.bind("drop",function(b){b.preventDefault();if(a.options.enabled){a.dropMark();if(a.isDropInRange(b)){var e=!0;b.dataTransfer?e="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(e="none"===b.originalEvent.dataTransfer.effectAllowed?
!1:!0);if(e&&(e=q.getData(),e.source||(e.source=a.getDnDSource(b)),e.source)){var r={event:b,sourceCtrl:e.sourceCtrl?e.sourceCtrl.getGridName():"",dragRow:e.source,targetCtrl:a.getGridName(),targetRow:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:a.getMousePos(b)};!1!==a.callDragDrop(r)&&(a.drop(e),c.$$phase||c.$apply())}}q.clearData()}b.stopPropagation()});f.bind("dragleave",function(b){b.preventDefault();if(a.options.enabled){a.dropMark();var e=q.getData();e.source||(e.source=a.getDnDSource(b));
b={event:b,sourceCtrl:e.sourceCtrl?e.sourceCtrl.getGridName():"",dragRow:e.source,targetCtrl:a.getGridName(),targetRow:e.target,mousePos:a.getMousePos(b)};a.callDragLeave(b);a.cancelScrollTimer()}});f.bind("dragend",function(b){b.preventDefault();a.options.enabled&&(a.dropMark(),q.getData().source||q.clearData(),a.dragDropStatus(!1))});f.bind("mouseleave",function(b){b.preventDefault();a.options.enabled&&(a.dropMark(),a.hoverColumn=null,a.hoverRow=null,a.hoverCell=null)});this.containsMousePos=function(a,
e){return q.hitTest(a,e,{left:0,top:0,right:f[0].clientWidth,bottom:f[0].clientHeight})};this.isPopupActive=function(){return!1};var Mb=function(b,e){var c=a.options.rowFields;if(!b[c.cells]){b[c.cells]=[];var t={};t[a.options.cellFields.text]=b[e.text];b[c.cells].push(t)}b[c.rows]||(b[c.rows]=[]);b[c.rows].length=0;if(b[e.items]&&0<b[e.items].length)for(t=0;t<b[e.items].length;t++)b[c.rows].push(Mb(b[e.items][t],e));return b},P=function(b,e){var c=!1;e.sourceCtrl&&(c=e.sourceCollection.removeAt(b,
-1,null,e.sourceCtrl.objIsRemoved));c&&("item"==b.type&&(b=Mb(b,e.sourceCtrl.options.dataFields)),1===e.dropPos||2===e.dropPos?1===e.dropPos?a.rowsObj.insertByRef(b,e.target,!1,a.rowIsAdded):a.rowsObj.insertByRef(b,e.target,!0,a.rowIsAdded):a.rowsObj.insertAt(b,-1,null,a.rowIsAdded))};this.setDropSelection=function(b,e){var c=b;!c&&0<=e&&e<a.currentList.length&&(c=a.currentList[e]);a.clearPrevSelection(c);a.rowSelection(c)};this.drop=function(b){if(b&&b.sourceCtrl){b.sourceCtrl.suppressProcess=!0;
a.allowUpdate=!1;b.sourceCtrl.allowUpdate=!1;var e=b.source,c=-1;if(Array.isArray(b.source)){0<b.source.length&&(c=b.sourceCtrl.getObjCurrentIndex(b.source[b.source.length-1]));for(var t=[],f=0;f<b.source.length;f++){for(var g=!1,m=b.sourceCollection.getParent(b.source[f]);m;){if(b.sourceCtrl.isObjInSelList(m)){g=!0;break}m=b.sourceCollection.getParent(m)}g||t.push(b.source[f])}if(0<t.length)if(e=t[t.length-1],f=b.sourceCtrl.getObjCurrentIndex(t[0]),g=b.sourceCtrl.getObjCurrentIndex(e),f<=g)for(f=
0;f<t.length;f++)P(t[f],b);else for(f=t.length-1;0<=f;f--)P(t[f],b)}else c=b.sourceCtrl.getObjCurrentIndex(b.source),P(b.source,b);b.sourceCtrl!==a?(a.allowUpdate=!0,b.sourceCtrl.allowUpdate=!0,a.updateCurrentLayout(),b.sourceCtrl.updateCurrentLayout()):(a.allowUpdate=!0,a.updateCurrentLayout());b.sourceCtrl.multiSelection(!1);var p=l(function(){b.sourceCtrl!==a&&b.sourceCtrl.setDropSelection(null,c);a.setDropSelection(e);a.updateFocus(a.getObjCurrentIndex(e),0);l.cancel(p)},1);b.sourceCtrl.suppressProcess=
!1}};this.isDragAllowed=function(b){return a.options.allowDrag?b&&"row"==b.type&&(b[a.options.rowFields.allowDrag]||void 0===b[a.options.rowFields.allowDrag])?!0:!1:!1};this.isDropAllowed=function(b,e,c){if((c=a.options.allowDrop)&&b&&e&&(c=a.isRowFixed(e)||"row"!=e.type||!e[a.options.rowFields.allowDrop]&&void 0!==e[a.options.rowFields.allowDrop]?!1:!0))if(Array.isArray(b))for(var r=0;r<b.length;r++){if(b[r][a.options.rowFields.pid]&&e[a.options.rowFields.pid]&&!m.isEqual(b[r][a.options.rowFields.pid],
e[a.options.rowFields.pid])){c=!1;break}else if(m.isEqual(b[r][a.options.rowFields.id],e[a.options.rowFields.id])){c=!1;break}if(!c)break}else b[a.options.rowFields.pid]&&e[a.options.rowFields.pid]&&!m.isEqual(b[a.options.rowFields.pid],e[a.options.rowFields.pid])?c=!1:m.isEqual(b[a.options.rowFields.id],e[a.options.rowFields.id])&&(c=!1);return c};this.getDropMarkWindow=function(){for(var a=cd,e=angular.element(document.body).children(),c=0;c<e.length;c++){var t=angular.element(e[c]);if(t[0].attributes&&
t[0].attributes["data-element"]&&"dropmark"===t[0].attributes["data-element"].value){a=t;break}}return a};this.dropMark=function(b,e){e||(e=a.getDropMarkWindow());if(e){var c="none";this.options.allowDrop&&(c=b?"block":"none");angular.element(e).css("display",c)}};this.updateDropMarkElem=function(a,e){a&&e&&(a.css("top",e.top+"px"),a.css("left",e.left+"px"),a.css("width",e.width+"px"))};c.$on(c.name+"-open-editor",function(b,e){a.openEditor(e)});c.$on(c.name+"-close-editor",function(b,e){a.closeEditor(e)});
this.updateEditorSettings=function(b){a.options.editorSettings=b?{activate:m.isFieldAvailable(b.activate,"click")}:{activate:"click"}};this.allowEvents=!0;this.callAfterEdit=function(a){angular.isDefined(c.events)&&c.events.afterEdit&&c.events.afterEdit({cell:a});c.afterEdit({e:{cell:a}})};this.callAfterLabelEdit=function(a){angular.isDefined(c.events)&&c.events.afterLabelEdit&&c.events.afterLabelEdit({cell:a});c.afterLabelEdit({e:{cell:a}})};this.callAfterSelect=function(a){angular.isDefined(c.events)&&
c.events.afterSelect?c.events.afterSelect({object:a}):c.afterSelect({e:{object:a}});angular.isDefined(c.events)&&c.events.selectionChanged?c.events.selectionChanged({object:a}):c.selectionChanged({e:{object:a}})};this.callBeforeEdit=function(a){return angular.isDefined(c.events)&&c.events.beforeEdit?c.events.beforeEdit({cell:a}):c.beforeEdit({e:{cell:a}})};this.callBeforeLabelEdit=function(a){return angular.isDefined(c.events)&&c.events.beforeLabelEdit?c.events.beforeLabelEdit({cell:a}):c.beforeLabelEdit({e:{cell:a}})};
this.callCellValueChanging=function(b,e,r){var t=!0;a.allowEvents&&(t=angular.isDefined(c.events)&&c.events.cellvalueChanging?c.events.cellvalueChanging({row:b,cell:e,value:r}):c.cellvalueChanging({e:{row:b,cell:e,value:r}}));return t};this.callCellValueChanged=function(b,e,r){a.allowEvents&&(angular.isDefined(c.events)&&c.events.cellvalueChanged?c.events.cellvalueChanged({row:b,cell:e,value:r}):c.cellvalueChanged({e:{row:b,cell:e,value:r}}))};this.callChange=function(){angular.isDefined(c.events)&&
c.events.change?c.events.change():c.change()};this.callColumnClick=function(a,e){angular.isDefined(c.events)&&c.events.columnClick&&c.events.columnClick({column:a,mousePos:e});c.columnClick({e:{column:a,mousePos:e}})};this.callColumnDblClick=function(a,e){angular.isDefined(c.events)&&c.events.columnDblclick&&c.events.columnDblclick({column:a,mousePos:e});c.columnDblclick({e:{column:a,mousePos:e}})};this.callColumnHover=function(a){angular.isDefined(c.events)&&c.events.columnHover&&c.events.columnHover({column:a});
c.columnHover({e:{column:a}})};this.callColumnPosChanging=function(a,e){return angular.isDefined(c.events)&&c.events.columnPoschanging?c.events.columnPoschanging({sourceColumn:a,targetColumn:e}):c.columnPoschanging({e:{sourceColumn:a,targetColumn:e}})};this.callColumnPosChanged=function(a,e){angular.isDefined(c.events)&&c.events.columnPoschanged&&c.events.columnPoschanged({sourceColumn:a,targetColumn:e});c.columnPoschanged({e:{sourceColumn:a,targetColumn:e}})};this.callColumnRightClick=function(a,
e){angular.isDefined(c.events)&&c.events.columnRightclick&&c.events.columnRightclick({column:a,mousePos:e});c.columnRightclick({e:{column:a,mousePos:e}})};this.callColumnSizeChanged=function(a,e){angular.isDefined(c.events)&&c.events.columnSizechanged&&c.events.columnSizechanged({column:a});c.columnSizechanged({e:{column:a}})};this.callDragEnter=function(a){angular.isDefined(c.events)&&c.events.dragEnter?c.events.dragEnter({event:a.event,sourceCtrl:a.sourceCtrl,dragRow:a.dragRow,targetCtrl:a.targetCtrl,
targetRow:a.targetRow,mousePos:a.mousePos}):c.dragEnter({e:{event:a.event,sourceCtrl:a.sourceCtrl,dragRow:a.dragRow,targetCtrl:a.targetCtrl,targetRow:a.targetRow,mousePos:a.mousePos}})};this.callDragOver=function(b){var e=a.getCellAt(b.mousePos.x,b.mousePos.y);return angular.isDefined(c.events)&&c.events.dragOver?c.events.dragOver({event:b.event,sourceTree:b.sourceTree,dragRow:b.dragRow,targetTree:b.targetTree,targetRow:b.targetRow,targetCell:e,isDropAllowed:b.isDropAllowed,dropPos:b.dropPos,mousePos:b.mousePos}):
c.dragOver({e:{event:b.event,sourceTree:b.sourceTree,dragRow:b.dragRow,targetTree:b.targetTree,targetRow:b.targetRow,targetCell:e,isDropAllowed:b.isDropAllowed,dropPos:b.dropPos,mousePos:b.mousePos}})};this.callDragDrop=function(b){var e=a.getCellAt(b.mousePos.x,b.mousePos.y);return angular.isDefined(c.events)&&c.events.dragDrop?c.events.dragDrop({event:b.event,sourceTree:b.sourceTree,dragRow:b.dragRow,targetTree:b.targetTree,targetRow:b.targetRow,targetCell:e,isDropAllowed:b.isDropAllowed,dropPos:b.dropPos,
mousePos:b.mousePos}):c.dragDrop({e:{event:b.event,sourceTree:b.sourceTree,dragRow:b.dragRow,targetTree:b.targetTree,targetRow:b.targetRow,targetCell:e,isDropAllowed:b.isDropAllowed,dropPos:b.dropPos,mousePos:b.mousePos}})};this.callDragLeave=function(a){angular.isDefined(c.events)&&c.events.dragLeave?c.events.dragLeave({event:a.event,sourceCtrl:a.sourceCtrl,dragRow:a.dragRow,targetCtrl:a.targetCtrl,targetRow:a.targetRow,mousePos:a.mousePos}):c.dragLeave({e:{event:a.event,sourceCtrl:a.sourceCtrl,
dragRow:a.dragRow,targetCtrl:a.targetCtrl,targetRow:a.targetRow,mousePos:a.mousePos}})};this.callCellClick=function(a,e,r,t){angular.isDefined(c.events)&&c.events.cellClick&&c.events.cellClick({event:a,row:e,cell:r,mousePos:t});c.cellClick({e:{event:a,row:e,cell:r,mousePos:t}})};this.callCellDblClick=function(a,e,r){return angular.isDefined(c.events)&&c.events.cellDblClick?c.events.cellDblClick({row:a,cell:e,mousePos:r}):c.cellDblclick({e:{row:a,cell:e,mousePos:r}})};this.callCellHover=function(a,
e){angular.isDefined(c.events)&&c.events.cellHover?c.events.cellHover({event:a,cell:e}):c.cellHover({e:{event:a,cell:e}})};this.callEnabledChanged=function(a){angular.isDefined(c.events)&&c.events.enabledChanged?c.events.enabledChanged({enabled:a}):c.enabledChanged({e:{enabled:a}})};this.callRowClick=function(a,e,r){angular.isDefined(c.events)&&c.events.rowClick?c.events.rowClick({event:a,row:e,mousePos:r}):c.rowClick({e:{event:a,row:e,mousePos:r}})};this.callRowDblClick=function(a,e){return angular.isDefined(c.events)&&
c.events.rowDblClick?c.events.rowDblClick({row:a,mousePos:e}):c.rowDblclick({e:{row:a,mousePos:e}})};this.callRowHover=function(a,e){angular.isDefined(c.events)&&c.events.rowHover?c.events.rowHover({event:a,row:e}):c.rowHover({e:{event:a,row:e}})};this.callRowRightClick=function(a,e){angular.isDefined(c.events)&&c.events.rowRightClick&&c.events.rowRightClick({row:a,mousePos:e});c.rowRightclick({e:{row:a,mousePos:e}})};this.callKeyDown=function(a,e){angular.isDefined(c.events)&&c.events.keyDown?c.events.keyDown({event:a,
row:e}):c.keyDown({e:{event:a,row:e}})};this.callKeyPress=function(a,e){angular.isDefined(c.events)&&c.events.keyPress?c.events.keyPress({event:a,row:e}):c.keyPress({e:{event:a,row:e}})};this.callKeyUp=function(a,e){angular.isDefined(c.events)&&c.events.keyUp?c.events.keyUp({event:a,row:e}):c.keyUp({e:{event:a,row:e}})};this.callScrollPosChanged=function(){angular.isDefined(c.events)&&c.events.scrollPosChanged?c.events.scrollPosChanged({scrollPos:a.scrollPos}):c.scrollposChanged({e:{scrollPos:a.scrollPos}})};
f.bind("click",function(b){a.options.enabled&&1===b.which&&a.callRowClick(b,null,a.getMousePos(b))});f.bind("dblclick",function(b){b.preventDefault();a.options.enabled&&1===b.which&&a.callRowDblClick(null,a.getMousePos(b));b.stopPropagation()});f.bind("mousedown",function(b){a.options.enabled&&3===b.which&&a.callRowRightClick(null,a.getMousePos(b));a.removeDropDownList();a.closeFilterWindow();a.closeEditor();b.stopPropagation()});this.expandList=[];this.expandIndentList=[];this.suppressWatchScrollVisibility=
!1;var dc=function(b,e,c){b.type||(b.type="row");b[a.options.rowFields.id]||(b[a.options.rowFields.id]=m.getUniqueId());c&&(b[a.options.rowFields.pid]=c);c=!0;var r=b[a.options.rowFields.cells];if(r&&0<r.length){c=Xa(b);for(var f,g,l,p=0;p<a.columnList.length;p++){l=a.columnList[p];f=l[a.options.columnFields.id];g=l[a.options.columnFields.editorType];l=l[a.options.columnFields.editorSettings];var q=p;f&&(q=a.getCellIndexById(r,p,f));0<=q&&q<r.length&&(r[q].type="cell",a.setDefaultCellValue(r[q],g,
l))}}c&&(a.expandList.push(b),a.expandIndentList.push(e));return c},C=function(b,e,c){if(!b[a.options.rowFields.rows])return c=dc(b,e+Da,c);if(c=dc(b,e+Da,c)){var r=0,f;if("group"==b.type&&a.isRowExpanded(b)){var l=b[a.options.rowFields.rows];if(l){a.applySorting(l);for(var g=0;g<l.length;g++)(f=C(l[g],e+Da,b[a.options.rowFields.id]))&&r++}}!a.isThereChildRows&&(0<r||!a.isRowExpanded(b)&&b[a.options.rowFields.rows]&&0<b[a.options.rowFields.rows].length&&a.isThereVisibleChildren(b))&&(a.isThereChildRows=
!0)}return c};this.expand=function(b){a.expandList.length=[];a.expandIndentList.length=[];if(!a.isRowExpanded(b)){var e=a.getRowCurrentIndex(b);if(b=a.getList(b)){a.applySorting(b);for(var c=0;c<b.length;c++)C(b[c],a.indentList[e],null)}if(0<a.expandList.length){a.allowEvents=!1;e++;Array.prototype.splice.apply(a.currentList,[e,0].concat(a.expandList));Array.prototype.splice.apply(a.indentList,[e,0].concat(a.expandIndentList));a.getRowScope()?a.updateView():a.updateLayout();var t=l(function(){a.suppressWatchScrollVisibility=
!0;a.updateViewSize();a.updateViewSize();a.updateScrollVisibility();a.updateScrollView();a.allowEvents=!0;var b=l(function(){a.suppressWatchScrollVisibility=!1;l.cancel(b)},10);l.cancel(t)},1)}}};this.collapse=function(b){a.expandList.length=[];a.expandIndentList.length=[];if(a.isRowExpanded(b)){var e=null,c=!1,t=b,f=-1,g=a.getRowCurrentIndex(b);for(b=a.getParent(b);b&&!c;){e=a.getList(b);for(f=e.indexOf(t)+1;!c&&f<e.length;)t=e[f],0<a.getRowCurrentIndex(t)&&(c=!0),f++;c||(t=b);b=a.getParent(b)}if(!c&&
t)for(e=a.getList(),a.options.grouping.enabled&&0<a.groups.length&&(e=a.groupList),f=e.indexOf(t)+1;f<e.length;)if(t=e[f],0<a.getRowCurrentIndex(t)){c=!0;break}else f++;g++;e=a.currentList.length-g;c&&(e=a.getRowCurrentIndex(t)-g);if(0<e){a.currentList.splice(g,e);a.indentList.splice(g,e);a.getRowScope()?a.updateView():a.updateLayout();var m=l(function(){a.suppressWatchScrollVisibility=!0;a.updateViewSize();a.updateViewSize();a.updateScrollVisibility();a.updateScrollView();a.allowEvents=!0;var b=
l(function(){a.suppressWatchScrollVisibility=!1;l.cancel(b)},10);l.cancel(m)},1)}}};this.toggle=function(b,e){if(b){if((b[a.options.rowFields.hasChildren]||b[a.options.rowFields.rows]&&0!=b[a.options.rowFields.rows].length)&&!(e&&0!=b[a.options.rowFields.expanded]||!1===e&&0==b[a.options.rowFields.expanded])){a.updateType="view";var c=void 0!==e?e:!1!==b[a.options.rowFields.expanded]?!0:!1;c=void 0!=e?e:!c;c!=b[a.options.rowFields.expanded]&&(0!=c?a.expand(b):a.collapse(b),b[a.options.rowFields.expanded]=
c)}}else{c=a.getFullList();for(var t=0;t<c.length;t++)c[t][a.options.rowFields.expanded]=e;a.updateCurrentLayout()}};this.isFilteringAllowed=function(b){return b&&b[a.options.columnFields.allowFilter]};c.$on(c.name+"-filter",function(b,e,c){a.filter(e,c)});this.filter=function(b,e){if(b)b[a.options.columnFields.filterParams]=e;else for(var c=0;c<a.columnList.length;c++)a.columnList[c][a.options.columnFields.filterParams]=null;a.closeFilterWindow();a.updateCurrentLayout();a.callChange()};this.callGotFocus=
function(a,e,r,t,f){angular.isDefined(c.events)&&c.events.gotFocus?c.events.gotFocus({event:a,row:e,cell:r,edit:void 0!=t?!0:!1,editValue:f}):c.gotFocus({e:{event:a,row:e,cell:r,edit:void 0!=t?!0:!1,editValue:f}})};this.callLostFocus=function(a,e,r,t,f){angular.isDefined(c.events)&&c.events.lostFocus?c.events.lostFocus({event:a,row:e,cell:r,edit:void 0!=t?!0:!1,editValue:f}):c.lostFocus({e:{event:a,row:e,cell:r,edit:void 0!=t?!0:!1,editValue:f}})};this.getTabIndex=function(){return f[0].attributes&&
f[0].attributes.tabindex?f[0].attributes.tabindex.value:""};this.updateFocus=function(b,e){if(1==a.options.allowFocus)var c=l(function(){if(a.isRowIndexInRange(b)){var r="none";0<=e&&e<a.columnList.length&&(r=a.columnList[e][a.options.columnFields.fixed]);var g=a.getElemFromRow(a.currentList[b],r);g&&(1==a.options.allowCellFocus&&0<=e&&e<a.columnList.length?(r=a.getElemFromCell(b,e,r))&&r[0].focus():g[0].focus())}else f[0].focus();l.cancel(c)},5)};c.$on(c.name+"-focus",function(b,e){if(e)switch(e.type){case "group":var c=
a.getRowCurrentIndex(e);a.updateFocus(c);break;case "row":c=a.getRowCurrentIndex(e);a.updateFocus(c);break;case "cell":c=a.getCellRowIndex(e);var f=a.getCellColumnIndex(e);a.updateFocus(c,f)}else a.updateFocus()});var G=!1;this.getCell=function(b,e,c){var r=a.currentList;switch(c){case "top":r=a.currentTopList;break;case "bottom":r=a.currentBottomList}return 0<=b&&b<r.length&&(b=r[b],c=a.getColumnRealIndex(e),0<=e&&e<a.columnList.length&&(c=a.getCellIndexById(b[a.options.rowFields.cells],e,a.columnList[e].id)),
b[a.options.rowFields.cells]&&0<=c&&c<b[a.options.rowFields.cells].length)?b[a.options.rowFields.cells][c]:null};this.getCellObject=function(b,e){if(0<=b&&b<a.currentList.length){var c=a.currentList[b],f=a.getColumnRealIndex(e);0<=e&&e<a.columnList.length&&(f=a.getCellIndexById(c[a.options.rowFields.cells],e,a.columnList[e].id));if(c[a.options.rowFields.cells]&&0<=f&&f<c[a.options.rowFields.cells].length)return c[a.options.rowFields.cells][f]}return null};this.getCellIndexById=function(b,e,c){var r=
-1;if(b){e=a.getColumnRealIndex(e);for(var f=0;f<b.length;f++)if(void 0==b[f][a.options.cellFields.cid]){r=e;break}else if(b[f][a.options.cellFields.cid]==c){r=f;break}}return r};this.getCellIndexFromRow=function(b,e){var c=-1;if(b&&e&&e[a.options.rowFields.cells])for(var f=0;f<e[a.options.rowFields.cells].length;f++)if(e[a.options.rowFields.cells][f]==b){c=f;break}return c};this.getCellColumnIndex=function(b){if(b)if(b[a.options.cellFields.cid]){if(b=a.getColumnById(b[a.options.cellFields.cid]))return a.getColumnCurrentIndex(b)}else return a.getCellColumnIndexFromRow(b);
return-1};this.getCellColumnIndexFromRow=function(b){if(b&&b[a.options.cellFields.rid]){var e=a.findRowById(b[a.options.cellFields.rid]);if(e&&(e=e[a.options.rowFields.cells])&&0<e.length)return e.indexOf(b)}return-1};this.getCellRowIndex=function(b){return b&&b[a.options.cellFields.rid]&&(b=a.findRowById(b[a.options.cellFields.rid]))?a.getRowCurrentIndex(b):-1};this.getColumnById=function(b){for(var e=null,c=0;c<a.columnList.length;c++)if(a.columnList[c][a.options.columnFields.id]==b){e=a.columnList[c];
break}return e};this.getColumnObject=function(b){return 0<=b&&b<a.columnList.length?a.columnList[b]:null};this.getRowObject=function(b){return 0<=b&&b<a.currentList.length?a.currentList[b]:null};this.isRowExpanded=function(b){return b?b[a.options.rowFields.expanded]||void 0===b[a.options.rowFields.expanded]?!0:!1:!0};this.getContentElement=function(a,e){var b=null;e||(e="cell-content");if(a&&0<a.children().length)for(var c=a.children(),f=0;f<c.length;f++){var g=angular.element(c.eq(f));if(g[0].attributes&&
g[0].attributes["data-element"]&&g[0].attributes["data-element"].value==e){b=g;break}}return b};this.getElement=function(a,e){var b=null;e||(e="cell-content");if(a&&0<a.children().length){a=a.children().eq(0);for(var c=a.children(),f=0;f<c.length;f++){var g=angular.element(c.eq(f));if(g[0].attributes&&g[0].attributes["data-element"]&&g[0].attributes["data-element"].value==e){b=g;break}}}return b};this.getChildElement=function(a,e){var b=null;e||(e="content");if(a&&0<a.children().length)for(var c=
a.children(),f=0;f<c.length;f++){var g=angular.element(c.eq(f));if(g[0].attributes&&g[0].attributes["data-element"]&&g[0].attributes["data-element"].value==e){b=g;break}}return b};this.getElemFromColumn=function(b,e,c){var f=null;if(b){b=a.getColumnCurrentIndex(b);var r=a.getHeaderElem(e);"footer"==c&&(r=a.getFooterElem(e));if(r&&(e=r.find("td"))&&0<e.length)for(c=0;c<e.length;c++)if(r=angular.element(e[c]),r[0].attributes["data-index"]&&r[0].attributes["data-index"].value.toString()===b.toString()){f=
r;break}}return f};this.getElemFromRow=function(b,c,r){var e=null;if(b&&(b=a.getRowCurrentIndex(b,r),(c=a.getRowElems(c,r))&&0<c.length))for(r=0;r<c.length;r++){var f=angular.element(c[r]);if(f[0].attributes["data-index"]&&f[0].attributes["data-index"].value.toString()===b.toString()){e=f;break}}return e};this.getElemFromCell=function(b,c,f,g){var e=null;if(a.isRowIndexInRange(b,g)){switch(g){case "top":b=a.getElemFromRow(a.currentTopList[b],f,g);break;case "bottom":b=a.getElemFromRow(a.currentBottomList[b],
f,g);break;default:b=a.getElemFromRow(a.currentList[b],f,g)}if(b&&(b=b.find("td"))&&0<b.length)for(f=0;f<b.length;f++)if(g=angular.element(b[f]),g[0].attributes["data-index"]&&g[0].attributes["data-index"].value.toString()===c.toString()){e=g;break}}return e};this.getElemFromColumnCell=function(b,c,f,g,l){var e=null;b=a.getColumnCompleteIndex(b);if((c=f?a.getFooterElem(c):a.getHeaderElem(c))&&(c=c.find("td"))&&0<c.length)for(f=0;f<c.length;f++){var r=angular.element(c[f]);switch(g){case "column-expand-cell":r[0].attributes["data-element"]&&
r[0].attributes["data-element"].value.toString()==g&&r[0].attributes["data-level"]&&r[0].attributes["data-level"].value.toString()===b.level.toString()&&r[0].attributes["data-index"]&&r[0].attributes["data-index"].value.toString()===b.index.toString()&&(e=r);break;case "column-footer":r[0].attributes["data-index"]&&r[0].attributes["data-index"].value.toString()===l.toString()&&(e=r);break;default:r[0].attributes["data-level"]&&r[0].attributes["data-level"].value.toString()===b.level.toString()&&r[0].attributes["data-index"]&&
r[0].attributes["data-index"].value.toString()===b.index.toString()&&(e=r)}}return e};this.getIndent=function(b){var c=0;if(b)for(parent=a.rowsObj.getParent(b);parent;)c+=a.options.indent,parent=a.rowsObj.getParent(parent);return c};this.getObjState=function(b){if(b)switch(b.type){case "column":if(0==a.options.enabled)return"disabled";if(1==b[a.options.columnFields.selected])return"selected";if(b==a.hoverColumn)return"hovered";break;case "group":if(0==a.options.enabled||0==b[a.options.rowFields.enabled])return"disabled";
if(1==b.selected)return"selected";if(b==a.hoverRow)return"hovered";break;case "row":if(0==a.options.enabled||0==b[a.options.rowFields.enabled])return"disabled";if(1==b[a.options.rowFields.selected])return"selected";if(b==a.hoverRow)return"hovered";break;case "cell":if(0==a.options.enabled||0==b[a.options.cellFields.enabled])return"disabled";if(1==b[a.options.cellFields.selected])return"selected";if(b==a.hoverCell)return"hovered"}return"normal"};this.getColumnAt=function(b,c){if(void 0==b||void 0==
c)return a.hoverColumn;var e=null;var f="left";for(var g=0;!e&&3>g;){if(f=a.getHeaderElem(f)){var l=f.find("td");if(l&&0<l.length)for(var p=0;p<l.length;p++){f=angular.element(l[p]);var q=m.getPageRect(f);if(m.checkHit(b,c,q)){e=a.getColumnFromElem(f);break}}}g++;f=1==g?"right":"none"}return e};this.getCellAt=function(b,c){var e=null,f=a.getRowAt(b,c);if(f){var g=a.getElemFromRow(f).find("td");if(g&&0<g.length)for(var l=0;l<g.length;l++){var p=angular.element(g[l]);var q=m.getPageRect(p);if(m.checkHit(b,
c,q)&&(e=a.getRowCurrentIndex(f),p=a.getIndexFromElem(p),e=a.getCellObject(e,p)))break}}return e};this.getRowAt=function(b,c){var e=null;var f="none";for(var g=0;!e&&3>g;){var l=a.getRowElems(f);if(l&&0<l.length)for(var p=0;p<l.length;p++){f=angular.element(l[p]);var q=m.getPageRect(f);if(m.checkHit(b,c,q)){e=a.getRowFromElem(f);break}}g++;f=1==g?"left":"right"}return e};this.getRowCurrentIndex=function(b){if(b){switch(b[a.options.rowFields.fixed]){case "top":return a.currentTopList?a.currentTopList.indexOf(b):
-1;case "bottom":return a.currentBottomList?a.currentBottomList.indexOf(b):-1}return a.currentList?a.currentList.indexOf(b):-1}return-1};this.getObjCurrentIndex=function(b){return a.getRowCurrentIndex(b)};this.getRowFromChildElem=function(b){if(b&&(b=angular.element(b))){for(b=b.parent();b&&b[0].tagName&&"tr"!==b[0].tagName.toLowerCase();)b=b.parent();return b?a.getRowFromElem(b):null}return null};this.getColumnCompleteIndex=function(b){var c={level:-1,index:-1};if(b&&a.completeColumnList)for(var f=
0;f<a.completeColumnList.length;f++){for(var g=0;g<a.completeColumnList[f].length;g++){var l=a.completeColumnList[f][g];if(l.column==b||m.isEqual(l.column[a.options.columnFields.id],b[a.options.columnFields.id])){c={level:f,index:g};break}}if(0<=c.index)break}return c};this.getColumnCurrentIndex=function(b){return b&&a.columnList?a.columnList.indexOf(b):-1};this.getFullColumnList=function(){return a.columnsObj.getList()};this.getColumnRealIndex=function(b){var c=a.columnsObj.getList();return 0<=b&&
b<c.length&&b<a.columnList.length?c.indexOf(a.columnList[b]):-1};this.getColumnFromChildElem=function(b){return b?a.getColumnFromElem(b):null};this.getColumnFromElem=function(b){if(b&&(b=angular.element(b))&&b[0].attributes["data-level"]&&b[0].attributes["data-index"]){var c=b[0].attributes["data-level"].value;b=b[0].attributes["data-index"].value;if(0<=c&&c<a.completeColumnList.length&&0<=b&&b<a.completeColumnList[c].length)return a.completeColumnList[c][b].column}return null};this.getIndexFromElem=
function(a){return a&&(a=angular.element(a))&&a[0].attributes["data-index"]?a[0].attributes["data-index"].value:-1};this.getRowFromElem=function(b){if(b&&(b=angular.element(b))&&b[0].attributes["data-index"]){var c=b[0].attributes["data-index"].value,f="none";b&&b[0].attributes["data-fixed"]&&(f=b[0].attributes["data-fixed"].value);switch(f){case "top":if(a.isRowIndexInRange(c,f))return a.currentTopList[c];break;case "bottom":if(a.isRowIndexInRange(c,f))return a.currentBottomList[c];break;default:if(a.isRowIndexInRange(c))return a.currentList[c]}}};
this.isColumnVisible=function(b){return b&&0!=b[a.options.columnFields.visible]?!0:!1};this.isColumnIndexInRange=function(b){return 0<=b&&b<a.columnList.length};this.isRowIndexInRange=function(b,c){switch(c){case "top":return 0<=b&&b<a.currentTopList.length;case "bottom":return 0<=b&&b<a.currentBottomList.length}return 0<=b&&b<a.currentList.length};this.isColIndexInRange=function(b){return 0<=b&&b<a.columnList.length};this.isRowEnabled=function(b){return b&&1==a.options.enabled&&m.isEnabled(b[a.options.rowFields.enabled])};
this.mouseButtonStatus=function(a){G=a};c.$on(c.name+"-ensure-visible",function(b,c){a.ensureVisible(c)});c.$on(c.name+"-find-row-by-id",function(b,c){p.setTempData(a.findRowById(c))});c.$on(c.name+"-find-row-by-text",function(b,c){p.setTempData(a.findRowByText(c))});c.$on(c.name+"-get-list",function(b,c){p.setTempData(a.getList(c))});c.$on(c.name+"-get-top-row",function(b){p.setTempData(a.getTopRow())});c.$on(c.name+"-set-top-row",function(b,c){a.ensureVisible(c)});this.ensureVisible=function(b,
c){if(b){for(var e=[],f=a.getParent(b);f;)e.push(f),f=a.getParent(f);for(f=e.length-1;0<=f;f--)e[f][a.options.rowFields.expanded]=!0;a.updateCurrentLayout();var g=l(function(){c=void 0!=c?c:"center";a.scrollTo(b,c);l.cancel(g)},100)}};this.findRowById=function(b){return a.rowsObj.findObjectById(b)};this.findRowByText=function(b){return a.rowsObj.findObjectByText(b)};this.getLevel=function(a){var b=0;for(a=this.getParent(a);a;)b++,a=this.getParent(a);return b};this.findParent=function(b,c){var e=null;
if(b&&c)for(var f=0;!e&&f<c.length;)e=c[f][a.options.rowFields.id]&&b[a.options.rowFields.pid]&&c[f][a.options.rowFields.id].toString()===b[a.options.rowFields.pid].toString()?c[f]:a.findParent(b,c[f][a.options.rowFields.rows]),f++;return e};this.getParent=function(b){return b?a.findParent(b,a.groupList):null};this.getList=function(b){return a.rowsObj.getList(b)};this.findParentColumn=function(b){var c=null;if(b)for(var f=0;f<a.completeColumnList.length;f++){for(var g=0;g<a.completeColumnList[f].length;g++){var l=
a.completeColumnList[f][g].column;if(l[a.options.columnFields.id]&&b[a.options.columnFields.pid]&&l[a.options.columnFields.id].toString()===b[a.options.columnFields.pid].toString()){c=l;break}}if(c)break}return c};this.getParentColumn=function(b){return b?a.findParentColumn(b):null};this.getColumnLevel=function(b){var c=-1;if(b)for(var f=0;f<a.completeColumnList.length;f++){for(var g=0;g<a.completeColumnList[f].length;g++){var l=a.completeColumnList[f][g].column;if(l==b||m.isEqual(l[a.options.columnFields.id],
b[a.options.columnFields.id])){c=f;break}}if(0<=c)break}return c};this.getFirstRow=function(){for(var b=null,c=0;c<a.currentList.length;c++)if(m.isEnabled(a.currentList[c][a.options.rowFields.enabled])){b=a.currentList[c];break}return b};this.getPrevRow=function(b){var c=null;if(0<=b&&b<a.currentList.length)for(--b;0<=b;b--)if(m.isEnabled(a.currentList[b][a.options.rowFields.enabled])){c=a.currentList[b];break}return c};this.getNextRow=function(b){var c=null;for(b+=1;b<a.currentList.length;b++)if(m.isEnabled(a.currentList[b][a.options.rowFields.enabled])){c=
a.currentList[b];break}return c};this.getLastRow=function(){for(var b=null,c=a.currentList.length-1;0<=c;c--)if(m.isEnabled(a.currentList[c][a.options.rowFields.enabled])){b=a.currentList[c];break}return b};this.updateSelectionStatus=function(b){switch(b){case "shift":switch(a.options.selectionMode){case "multi-simple":a.multiSelection(!0);break;case "multi-extended":a.multiSelection(!0);break;default:a.multiSelection(!1)}break;case "ctrl":switch(a.options.selectionMode){case "multi-simple":a.multiSelection(!0);
break;case "multi-extended":a.multiSelection(!0);break;default:a.multiSelection(!1)}}};f.bind("keydown",function(b){if(a.options.enabled)switch(b.keyCode){case 16:a.updateSelectionStatus("shift");break;case 17:a.updateSelectionStatus("ctrl");break;default:(b.ctrlKey||b.metaKey)&&a.updateSelectionStatus("ctrl"),b.shiftKey&&a.updateSelectionStatus("shift")}});this.allowUpdate=!0;this.updateType="all";this.suspendLayout=function(b){a.allowUpdate=!1};this.resumeLayout=function(b){a.allowUpdate=!0;b?a.updateCurrentLayout():
a.updateLayout()};c.$on(c.name+"-refresh",function(b,c,f){a.refresh(c,f)});c.$on(c.name+"-resume-layout",function(b,c){a.resumeLayout(c)});c.$on(c.name+"-suspend-layout",function(b,c){a.suspendLayout(c)});c.$on(c.name+"-update-current-layout",function(b){a.updateCurrentLayout()});c.$on(c.name+"-update-layout",function(b,c){c?a.updateCurrentLayout():a.updateLayout()});c.$on(c.name+"-update-view",function(b){a.updateView()});c.$on(c.name+"-begin-load",function(b,c){a.beginLoad(c)});c.$on(c.name+"-end-load",
function(b){a.endLoad()});this.callLoadComplete=function(){angular.isDefined(c.events)&&c.events.loadComplete?c.events.loadComplete():c.loadComplete()};this.callUpdateComplete=function(){angular.isDefined(c.events)&&c.events.updateComplete?c.events.updateComplete():c.updateComplete()};c.$on(c.name+"-get-current-page",function(b){p.setTempData(a.currentPageNumber)});c.$on(c.name+"-set-current-page",function(b,c){a.setCurrentPage(c)});c.$on(c.name+"-first-page",function(b){a.firstPage()});c.$on(c.name+
"-last-page",function(b){a.lastPage()});c.$on(c.name+"-next-page",function(b){a.nextPage()});c.$on(c.name+"-prev-page",function(b){a.prevPage()});this.setCurrentPage=function(b){a.currentPageNumber!=b&&1<=b&&b<=a.pageList.length&&(a.currentPageNumber=b,a.updateCurrentLayout())};this.firstPage=function(){1!=a.currentPageNumber&&(a.currentPageNumber=1,a.updateCurrentLayout())};this.lastPage=function(){a.currentPageNumber!=a.pageList.length&&(a.currentPageNumber=a.pageList.length,a.updateCurrentLayout())};
this.nextPage=function(){a.currentPageNumber<a.pageList.length&&(a.currentPageNumber++,a.updateCurrentLayout())};this.prevPage=function(){1<a.currentPageNumber&&(a.currentPageNumber--,a.updateCurrentLayout())};c.$on(c.name+"-get-max-scroll-pos",function(b){p.setTempData(a.getMaxScrollPos())});c.$on(c.name+"-get-scroll-pos",function(b){p.setTempData(a.getScrollPos())});c.$on(c.name+"-set-scroll-pos",function(b,c){a.setScrollPos(c)});c.$on(c.name+"-scroll-to",function(b,c,f){a.scrollTo(c,f)});var I=
!1;this.shiftFirstSelectedRow=this.shiftFirstSelectedColumn=null;this.multiSelection=function(a){if(void 0!=a)I=a;else return I};this.columnSelection=function(b,e){if(b){var f=a.columnSelection(),g=!0,l=!0;l=angular.isDefined(c.events)&&c.events.beforeSelect?c.events.beforeSelect({object:b}):c.beforeSelect({e:{object:b}});if(g&&!1!==l)if(l=e&&(e.shiftKey||e.ctrlKey||e.metaKey)?!0:!1,g){(g=(g=!a.isColumnInSelList(b)||!l||e&&e.shiftKey)&&!(a.isColumnInSelList(b)&&e&&3==e.which))&&(e&&e.shiftKey||!l)&&
a.clearPrevColumnSelection();a.options.selectedColumn=b;if(e&&e.shiftKey){if(a.shiftFirstSelectedColumn||(a.shiftFirstSelectedColumn=f),g=a.getColumnCurrentIndex(a.shiftFirstSelectedColumn),f=a.getColumnCurrentIndex(b),g>f&&(l=g,g=f,f=l),a.isColumnIndexInRange(g)&&a.isColumnIndexInRange(f))for(;g<=f;g++)a.columnList[g][a.options.columnFields.selected]=!0,a.options.selectedColumns.push(a.columnList[g])}else l?(f=null===b[a.options.columnFields.selected]||"undefined"===b[a.options.columnFields.selected]?
!1:b[a.options.columnFields.selected],b[a.options.columnFields.selected]=!f,b[a.options.columnFields.selected]?a.isColumnInSelList(b)||a.options.selectedColumns.push(b):a.options.selectedColumns=a.options.selectedColumns.filter(function(a){return a!=b})):(b[a.options.columnFields.selected]=!0,a.isColumnInSelList(b)||a.options.selectedColumns.push(b)),a.shiftFirstSelectedColumn=null;angular.isDefined(c.selectedColumn)&&(c.selectedColumn=b);a.callAfterSelect(b);a.refreshColumns()}else l?(f=null===b[a.options.columnFields.selected]||
"undefined"===b[a.options.columnFields.selected]?!1:b[a.options.columnFields.selected],value&&"undefined"!==value&&(f=value),b[a.options.columnFields.selected]=!f,b[a.options.columnFields.selected]?a.isColumnInSelList(b)||a.options.selectedColumns.push(b):a.options.selectedColumns=a.options.selectedColumns.filter(function(a){return a!=b}),a.shiftFirstSelectedColumn=null,a.callAfterSelect(b),a.refreshColumns()):l||(l||1!=a.options.selectedColumns.length&&a.isColumnInSelList(b)||a.clearPrevColumnSelection(b),
a.shiftFirstSelectedColumn=null)}else return a.options.selectedColumn};this.clearPrevColumnSelection=function(b){for(var c=0;c<a.options.selectedColumns.length;c++)b&&!m.isEqual(a.options.selectedColumns[c][a.options.columnFields.id],b[a.options.columnFields.id])?a.options.selectedColumns[c][a.options.columnFields.selected]=!1:b||(a.options.selectedColumns[c][a.options.columnFields.selected]=!1);a.options.selectedColumns.length=0;b&&a.options.selectedColumns.push(b);a.refreshColumns()};this.isColumnInSelList=
function(b){var c=!1,f=a.options.selectedColumns;if(b&&f)for(var g=0;g<f.length;g++)if(m.isEqual(f[g][a.options.columnFields.id],b[a.options.columnFields.id])){c=!0;break}return c};this.updateColumnSelection=function(b,c){var e=c&&(c.shiftKey||c.ctrlKey||c.metaKey)?!0:!1;0<a.options.selectedColumns.length&&!e&&(a.clearPrevColumnSelection(),b[a.options.columnFields.selected]=!0,a.options.selectedColumns.push(b),a.callAfterSelect(b),a.refreshColumns())};this.isRowSelected=function(a){return m.isSelected(a)};
this.clearPrevSelection=function(b){for(var c=0;c<a.options.selectedRows.length;c++)b&&!m.isEqual(a.options.selectedRows[c][a.options.rowFields.id],b[a.options.rowFields.id])?a.options.selectedRows[c][a.options.rowFields.selected]=!1:b||(a.options.selectedRows[c][a.options.rowFields.selected]=!1);a.options.selectedRows.length=0;b&&0!=b[a.options.rowFields.enabled]&&a.options.selectedRows.push(b);a.refreshRows()};this.markSelColumn=function(){for(var b=0;b<a.columnList.length;b++)a.refresh(a.columnList[b])};
this.rowSelection=function(b,e,f,g,l,p){if(b){if("none"!=a.options.selectionMode)if(a.isRowEnabled(b)){var r=a.rowSelection(),q=!0;r&&(q=!m.isEqual(r[a.options.rowFields.id],b[a.options.rowFields.id]));var t=!0;t=angular.isDefined(c.events)&&c.events.beforeSelect?c.events.beforeSelect({object:b}):c.beforeSelect({e:{object:b}});if(!1!==t)if(f=e||f||g?!0:!1,q){q=!0;"multi-extended"==a.options.selectionMode&&(q=(q=!a.isObjInSelList(b)||!f||e)&&!(a.isObjInSelList(b)&&p));q&&("one"==a.options.selectionMode?
a.clearPrevSelection():G&&e?a.clearPrevSelection():I||f||"multi-simple"===a.options.selectionMode||a.clearPrevSelection());a.options.selectedRow=b;if(G&&e&&"one"!=a.options.selectionMode){if(a.shiftFirstSelectedRow||(a.shiftFirstSelectedRow=r),e=a.getRowCurrentIndex(a.shiftFirstSelectedRow),l=a.getRowCurrentIndex(b),e>l&&(p=e,e=l,l=p),a.isRowIndexInRange(e)&&a.isRowIndexInRange(l))for(;e<=l;e++)a.currentList[e][a.options.rowFields.selected]=!0,a.options.selectedRows.push(a.currentList[e])}else G&&
(I||f||"multi-simple"===a.options.selectionMode)?(e=null===b[a.options.rowFields.selected]||"undefined"===b[a.options.rowFields.selected]?!1:b[a.options.rowFields.selected],b[a.options.rowFields.selected]=!e,b[a.options.rowFields.selected]?a.isObjInSelList(b)||a.options.selectedRows.push(b):a.options.selectedRows=a.options.selectedRows.filter(function(a){return a!=b})):(b[a.options.rowFields.selected]=!0,a.isObjInSelList(b)||a.options.selectedRows.push(b)),a.shiftFirstSelectedRow=null;angular.isDefined(c.selectedRow)&&
(c.selectedRow=b);a.callAfterSelect(b);a.refresh(null,null,!0)}else I||f||"multi-simple"===a.options.selectionMode?(e=null===b[a.options.rowFields.selected]||"undefined"===b[a.options.rowFields.selected]?!1:b[a.options.rowFields.selected],l&&"undefined"!==l&&(e=l),b[a.options.rowFields.selected]=!e,b[a.options.rowFields.selected]?a.isObjInSelList(b)||a.options.selectedRows.push(b):a.options.selectedRows=a.options.selectedRows.filter(function(a){return a!=b}),a.shiftFirstSelectedRow=null,a.callAfterSelect(b),
a.refresh(null,null,!0)):I||f||"multi-simple"===a.options.selectionMode||(f||1!=a.options.selectedRows.length&&a.isObjInSelList(b)||a.clearPrevSelection(b),a.shiftFirstSelectedRow=null)}else a.clearPrevSelection()}else return a.options.selectedRow};this.updateSelection=function(b,c,f){b=b&&(b.shiftKey||b.ctrlKey||b.metaKey)?!0:!1;"multi-extended"==a.options.selectionMode&&0<a.options.selectedRows.length&&!f&&!I&&!b&&(a.clearPrevSelection(),c[a.options.rowFields.selected]=!0,a.options.selectedRows.push(c),
a.callAfterSelect(c),a.refresh(null,null,!0))};this.isObjInSelList=function(b){var c=!1,f=a.options.selectedRows;if(b&&f)for(var g=0;g<f.length;g++)if(m.isEqual(f[g][a.options.rowFields.id],b[a.options.rowFields.id])){c=!0;break}return c};c.$on(c.name+"-clear-selection",function(b){a.options.selectedColumn&&(a.options.selectedColumn[a.options.columnFields.selected]=!1);a.options.selectedColumn=null;a.clearPrevSelection();a.options.selectedRow=null});c.$on(c.name+"-get-hover-column",function(b,c){a.hoverColumn?
p.setTempData(a.hoverColumn):c&&p.setTempData(a.getColumnAt({x:c.x,y:c.y}))});c.$on(c.name+"-get-selected-column",function(b){p.setTempData(a.columnSelection())});c.$on(c.name+"-set-selected-column",function(b,c){a.columnSelection(c)});c.$on(c.name+"-get-selected-columns",function(b){p.setTempData(a.options.selectedColumns)});c.$on(c.name+"-set-selected-columns",function(b,c){c&&Array.isArray(c)&&l(function(){for(var b=0;b<a.options.selectedColumns.length;b++)a.options.selectedColumns[b][a.options.columnFields.selected]=
!1;for(b=a.options.selectedColumns.length=0;b<c.length;b++)c[b][a.options.columnFields.selected]=!0,a.options.selectedColumns.push(c[b]);0<c.length?(a.options.selectedColumn=c[c.length-1],a.callAfterSelect(a.options.selectedColumn)):a.options.selectedColumn=null;a.refreshColumns()},1)});c.$on(c.name+"-get-selected-row",function(b){p.setTempData(a.rowSelection())});c.$on(c.name+"-set-selected-row",function(b,c){var e=l(function(){a.rowSelection(c);l.cancel(e)},1)});c.$on(c.name+"-get-selected-rows",
function(b){p.setTempData(a.options.selectedRows)});c.$on(c.name+"-set-selected-rows",function(b,c){c&&Array.isArray(c)&&l(function(){for(var b=a.options.selectedRows.length=0;b<c.length;b++)c[b][a.options.rowFields.selected]=!0,a.options.selectedRows.push(c[b]);0<c.length?(a.options.selectedRow=c[c.length-1],a.callAfterSelect(a.options.selectedRow)):a.options.selectedRow=null;a.refresh(null,null,!0)},1)});c.$on(c.name+"-move-column",function(b,c,f){a.moveColumn(c,f)});c.$on(c.name+"-move-row",function(b,
c,f,g,l){a.moveRow(c,f,g,l)});c.$watch("options",function(b,c){b!==c&&(a.updateOptions(b),a.updateLayout())},!0);c.$watch("allowCellFocus",function(b,c){b!==c&&(a.options.allowCellFocus=b)});c.$watch("allowColumnReorder",function(b,c){b!==c&&(a.options.allowColumnReorder=b)});c.$watch("allowFilter",function(b,c){b!==c&&(a.options.allowFilter=b)});c.$watch("allowFocus",function(b,c){b!==c&&(a.options.allowFocus=b)});c.$watch("allowDrag",function(b,c){b!==c&&(a.options.allowDrag=b,a.updateView())});
c.$watch("allowDrop",function(b,c){b!==c&&(a.options.allowDrop=b,a.updateView())});c.$watch("autoExpand",function(b,c){b!==c&&(a.options.autoExpand=b)});c.$watch("autoUpdate",function(b,c){b!==c&&(a.options.autoUpdate=b,a.updateLayout())});c.$watch("columns",function(b,e){b!==e&&(a.columnsObj=new ba({objects:c.columns,events:a.columnEvents,fields:a.options.columnFields}))});c.$watch("columnRelations",function(b,e){b!==e&&(a.columnRelationsObj=new ba({objects:c.columnRelations,fields:a.options.columnFields}))});
c.$watch("controlStyle",function(b,c){b!==c&&a.updateControlStyle(b)});c.$watch("displayMode",function(b,c){b!==c&&(a.options.displayMode=b,a.updateLayout())});c.$watch("editorSettings",function(b,c){b!==c&&a.updateEditorSettings(b)});c.$watch("enabled",function(b,c){b!==c&&(a.options.enabled=b,a.updateView(),a.options.grouping.enabled&&a.updateGroupPanel(),a.options.paging.enabled&&a.options.paging.showControlPanel&&a.updatePaginationPanel(),a.callEnabledChanged(b))});c.$watch("expandingColumnIndex",
function(b,c){b!==c&&(a.options.expandColIndex=b)});c.$watch("fields",function(b,c){b!==c&&(a.updateDataFields(b),a.UpdateData())});c.$watch("fillSpace",function(b,c){b!==c&&(a.options.fillSpace=b)});c.$watch("gridLines",function(b,c){b!==c&&(a.options.gridLines=b,a.updateView())});c.$watch("grouping",function(b,c){b!==c&&(a.updateGrouping(b),a.updateLayout())},!0);c.$watch("groups",function(b,e){b!==e&&(a.groupsObj=new ba({objects:c.groups,events:a.groupEvents,fields:a.options.columnFields}),a.updateLayout())});
c.$watch("hoverSelection",function(b,c){b!==c&&(a.options.hoverSelection=b)});c.$watch("indent",function(b,c){b!==c&&(a.options.indent=b,a.updateLayout())});c.$watch("mouseWheelSpeed",function(b,c){b!==c&&(a.options.mouseWheelSpeed=b)});c.$watch("rowHeight",function(b,c){b!==c&&(a.options.rowHeight=b,a.updateLayout())});c.$watch("rowIcon",function(b,c){b!==c&&(a.options.rowIcon=b,a.updateLayout())});c.$watch("labelEdit",function(b,c){b!==c&&(a.options.labelEdit=b)});c.$watch("paging",function(b,c){b!==
c&&(a.updatePaging(b),a.resetPageNumber(),a.updateCurrentLayout())},!0);c.$watch("pathSeparator",function(b,c){b!==c&&(a.options.pathSeparator=b)});c.$watch("rows",function(b,e){b!==e&&(a.rowsObj=new ba({objects:c.rows,events:a.rowEvents,fields:a.getRowFields(a.options.rowFields)}))});c.$watch("rtl",function(b,c){b!==c&&(a.options.rtl=b,a.updateLayout())});a.resetSelection=function(){switch(a.options.selectionMode){case "none":a.clearPrevSelection();break;default:a.clearPrevSelection(a.rowSelection())}};
c.$watch("selectionMode",function(b,c){b!==c&&(a.options.selectionMode=b,a.resetSelection())});c.$watch("showFooter",function(b,c){b!==c&&(a.options.showFooter=b,a.updateLayout())});c.$watch("showHeader",function(b,c){b!==c&&(a.options.showHeader=b,a.updateLayout())});c.$watch("showIcons",function(b,c){b!==c&&(a.options.showIcons=b,a.updateLayout())});c.$watch("showScroll",function(b,c){b!==c&&(a.updateShowScroll(b),a.updateScrollVisibility(),a.updateScrollView())},!0);c.$watch("selectedRow",function(b,
c){b!==c&&(c&&(c[a.options.rowFields.selected]=!1),a.options.selectedRow=b,a.callAfterSelect(b))});this.sortComparer=this.sortColumn=null;c.$watch("sorting",function(b,c){b!==c&&(a.options.sorting=b)});c.$on(c.name+"-sort",function(b,c,f,g){a.sort(c,f,g)});this.sort=function(b,c,f){a.sortColumn=b;a.sortComparer=f;if("ascending"==c||"descending"==c||"none"==c)a.options.sorting=c;a.updateCurrentLayout();a.callChange()};this.getCellIndexInCollection=function(b,c,f){var e=-1;if(b)for(var g=0;g<b.length;g++)if(void 0==
b[g][a.options.cellFields.cid]){e=c;break}else if(b[g][a.options.cellFields.cid]==f){e=g;break}return e};this.isSortingAllowed=function(){return"ascending"==a.options.sorting||"descending"==a.options.sorting};this.applySorting=function(b){if(b&&(!a.sortColumn||0!=a.sortColumn[a.options.columnFields.visible])){var c=a.getColumnCurrentIndex(a.sortColumn),f=0<=c?c:a.options.expandColIndex;if(f<a.columnList.length){var g=a.columnList[f][a.options.columnFields.id];a.sortColumn&&a.sortColumn[a.options.columnFields.comparer]?
b.sort(a.sortColumn[a.options.columnFields.comparer]):a.sortComparer?b.sort(a.sortComparer):a.isSortingAllowed()&&b.sort(function(b,c){var e=null,l=null;if(b[a.options.rowFields.cells]){var r=a.getCellIndexInCollection(b[a.options.rowFields.cells],f,g);0<=r&&((e=b[a.options.rowFields.cells][r][a.options.cellFields.value])||(e=b[a.options.rowFields.cells][r][a.options.cellFields.text]),m.isObject(e)&&(e=e.value?e.value:e.text))}c[a.options.rowFields.cells]&&(r=a.getCellIndexInCollection(c[a.options.rowFields.cells],
f,g),0<=r&&((l=c[a.options.rowFields.cells][r][a.options.cellFields.value])||(l=c[a.options.rowFields.cells][r][a.options.cellFields.text]),m.isObject(l)&&(l=l.value?l.value:l.text)));e=void 0!=e?e:null;l=void 0!=l?l:null;switch(a.options.sorting){case "ascending":if(e<l)return-1;if(e>l)return 1;break;case "descending":if(e>l)return-1;if(e<l)return 1;break;default:return 0}})}}};var ob=function(b){if(b){var c=m.isFieldAvailable(b.general,"iui-grid-column");var f=(f=b.header)?{content:m.isFieldAvailable(f.content,
"iui-grid-column-header-cell-content"),disabled:m.isFieldAvailable(f.disabled,"iui-grid-column-header-disabled"),normal:m.isFieldAvailable(f.normal,"iui-grid-column-header"),hovered:m.isFieldAvailable(f.hovered,"iui-grid-column-header-hovered"),selected:m.isFieldAvailable(f.selected,"iui-grid-column-header-selected")}:a.options.controlStyle.column.header;b=(b=b.footer)?{content:m.isFieldAvailable(b.content,"iui-grid-column-footer-cell-content"),disabled:m.isFieldAvailable(b.disabled,"iui-grid-column-footer-disabled"),
normal:m.isFieldAvailable(b.normal,"iui-grid-column-footer"),hovered:m.isFieldAvailable(b.hovered,"iui-grid-column-footer-hovered"),selected:m.isFieldAvailable(b.selected,"iui-grid-column-footer-selected")}:a.options.controlStyle.column.footer;return{general:c,header:f,footer:b}}return a.options.controlStyle.column};this.getExpandBoxStyle=function(b){return b?{general:m.isFieldAvailable(b.general,"iui-grid-expand-box"),animated:m.isFieldAvailable(b.animated,"iui-grid-expand-box-load"),expanded:m.isFieldAvailable(b.expanded,
"iui-grid-expand-box-open"),collapsed:m.isFieldAvailable(b.collapsed,"iui-grid-expand-box-close")}:a.options.controlStyle.row.expandBox};var La=function(b){if(b){var c=(c=b.general)?{disabled:m.isFieldAvailable(c.disabled,"iui-grid-row-disabled"),focused:m.isFieldAvailable(c.focused,"iui-grid-row-focused"),normal:m.isFieldAvailable(c.normal,"iui-grid-row"),hovered:m.isFieldAvailable(c.hovered,"iui-grid-row-hovered"),selected:m.isFieldAvailable(c.selected,"iui-grid-row-selected")}:a.options.controlStyle.row.general;
var f=b.checkBox;if(f){var g=m.isFieldAvailable(f.general,"iui-checkbox");f=(f=f.box)?{general:m.isFieldAvailable(f.general,"iui-checkbox-box"),disabled:m.isFieldAvailable(f.disabled,"iui-checkbox-disabled"),checked:m.isFieldAvailable(f.checked,"iui-checkbox-checked"),indeterminate:m.isFieldAvailable(f.indeterminate,"iui-checkbox-indeterminate"),unchecked:m.isFieldAvailable(f.unchecked,"iui-checkbox-unchecked")}:a.options.controlStyle.row.checkBox.box;g={general:g,box:f}}else g=a.options.controlStyle.row.checkBox;
f=a.getExpandBoxStyle(b.expandBox);var l=(l=b.cell)?{content:m.isFieldAvailable(l.content,"iui-grid-row-cell-content"),general:m.isFieldAvailable(l.general,"iui-grid-row-cell"),disabled:m.isFieldAvailable(l.disabled,"iui-grid-row-cell-disabled"),focused:m.isFieldAvailable(l.focused,"iui-grid-row-cell-focused"),normal:m.isFieldAvailable(l.normal,"iui-grid-row-cell"),hovered:m.isFieldAvailable(l.hovered,"iui-grid-row-cell-hovered"),selected:m.isFieldAvailable(l.selected,"iui-grid-row-cell-selected")}:
a.options.controlStyle.row.cell;b=(b=b.fixed)?{disabled:m.isFieldAvailable(b.disabled,"iui-grid-row-fixed-disabled"),normal:m.isFieldAvailable(b.normal,"iui-grid-row-fixed"),hovered:m.isFieldAvailable(b.hovered,"iui-grid-row-fixed-hovered")}:a.options.controlStyle.row.fixed;return{general:c,checkBox:g,expandBox:f,cell:l,fixed:b}}return a.options.controlStyle.row},pb=function(b){return b?{content:m.isFieldAvailable(b.content,"iui-grid-row-cell-content"),general:m.isFieldAvailable(b.general,"iui-grid-row-cell"),
disabled:m.isFieldAvailable(b.disabled,"iui-grid-row-cell-disabled"),focused:m.isFieldAvailable(b.focused,"iui-grid-row-cell-focused"),normal:m.isFieldAvailable(b.normal,"iui-grid-row-cell"),hovered:m.isFieldAvailable(b.hovered,"iui-grid-row-cell-hovered"),selected:m.isFieldAvailable(b.selected,"iui-grid-row-cell-selected")}:a.options.controlStyle.cell};this.updateControlStyle=function(b){a.options.controlStyle=b?{general:m.isFieldAvailable(b.general,"iui-grid"),column:ob(b.column),row:La(b.row),
cell:pb(b.cell)}:{general:m.isFieldAvailable(a.defaultStyle.general,"iui-grid"),column:ob(a.defaultStyle.column),row:La(a.defaultStyle.row),cell:pb(a.defaultStyle.cell)}};this.getCurrentColumnStyle=function(b,c,f){var e=a.options.controlStyle.column;b&&b.style&&(e=b.style);b=a.options.controlStyle.column.body;var g=e.body;switch(c){case "header":b=a.options.controlStyle.column.header;g=e.header;break;case "footer":b=a.options.controlStyle.column.footer,g=e.footer}if(f)switch(f){case "content":return g&&
g.content?g.content:b.content;case "disabled":return g&&g.disabled?g.disabled:b.disabled;case "hovered":return g&&g.hovered?g.hovered:b.hovered;case "selected":return g&&g.selected?g.selected:b.selected;default:return g&&g.normal?g.normal:b.normal}else return c?g?g:b:e?e:a.options.controlStyle.column};this.getCurrentRowStyle=function(b,c){var e=a.options.controlStyle.row;if(b)switch(b[a.options.rowFields.style]){case "initial":break;case "parent":return a.getCurrentRowStyle(a.getParent(b),c);default:null!=
b.style&&(e=b.style)}if(c){if(m.isString(e.general))return e.general;if(a.isRowFixed(b))switch(c){case "disabled":return e.fixed&&e.fixed.disabled?e.fixed.disabled:a.options.controlStyle.row.fixed.disabled;case "hovered":return e.fixed&&e.fixed.hovered?e.fixed.hovered:a.options.controlStyle.row.fixed.hovered;default:return e.fixed&&e.fixed.normal?e.fixed.normal:a.options.controlStyle.row.fixed.normal}else switch(c){case "disabled":return e.general&&e.general.disabled?e.general.disabled:a.options.controlStyle.row.general.disabled;
case "focused":return e.general&&e.general.focused?e.general.focused:a.options.controlStyle.row.general.focused;case "hovered":return e.general&&e.general.hovered?e.general.hovered:a.options.controlStyle.row.general.hovered;case "selected":return e.general&&e.general.selected?e.general.selected:a.options.controlStyle.row.general.selected;default:return e.general&&e.general.normal?e.general.normal:a.options.controlStyle.row.general.normal}}else return e?e:a.options.controlStyle.row};this.getDefaultCellContentClass=
function(){return"iui-grid-row-cell-content"};this.getDefaultCellLabelClass=function(){return"iui-grid-row-cell-label"};this.getDefaultCellBorderClass=function(){return"iui-grid-lines-both"};this.getCurrentCellStyle=function(b,c,f){var e=a.options.controlStyle.row.cell;if(c)switch(c[a.options.cellFields.style]){case "initial":break;case "parent":b&&(e=pb(a.getCurrentRowStyle(b)));break;default:c.style&&(e=c.style)}if(f)switch(f){case "content":return e.content?e.content:a.options.controlStyle.cell.content;
case "disabled":return e.disabled?e.disabled:a.options.controlStyle.cell.disabled;case "focused":return e.focused?e.focused:a.options.controlStyle.cell.focused;case "hovered":return e.hovered?e.hovered:a.options.controlStyle.cell.hovered;case "selected":return e.selected?e.selected:a.options.controlStyle.cell.selected;default:return e.normal?e.normal:a.options.controlStyle.cell.normal}else return e?e:a.options.controlStyle.row.cell}}]).directive("iuiGrid",["$compile","$timeout","$interval","IntegralUIInternalService",
"IntegralUIDragDrop","$window","IntegralUIListCtrlService",function(c,f,l,g,K,m,ba){return{restrict:"EA",controller:"IntegralUIGridController",transclude:!0,replace:!0,template:'<div class="iui-grid" data-element="grid"><div class="iui-grid-block"></div></div>',scope:{allowAnimation:"=",allowCellFocus:"=",allowColumnReorder:"=",allowFilter:"=",allowFocus:"=",allowDrag:"=",allowDrop:"=",animationSpeed:"=",autoExpand:"=",autoUpdate:"=",columns:"=",columnRelations:"=",controlStyle:"=",displayMode:"@",
editorSettings:"=",enabled:"=",expandingColumnIndex:"=",fields:"=",fillSpace:"=",gridLines:"=",grouping:"=",groups:"=",hoverSelection:"=",indent:"=",labelEdit:"=",mouseWheelSpeed:"@",name:"@",options:"=?",paging:"=?",rowHeight:"=",rowIcon:"=",rows:"=",selectedIndex:"=",selectedRow:"=",selectionMode:"@",showFooter:"=",showHeader:"=",showIcons:"=",showScroll:"=",sorting:"@",afterEdit:"&",afterLabelEdit:"&",afterSelect:"&",beforeEdit:"&",beforeLabelEdit:"&",beforeSelect:"&",cellClick:"&",cellDblclick:"&",
cellHover:"&",cellvalueChanged:"&",cellvalueChanging:"&",change:"&",clearColumns:"&",clearGroups:"&",clearRows:"&",columnAdded:"&",columnAdding:"&",columnClick:"&",columnDblclick:"&",columnHover:"&",columnPoschanging:"&",columnPoschanged:"&",columnRemoved:"&",columnRemoving:"&",columnRightclick:"&",columnSizechanged:"&",dragDrop:"&",dragEnter:"&",dragLeave:"&",dragOver:"&",enabledChanged:"&",events:"=?",gotFocus:"&",groupAdded:"&",groupAdding:"&",groupChange:"&",groupRemoved:"&",groupRemoving:"&",
keyDown:"&",keyPress:"&",keyUp:"&",loadComplete:"&",lostFocus:"&",rowAdded:"&",rowAdding:"&",rowClick:"&",rowDblclick:"&",rowHover:"&",rowRemoved:"&",rowRemoving:"&",rowRightclick:"&",scrollposChanged:"&",selectionChanged:"&",updateComplete:"&"},link:function(p,q,Ac,a,bd){var O=this,Ca=q.children().eq(0),Q=angular.element('<div class="iui-scrollbar-vertical"><div class="iui-scroll-button-thumb-vertical"></div></div>'),F=angular.element('<div class="iui-scrollbar-horizontal"><div class="iui-scroll-button-thumb-horizontal"></div></div>'),
hb=angular.element('<div class="iui-scrollbar-corner"></div>'),Xa=null,Da=null,nb=null,Cb=!1,H=angular.element('<input type="text" class="iui-label-editor" draggable="false" />');a.labelEditStatus=function(a){if(void 0!=a)Cb=a;else return Cb};var cd=function(){var d="iui-grid-block";a.options.showStatusIcons&&(d+=" "+d+"-shift-left");a.options.rtl&&(d+=" "+d+"-rtl");return d};p.$on("$destroy",function(a){O.s2t();ib&&(f.cancel(ib),ib=null);jb&&(f.cancel(jb),jb=null);x&&(x.unbind("mouseenter mouseleave mousemove mouseup"),
Td());Ma&&Ma.unbind("mousedown");q.unbind("click dblclick dragenter dragleave dragend drop keydown mousedown mouseleave mousemove mousewheel scroll touchstart touchmove touchend");angular.element(m).unbind("dragenter",Ud);angular.element(m).unbind("dragover",Vd);angular.element(m).unbind("dragend",Wd);angular.element(m).unbind("keyup",Xd);angular.element(m).unbind("mousemove",Yd);angular.element(m).unbind("mousedown",Zd);angular.element(m).unbind("mouseup",$d);H&&H.unbind("blur focus keydown mousedown");
ae();z&&z.$destroy();v&&v.$destroy()});a.dragIcon=document.createElement("img");a.dragIcon.width=1;q.append(a.getDropMarkWindow());a.dropMark();var Mb=function(){Xa&&(f.cancel(Xa),Xa=null)};a.addDropMark=function(){var d=q[0];for(var b=null;d;){if(d===document.getElementsByTagName("body")[0]){b=d;break}d=d.offsetParent}if(d=b)angular.element(d).append(a.getDropMarkWindow()),a.dropMark()};a.removeDropMark=function(){a.getDropMarkWindow().remove()};a.isDropInRange=function(d){d=a.getMousePos(d);var b=
q[0].getBoundingClientRect();d.x-=angular.element(m)[0].pageXOffset;d.y-=angular.element(m)[0].pageYOffset;var h=b.top+A;b=b.bottom-L;R&&F&&(b-=F[0].offsetHeight);return d.y<h||d.y>b?!1:!0};var P=angular.element('<div style="opacity:0.75;position:absolute;z-index:999"></div>'),dc=function(){P&&(P.remove(),P.css("top","-9999999px"),P.css("left","-9999999px"))};a.getCellElemFromRow=function(d){return d&&(d=a.getElemFromRow(d))?a.getChildElement(d,"cell"):null};a.openEditor=function(d,b){if(d)switch(d.type){case "cell":b||
(b=a.getColumnById(d[a.options.cellFields.cid]));if(!b){var h=a.getCellColumnIndex(d),k=a.columnsObj.getList();k&&0<=h&&h<k.length&&(b=k[h])}if(b){h=a.getCellType(d,a.getColumnRealIndex(b));k=a.getCellRowIndex(d);var c=a.getCellColumnIndex(d);if(k=a.getElemFromCell(k,c,b[a.options.columnFields.fixed]))switch(h){case "checkbox":break;case "combobox":break;case "incell":a.openInCellEditor(k,d,b);break;case "dropdown":a.openDropDownEditor(k,d,b);break;default:0!=d[a.options.cellFields.allowEdit]&&ec(null,
k,0)}}}};a.closeEditor=function(d,b,h){if(d)switch(d.type){case "cell":if(b||(b=a.getColumnById(d[a.options.cellFields.cid])),b)switch(a.getCellType(d,a.getColumnRealIndex(b))){case "incell":a.closeActiveEditor(d);break;case "dropdown":a.closeActiveEditor(d)}else a.closeActiveEditor()}else a.closeActiveEditor();h||"optimal"!=a.options.displayMode||a.updateView();I=null};var C=null,G=!1,I=null,ob=null,La=angular.element('<span class="iui-edit-mark"></span>');a.openInCellEditor=function(d,b,h){G&&a.closeActiveEditor(b,
!0);pb();if(b&&h&&(I=b,h='<div ng-include="'+h[a.options.columnFields.editorTemplate]+'"></div>',C=angular.element('<div class="iui-incell-editor"></div>'),C.append(c(h)(p.$parent)),0!=a.callBeforeEdit(b))){d.children().eq(0).append(C);G=!0;ob="incell";e();C.bind("mousedown",function(a){a.stopPropagation()});C.bind("mouseup",function(a){a.stopPropagation()});C.bind("click",function(a){a.stopPropagation()});C.bind("keydown",function(d){switch(d.keyCode){case 27:a.closeActiveEditor(I)}d.stopPropagation()});
C.bind("keypress",function(a){a.stopPropagation()});C.bind("keyup",function(a){a.stopPropagation()});var k=f(function(){var a=g.getPadding(d[0]),b=parseInt(getComputedStyle(d[0]).width,10)-(a.left+a.right);a=parseInt(getComputedStyle(d[0]).height,10)+2;C.css("width",b+"px");C.css("height",a+"px");C.css("top",d[0].offsetTop+"px");p.$apply();C.children&&1==C.children().length&&(b=C.children().eq(0),b.children&&1==b.children().length&&b.children().eq(0).css("height",a+"px"));f.cancel(k)},1)}};a.openDropDownEditor=
function(d,b,h){G&&a.closeActiveEditor(b,!0);pb();if(b&&h&&(I=b,h='<div ng-include="'+h[a.options.columnFields.editorTemplate]+'"></div>',C=angular.element('<div class="iui-dropdown-editor"></div>'),C.append(c(h)(p.$parent)),0!=a.callBeforeEdit(b)))var k=f(function(){angular.element(Ab).append(C);C.bind("mousedown",function(a){a.stopPropagation()});C.bind("mouseup",function(a){a.stopPropagation()});C.bind("click",function(a){a.stopPropagation()});G=!0;ob="dropdown";var a=d[0].getBoundingClientRect(),
b=angular.element(m)[0].pageXOffset,h=angular.element(m)[0].pageYOffset,c=f(function(){var k=g.getPadding(d[0]);k=parseInt(getComputedStyle(d[0]).width,10)+(k.left+k.right);var n=g.getPadding(C[0]);k-=n.left+n.right;n=parseInt(getComputedStyle(C[0]).width,10);k<n&&(k=n);n=a.right-(k+3)+b;C.css("top",a.bottom+h+"px");C.css("left",n+"px");C.css("width",k+"px");p.$apply();f.cancel(c)},1);f.cancel(k)},1)};a.closeActiveEditor=function(d,b){G=!1;pb();C&&C.remove();ob=I=null;b||a.callAfterEdit(d)};var pb=
function(){C&&C.unbind("click keydown keypress keyup mousedown mouseup")},b=function(a,b){a&&(La.addClass("iui-edit-mark iui-edit-mark-"+b),a.append(La),La.css("left",a[0].offsetLeft+a[0].offsetWidth-La[0].offsetWidth-2+"px"),La.css("top",a[0].offsetTop+(a[0].offsetHeight-La[0].offsetHeight)/2+"px"))},e=function(){La&&("dropdown"!=ob||"dropdown"==ob&&!G)&&(La.removeAttr("class"),La.remove())},r=null,t=angular.element('<div class="iui-dropdown-mark"><span></span></div>'),D=function(a,b){!a||Bb&&!b||
(a.append(t),t.css("top",a[0].offsetTop+"px"),t.css("left",a[0].offsetLeft+a[0].offsetWidth-t[0].offsetWidth+"px"),t.css("height",getComputedStyle(a[0]).height))},Qa=function(a){!t||Bb&&!a||t.remove()};a.getCellType=function(d,b){var h=null,k="label";d&&(h=a.getColumnById(d[a.options.cellFields.cid]));!h&&0<=b&&b<a.columnList.length&&(h=a.columnList[b]);h&&(k=h[a.options.columnFields.editorType]);return k};var Ab=g.getBodyElem(q[0]),cc=g.getUniqueId(4),xa=null,Bb=!1,fc=0,kf=function(d,b,h){if(Ab&&
d.items&&0<d.items.length){d=g.getUniqueId(4);var k=c('<iui-list name="'+d+'" style="position:absolute;top:-99px;height:100px" items="data[0]['+b+"].column."+a.options.columnFields.editorSettings+'.items"></iui-list>')(z);angular.element(Ab).append(k);ba.updateLayout(d);var B=f(function(){if(0<k.children().length){var a=k.children().eq(0);0<a.children().length&&(fc=angular.element(a.children().eq(0))[0].offsetHeight,h&&(h.avgItemHeight=fc))}k.remove();f.cancel(B)},1)}},Db=null,Eb=function(d,b,h,n){var k=
a.getCell(h,n);if(k!=r&&(r=k,xa&&xa.remove(),Db&&Db.$destroy(),Ab)){Db=p.$new();Db.data=a.columnList[n];I=k;var e='<iui-list name="'+cc+'" style="position:absolute;"';e+=' items="data.'+a.options.columnFields.editorSettings+'.items"';e+=' item-icon="data.'+a.options.columnFields.editorSettings+'.itemIcon"';e+=' show-icons="data.'+a.options.columnFields.editorSettings+'.showIcons"';e+=' checkbox-settings="data.'+a.options.columnFields.editorSettings+'.checkBoxSettings"';e+=' show-check-boxes="data.'+
a.options.columnFields.editorSettings+'.checkBoxSettings.showCheckBoxes"';xa=c(e+(' nav-selection="false" before-select="onCellValueChanging(e, '+h+", "+n+')" after-select="onCellValueChanged(e, '+h+", "+n+')"></iui-list>'))(Db);fc=0;Nb&&n<Nb.length&&(fc=Nb[n].avgItemHeight);var Ea=f(function(){angular.element(Ab).append(xa);var h=d[0].getBoundingClientRect(),c=angular.element(m)[0].pageXOffset,n=angular.element(m)[0].pageYOffset;n=h.bottom+n-1;h=h.left+c;c=d.children().eq(0);var B=g.getPadding(c[0]);
c=parseInt(getComputedStyle(c[0]).width,10)+(B.left+B.right);B=g.getPadding(xa[0]);c-=B.left+B.right;void 0!=b.dropDownWidth&&c<b.dropDownWidth&&(c=b.dropDownWidth);B=void 0!=b.dropDownHeight?b.dropDownHeight:100;void 0!=b.maxDropDownItems&&(B=fc*b.maxDropDownItems);xa.css("top",n+"px");xa.css("left",h+"px");xa.css("width",c+"px");xa.css("height",B+"px");xa.css("z-index","999");k&&k[a.options.cellFields.value]&&ba.selectedItem(cc,k[a.options.cellFields.value]);ba.updateLayout(cc);var e=f(function(){if(k&&
k[a.options.cellFields.value]){ba.ensureVisible(cc,k[a.options.cellFields.value]);var d=f(function(){ba.focus(cc,k[a.options.cellFields.value]);f.cancel(d)},1)}f.cancel(e)},10);t&&(Qa(!0),D(d,!0));Bb=!0;lf();f.cancel(Ea)},1)}};a.removeDropDownList=function(a){xa&&(r=null,xa.remove(),Bb=!1,a||Qa(),xa.unbind("keydown"));Db&&Db.$destroy();I=null};var lf=function(){xa.bind("keydown",function(d){switch(d.keyCode){case 27:a.removeDropDownList(),Qa()}})},ec=function(d,b,h){a.options.labelEdit&&(void 0===
h&&(h=500),Da=f(function(){if(Da)var a=f(function(){Cc(d,b,!0);f.cancel(a)},h);f.cancel(Da)},h/3))},gc=function(){Da&&(f.cancel(Da),Da=null)},Ob=null,Pb=null,Cc=function(d,b,h){if(a.dragDropStatus())g=H[0].value,a.labelEditStatus(!1),H.unbind("blur focus keydown mousedown"),H.remove(),Pb=Ob=null;else{var c=a.getRowFromChildElem(b);if(c){var k=a.getRowCurrentIndex(c),e=a.getIndexFromElem(b),Ea=a.getCellObject(k,e),g="";g=b.children().eq(0);if(Ea)if(h){if(0!=a.callBeforeLabelEdit(Ea)){Ob=c;Pb=Ea;a.labelEditStatus(!0);
H.unbind("blur focus keydown mousedown");d=parseInt(getComputedStyle(b[0]).width,10)-4;h=parseInt(getComputedStyle(b[0]).height,10)-3;H.css("top",b[0].offsetTop+"px");H.css("left",b[0].offsetLeft+"px");H.css("width",d+"px");H.css("height",h+"px");g.append(H);H[0].value=Ea[a.options.cellFields.text];H.bind("keydown",function(d){switch(d.keyCode){case 13:Ea[a.options.cellFields.text]=H[0].value?H[0].value:"null";Cc(d,b,!1);break;case 27:Cc(d,b,!1)}d.stopPropagation()});H.bind("focus",function(d){var b=
angular.element(this);a.callGotFocus(d,Ob,Pb,!0,b[0].value)});H.bind("blur",function(a){Cc(a)});H.bind("mousedown",function(a){a.stopPropagation()});var l=f(function(){H[0].focus();H[0].select();f.cancel(l)},10)}}else g=H[0].value,a.labelEditStatus(!1),H.unbind("blur focus keydown"),H.remove(),a.updateView(),a.updateFocus(k,e),a.callAfterLabelEdit(Ea),a.callLostFocus(d,c,Ea,!0,g),Pb=Ob=null}else g=H[0].value,a.labelEditStatus(!1),H.unbind("blur focus keydown mousedown"),H.remove(),a.callAfterLabelEdit(),
a.updateView(),a.callLostFocus(d,Ob,Pb,!0,g),Pb=Ob=null}},be=function(d){var b="",h=a.defaultStyle.row.expandBox.general;d[a.options.rowFields.style]&&d[a.options.rowFields.style].expandBox&&d[a.options.rowFields.style].expandBox.general!=h?h+=" "+d[a.options.rowFields.style].expandBox.general:a.options.controlStyle.row.expandBox.general!=h&&(h+=" "+a.options.controlStyle.row.expandBox.general);var c=a.getCurrentRowStyle(d);c=a.getExpandBoxStyle(c.expandBox);if(a.isThereChildRows||d&&d[a.options.rowFields.hasChildren])b=
h;h=d[a.options.rowFields.hasChildren]&&(a.isThereVisibleChildren(d)||!d[a.options.rowFields.rows]||d[a.options.rowFields.rows]&&0==d[a.options.rowFields.rows].length);d&&!a.isRowFixed(d)&&(h||a.isThereVisibleChildren(d))&&(b=d[a.options.rowFields.hasChildren]&&void 0===d[a.options.rowFields.expanded]?b+(" "+c.expanded):!1!==d[a.options.rowFields.expanded]?b+(" "+c.collapsed):b+(" "+c.expanded),!0===a.options.rtl&&(b+="-rtl"),a.options.enabled&&a.isRowEnabled(d)||(b+="-disabled"));return b};q.bind("mousemove",
function(d){if(a.options.enabled&&0===d.button&&ca&&y){var b=a.getMousePos(d),h=b.y+16;b=b.x+20;ma.empty();ma.append("<span>"+y[a.options.columnFields.headerText]+"</span>");ma.css("top",h+"px");ma.css("left",b+"px");ma.css("display","block");ce();d.stopPropagation()}});var fe=function(){for(var d=0,b="none";3>d;){if((b=a.getRowElems(b))&&0<b.length)for(var h=0;h<b.length;h++){var c=angular.element(b[h]);de(c);c=c.find("td");for(var B=0;B<c.length;B++){var e=angular.element(c[B]),f=a.getElement(e,
"expandbox");f&&f.unbind("click touchend");ee(e)}}d++;b=1==d?"left":"right"}},ae=function(){pb();for(var d=0,b="none";3>d;){var h=a.getRowElems(b);if(h&&0<h.length)for(var c=0;c<h.length;c++){var B=angular.element(h[c]);de(B);B=B.find("td");for(var e=0;e<B.length;e++){var f=angular.element(B[e]),g=a.getElement(f,"expandbox");g&&g.unbind("click touchend");ee(f)}}h=b;for(c=0;2>c;){rowFixed=0==c?"top":"bottom";if((B=a.getRowElems(h,rowFixed))&&0<B.length)for(e=0;e<B.length;e++)for((f=angular.element(B[e]))&&
f.unbind("mousedown mouseenter mouseleave"),f=f.find("td"),g=0;g<f.length;g++){var l=angular.element(f[g]);l&&l.unbind("click dblclick mouseenter mouseleave mousedown mouseup touchstart")}c++}if((h=a.getHeaderElem(b))&&0<h.length)for(c=0;c<h.length;c++)for(B=angular.element(h[c]),B=B.find("td"),e=0;e<B.length;e++)(f=angular.element(B[e]))&&(b=a.getChildElement(f,"column-header-cell"))&&(b=a.getContentElement(b,"filter-button"))&&b.unbind("mousedown");d++;b=1==d?"left":"right"}},rf=function(){fe();
for(var d=0,b="none";3>d;){var c=a.getRowElems(b);if(c&&0<c.length)for(var n,B=c.length-1,e=0;e<=B;e++){n=angular.element(c[e]);mf(n);for(var f=n.find("td"),g=0;g<f.length;g++){var l=angular.element(f[g]);nf(a.getElement(l,"expandbox"));of(l,a.getRowFromElem(n),g)}}for(c=0;2>c;){rowFixed=0==c?"top":"bottom";if((n=a.getRowElems(b,rowFixed))&&0<n.length)for(e=0;e<n.length;e++)for(B=angular.element(n[e]),pf(B),f=B.find("td"),g=0;g<f.length;g++)l=angular.element(f[g]),qf(l,a.getRowFromElem(B),g);c++}d++;
b=1==d?"left":"right"}},ca=!1,y=null,qb=-1,Dc=function(d,b){if(d){var c=a.getColumnWidthFromData(d);return a.isColumnWithFixedWidth(d)||10<b.x&&b.x<c-10}return!1},ge=function(a,b){var d=parseInt(getComputedStyle(a[0]).height,10),c=parseInt(getComputedStyle(ya[0]).height,10),k=g.getPadding(a[0]);ya.css("top",(d+k.top+k.bottom-c)/2+"px");1==b?(ya.css("left","0"),ya.css("right","auto")):(ya.css("left","auto"),ya.css("right","0"))},dd=function(d){d=d.find("td");for(var b=0;b<d.length;b++)currentElem=
angular.element(d[b]),currentElem.bind("click",function(d){if(a.options.enabled&&1===d.which){var b=g.getClientMousePos(d,this),c=a.getColumnFromElem(this);c&&Dc(c,b)&&a.callColumnClick(c,a.getMousePos(d))}d.stopPropagation()}),currentElem.bind("dblclick",function(d){d.preventDefault();if(a.options.enabled&&1===d.which){var b=g.getClientMousePos(d,this),c=a.getColumnFromElem(this);c&&Dc(c,b)&&a.callColumnDblClick(c,a.getMousePos(d))}d.stopPropagation()}),currentElem.bind("contextmenu",function(d){var b=
a.getColumnFromElem(this);b&&(Ra=b,b[a.options.columnFields.contextMenu]&&0<b[a.options.columnFields.contextMenu].length&&d.preventDefault(),he(d,b),d.stopPropagation())}),currentElem.bind("mouseenter",function(d){var b=angular.element(this);if(!(b&&b[0].attributes["data-element"]&&"column-expand-cell"==b[0].attributes["data-element"].value.toString()||!a.options.enabled||da||ta)){var c=a.getColumnFromElem(this);c&&(a.hoverColumn=c,a.refresh(c),a.callColumnHover(c));1===d.which&&ca&&y&&a.hoverColumn&&
0!=a.hoverColumn[a.options.columnFields.allowDrop]&&ya&&(ya.remove(),a.hoverColumn!=y&&(b.append(ya),ge(b)))}}),currentElem.bind("mouseleave",function(d){d=angular.element(this);d&&d[0].attributes["data-element"]&&"column-expand-cell"==d[0].attributes["data-element"].value.toString()||!a.options.enabled||da||ta||(a.hoverColumn=null,(d=a.getColumnFromElem(this))&&a.refresh(d),ya&&ya.remove(),da||q.css("cursor","default"))}),currentElem.bind("mousemove",function(d){var b=angular.element(this);if((!b||
!b[0].attributes["data-element"]||"column-expand-cell"!=b[0].attributes["data-element"].value.toString())&&a.options.enabled)if(b=angular.element(this),1===d.which&&ca&&y&&a.hoverColumn&&a.hoverColumn!=y&&0!=a.hoverColumn[a.options.columnFields.allowDrop]&&y[a.options.columnFields.fixed]==a.hoverColumn[a.options.columnFields.fixed]){var c=parseInt(getComputedStyle(b[0]).width,10),h=a.getColumnCompleteIndex(y),k=a.getColumnCompleteIndex(a.hoverColumn);ya.empty();qb=-1;y[a.options.columnFields.pid]==
a.hoverColumn[a.options.columnFields.pid]&&h.level==k.level&&(d.offsetX>c/2?(qb=2,ya.append('<span class="iui-grid-column-reorder-mark-right"></span>')):(qb=1,ya.append('<span class="iui-grid-column-reorder-mark-left"></span>')),ge(b,qb))}else if(b=a.getColumnFromChildElem(this))d=g.getClientMousePos(d,this),c=a.getColumnWidthFromData(b),h=10,a.isFilteringAllowed(b)&&(h=0),10>d.x&&!a.isColumnWithFixedWidth(b)&&ie(b,"left")?(q.css("cursor","ew-resize"),Ya="left"):d.x>c-h&&!a.isColumnWithFixedWidth(b)&&
ie(b,"right")?(q.css("cursor","ew-resize"),Ya="right"):da||(q.css("cursor","default"),Ya="none")}),currentElem.bind("mouseup",function(d){var b=angular.element(this);if((!b||!b[0].attributes["data-element"]||"column-expand-cell"!=b[0].attributes["data-element"].value.toString())&&a.options.enabled){if(1===d.which)if(ca&&y&&a.hoverColumn&&a.hoverColumn!=y&&0!=a.hoverColumn[a.options.columnFields.allowDrop]&&y[a.options.columnFields.fixed]==a.hoverColumn[a.options.columnFields.fixed]){if(0!=a.callColumnPosChanging(y,
a.hoverColumn)&&(d=a.getColumnCompleteIndex(y),b=a.getColumnCompleteIndex(a.hoverColumn),y[a.options.columnFields.pid]==a.hoverColumn[a.options.columnFields.pid]&&d.level==b.level)){d=a.columnsObj.getParent(y);d=a.columnsObj.getList(d);b=d.indexOf(y);var c=d.indexOf(a.hoverColumn);if(0<=b&&0<=c){var h=c;b<c?1==qb&&h--:b>c&&2==qb&&h++;a.moveObject(b,h,d);a.updateLayout();a.callColumnPosChanged(y,a.hoverColumn)}}}else b=a.getColumnFromChildElem(this),a.updateColumnSelection(b,d);y=null;qb=-1;da=ca=
!1;q.css("cursor","default")}}),currentElem.bind("mousedown",function(d){var b=angular.element(this);if(b&&b[0].attributes["data-element"]&&"column-expand-cell"==b[0].attributes["data-element"].value.toString()){if(1==d.which&&(b=a.getColumnFromChildElem(this))&&a.isColumnRelated(b)&&(b=a.getColumnRelatedObject(b))&&b.children){b.expanded=!(void 0!=b.expanded?b.expanded:0!=b.expanded);for(var c=0;c<b.children.length;c++)b.children[c].column[a.options.columnFields.visible]=b.expanded;a.updateLayout()}}else if(a.options.enabled&&
(a.removeDropDownList(),a.closeFilterWindow(),a.closeEditor(),b=a.getColumnFromChildElem(this))){g.getClientMousePos(d,this);var h=b;if(0===d.button&&!da){c=h;var k=h[a.options.columnFields.fixed];switch(Ya){case "left":"right"==k?c=h:(h=Ec(h,k))?(c=h,h[a.options.columnFields.fixed]!=k?(c=null,da=!1):da=!0):da=!1;c&&(da=!0);break;case "right":"right"==k?(h=Fc(h,k))?(c=h,h[a.options.columnFields.fixed]!=k?(c=null,da=!1):da=!0):da=!1:(c=h,da=!0)}!a.isColumnWithFixedWidth(c)&&da?a.setColumnResizingParams(c,
Ya,a.getMousePos(d).x):da=!1}if(!da)switch(c=g.getClientMousePos(d,this),Dc(b,c)&&a.columnSelection(b,d),d.which){case 1:a.options.allowColumnReorder&&0!=b[a.options.columnFields.allowDrag]&&0==ca&&0!=b[a.options.columnFields.allowGrouping]&&(y=b,a.getMousePos(d),ca=!0,(b=g.getBodyElem(q[0]))&&angular.element(b).append(ma));break;case 3:Dc(b,c)&&a.callColumnRightClick(b,a.getMousePos(d))}}d.stopPropagation()}),function(b){b&&(b=a.getChildElement(b,"column-header-cell"))&&(b=a.getContentElement(b,
"filter-button"))&&b.bind("mousedown",function(a){1==a.which&&sf(this);a.stopPropagation()})}(currentElem)},Ma=null,sf=function(b){a.closeFilterWindow();var d=a.getColumnFromChildElem(b);if(d){var h=angular.element(b),n=h.parent().parent();if(Ab){b='<div ng-include="'+d[a.options.columnFields.filterTemplate]+'"></div>';Ma=angular.element('<div class="iui-filter-window"></div>');Ma.append(c(b)(p.$parent));var B=f(function(){angular.element(Ab).append(Ma);Ma.bind("mousedown",function(a){a.stopPropagation()});
h[0].getBoundingClientRect();var b=n[0].getBoundingClientRect(),c=angular.element(m)[0].pageXOffset,k=angular.element(m)[0].pageYOffset,e=f(function(){var h=b.bottom+k,n=b.right-(parseInt(getComputedStyle(Ma[0]).width,10)+3)+c;d[a.options.columnFields.filterParams]&&"left"==d[a.options.columnFields.filterParams].templateAlignment&&(n=b.left+c);Ma.css("top",h+"px");Ma.css("left",n+"px");f.cancel(e)},1);f.cancel(B)},1)}}};a.closeFilterWindow=function(){Ma&&(Ma.unbind("mousedown"),Ma.remove())};var de=
function(a){a&&a.unbind("click contextmenu blur dragover dragend focus keydown keyup keypress mousedown mouseenter mouseleave")},mf=function(b){b&&(b.bind("click",function(a){a.preventDefault();Fb()}),b.bind("contextmenu",function(b){var d=a.getRowFromElem(this);d&&a.isRowEnabled(d)&&(Ra=d,d[a.options.rowFields.contextMenu]&&0<d[a.options.rowFields.contextMenu].length&&b.preventDefault(),he(b,d),b.stopPropagation())}),b.bind("dragover",function(b){var d=a.getRowFromElem(this);if(d&&a.isRowEnabled(d)){if(a.isScrollBarVisible("vertical")){d=
a.getMousePos(b);var c=q[0].getBoundingClientRect();d.x-=angular.element(m)[0].pageXOffset;d.y-=angular.element(m)[0].pageYOffset;var k=c.top+A+25;c=c.bottom-L-25;R&&F&&(c-=F[0].offsetHeight);d.y<k?Gc(!1):d.y>c?Gc(!0):Qb()}else Qb();b.stopPropagation()}}),b.bind("dragend",function(b){var d=a.getRowFromElem(this);d&&a.isRowEnabled(d)&&(b.preventDefault(),a.dragDropStatus(!1),a.dropMark(),K.getData().source||K.clearData())}),b.bind("mouseenter",function(b){if(!ta){var d=a.getRowFromElem(this);d&&a.isRowEnabled(d)&&
!ca&&(a.hoverRow=d,a.refresh(d),a.callRowHover(b,d),a.options.hoverSelection&&(nb=f(function(){nb&&a.rowSelection(d,b.shiftKey,b.ctrlKey,b.metaKey,null,void 0)},500)))}}),b.bind("mouseleave",function(b){ta||(a.hoverRow=null,(b=a.getRowFromElem(this))&&a.isRowEnabled(b)&&a.refresh(b),nb&&(f.cancel(nb),nb=null))}),b.bind("keydown",function(b){var d=a.getRowFromElem(this);if(d&&a.isRowEnabled(d)){var c=!0;a.callKeyDown(b,d);var k=a.getRowCurrentIndex(d);switch(b.keyCode){case 9:je(b,d,k);break;case 16:a.updateSelectionStatus("shift");
break;case 17:a.updateSelectionStatus("ctrl");break;case 27:c=!1;break;case 33:ke(b,k);break;case 34:le(b,k);break;case 35:me(b,k);break;case 36:ne(b,k);break;case 37:oe(b,d,k);break;case 32:pe(b,d);break;case 38:ed(b,k);break;case 39:qe(b,d,k);break;case 40:fd(b,k);break;default:(b.ctrlKey||b.metaKey)&&a.updateSelectionStatus("ctrl"),b.shiftKey&&a.updateSelectionStatus("shift")}c&&b.stopPropagation()}}),b.bind("keyup",function(b){var d=a.getRowFromElem(this);if(d&&a.isRowEnabled(d)){switch(b.keyCode){case 16:a.multiSelection(!1);
break;case 17:a.multiSelection(!1);break;default:b.ctrlKey||b.metaKey||a.multiSelection(!1),b.shiftKey||a.multiSelection(!1)}a.callKeyUp(b,d)}}),b.bind("keypress",function(b){var d=a.getRowFromElem(this);d&&a.isRowEnabled(d)&&a.callKeyPress(b,d)}),b.bind("mousedown",function(b){a.removeDropDownList();a.closeFilterWindow();a.closeEditor()}),b.bind("focus",function(b){var d=a.getRowFromElem(this);d&&a.isRowEnabled(d)?a.callGotFocus(b,d):a.updateFocus()}),b.bind("blur",function(b){var d=a.getRowFromElem(this);
d&&a.isRowEnabled(d)&&a.callLostFocus(b,d)}))},nf=function(b){b&&(b.bind("click",function(b){var d=a.getRowFromChildElem(this);d&&a.isRowEnabled(d)&&(a.toggle(d),a.updateFocus(a.getRowCurrentIndex(d),a.options.expandColIndex),b.stopPropagation())}),b.bind("touchend",function(b){b.preventDefault();var d=a.getRowFromChildElem(this);d&&a.isRowEnabled(d)&&(a.toggle(d),a.updateFocus(a.getRowCurrentIndex(d),a.options.expandColIndex),b.stopPropagation())}))},Hc={x:0,y:0},Rb={x:0,y:0},Sb=!1,gd=!1,kb=null,
re=function(){return{x:angular.element(m)[0].pageXOffset,y:angular.element(m)[0].pageYOffset}},Tb=function(a){var b=re();return{x:a.x-b.x,y:a.y-b.y}},of=function(d,c,h){d&&(d.bind("dragstart",function(b){if(a.labelEditStatus())b.preventDefault();else{document.activeElement&&document.activeElement.blur();K.clearData();var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d))if(gc(),a.isDragAllowed(d)){a.dragDropStatus(!0);a.addDropMark();b.dataTransfer?(b.dataTransfer.effectAllowed="move",b.dataTransfer.setData("text",
d[a.options.rowFields.id]?d[a.options.rowFields.id].toString():"")):b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.effectAllowed="move",b.originalEvent.dataTransfer.setData("text",d[a.options.rowFields.id]?d[a.options.rowFields.id].toString():""));b={source:d,sourceCtrl:a,sourceCollection:a.rowsObj};switch(a.options.selectionMode){case "multi-simple":b.source=a.options.selectedRows;break;case "multi-extended":b.source=a.options.selectedRows}K.setData(b)}else b.dataTransfer?
b.dataTransfer.effectAllowed="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.effectAllowed="none")}}),d.bind("dragover",function(b){var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)){var c=angular.element(this);b.preventDefault();var k=!0;b.dataTransfer?k="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(k="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(k&&(d=a.getRowFromChildElem(c))){k=c[0].getBoundingClientRect();
var h=angular.element(m)[0].pageXOffset,n=angular.element(m)[0].pageYOffset,e=a.getMousePos(b);e.x-=k.left+h;e.y-=k.top+n;c=K.getDropPos(e,{x:0,y:0,width:c[0].offsetWidth,height:c[0].offsetHeight},!0);h=K.getData();k=a.isDropAllowed(h.source,d,c);n={event:b,sourceCtrl:h.sourceCtrl?h.sourceCtrl.getGridName():"",dragRow:h.source,targetCtrl:a.getGridName(),targetRow:d,isDropAllowed:k,dropPos:c,mousePos:a.getMousePos(b)};n=a.callDragOver(n);if(k&&!1!==n){n=a.getMousePos(b);b=n.y+16;n=n.x+20;e=a.getDropMarkWindow();
e.empty();var f="";switch(c){case 1:f="iui-drop-marker-move-up";break;case 2:f="iui-drop-marker-move-down"}e.append("<span class='"+f+"'></span><span class='iui-drop-marker-title'>"+d[a.options.rowFields.text]+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),{top:b,left:n});a.dropMark(k);K.setData({source:h.source,sourceList:h.sourceList,target:d,dropPos:c})}else b.dataTransfer?b.dataTransfer.dropEffect="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect=
"none"),a.dropMark()}}}),d.bind("drop",function(b){var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)){var c=angular.element(this);b.preventDefault();Mb();a.dropMark();d=!0;b.dataTransfer?d="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(d="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(d){var k=a.getRowFromChildElem(c);if(k){c=K.getData();var h=c.source;h||(h=a.getDnDSource(b));if(d=a.isDropAllowed(h,k,c.dropPos))a.toggle(k,!0),h&&
(d={event:b,sourceCtrl:c.sourceCtrl?c.sourceCtrl.getGridName():"",dragRow:h,targetCtrl:a.getGridName(),targetRow:k,isDropAllowed:d,dropPos:c.dropPos,mousePos:a.getMousePos(b)},!1!==a.callDragDrop(d)&&(a.drop(c),p.$$phase||p.$apply()))}}K.clearData();b.stopPropagation()}}),d.bind("dragenter",function(b){var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)){b.preventDefault();if(a.options.autoExpand)var c=f(function(){Xa||(Xa=f(function(){Xa&&a.toggle(d,!0)},750));f.cancel(c)},1);var k=K.getData();
k.source||(k.source=a.getDnDSource(b));k={event:b,sourceCtrl:k.sourceCtrl?k.sourceCtrl.getGridName():"",dragRow:k.source,targetCtrl:a.getGridName(),targetRow:k.target,mousePos:a.getMousePos(b)};a.callDragEnter(k);b.stopPropagation()}}),d.bind("dragleave",function(b){a.hoverRow=null;var d=a.getRowFromChildElem(this);d&&a.isRowEnabled(d)&&(b.preventDefault(),Mb(),d=K.getData(),d.source||(d.source=a.getDnDSource(b)),d={event:b,sourceCtrl:d.sourceCtrl?d.sourceCtrl.getGridName():"",dragRow:d.source,targetCtrl:a.getGridName(),
targetRow:d.target,mousePos:a.getMousePos(b)},a.callDragLeave(d),b.stopPropagation())}),d.bind("touchstart",function(b){var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)&&(b.preventDefault(),(d=a.getTouchData(b))&&0<d.length)){gd=!0;var c=f(function(){gd=!1;f.cancel(c)},750);Hc=Tb({x:d[0].pageX,y:d[0].pageY});a.closeFilterWindow();d=Hc;if((d=a.getRowAt(d.x,d.y))&&a.isRowEnabled(d)){var k=angular.element(this);a.mouseButtonStatus(!0);kb=d;var h=a.getRowCurrentIndex(d),n=parseInt(a.getIndexFromElem(this),
10),e=a.getCell(h,n),g=a.getCellType(e,n),l=null,m=a.options.editorSettings;k[0].focus();a.updateFocus(h,n);e&&(l=a.getColumnById(e[a.options.cellFields.cid]));!l&&0<=n&&n<a.columnList.length&&(l=a.columnList[n]);var p="click"==a.options.editorSettings.activate;l&&l[a.options.columnFields.editorSettings]&&(m=l[a.options.columnFields.editorSettings],p=void 0!=m.activate?"click"==m.activate:p);e&&e!=I?a.closeEditor(I):a.closeEditor();switch(g){case "checkbox":break;case "combobox":a.rowSelection(d,
b.shiftKey,b.ctrlKey,b.metaKey,null,void 0);e&&0!=e[a.options.cellFields.allowEdit]&&l&&p?Eb(angular.element(this),m,h,n):a.removeDropDownList();break;case "incell":a.rowSelection(d,b.shiftKey,b.ctrlKey,b.metaKey,null,void 0);!G&&e&&0!=e[a.options.cellFields.allowEdit]&&p&&a.openInCellEditor(k,e,l);break;case "dropdown":a.rowSelection(d,b.shiftKey,b.ctrlKey,b.metaKey,null,void 0);!G&&e&&0!=e[a.options.cellFields.allowEdit]&&p&&a.openDropDownEditor(k,e,l);break;default:a.rowSelection(d,b.shiftKey,
b.ctrlKey,b.metaKey,null,void 0),a.removeDropDownList(),e&&0!=e[a.options.cellFields.allowEdit]&&p&&ec(b,angular.element(this))}}}}),d.bind("touchmove",function(b){var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)&&(d=a.getTouchData(b))&&0<d.length){Rb=Tb({x:d[0].pageX,y:d[0].pageY});d=Math.abs(Rb.x-Hc.x);var c=Math.abs(Rb.y-Hc.y),k=q[0].getBoundingClientRect();if(K.hitTest(Rb.x,Rb.y,k)){if(b.preventDefault(),P&&P.css("display","block"),!gd)if(!Sb&&(2<d||2<c)&&kb&&a.isRowEnabled(kb))if(angular.element(this),
a.labelEditStatus())b.preventDefault();else{Sb=!0;K.clearData();if((d=a.getTouchData(b))&&0<d.length&&(Tb({x:d[0].pageX,y:d[0].pageY}),kb&&a.isRowEnabled(kb)&&(gc(),a.isDragAllowed(kb)))){a.dragDropStatus(!0);a.addDropMark();d={source:kb,sourceCtrl:a,sourceCollection:a.rowsObj};switch(a.options.selectionMode){case "multi-simple":d.source=a.options.selectedRows;break;case "multi-extended":d.source=a.options.selectedRows}K.setData(d);if(d=a.getCellElemFromRow(kb))if(d=a.getContentElement(d))P.empty(),
P.append(d.clone()),P.css("display","none"),q.append(P)}b.stopPropagation()}else if(Sb&&(angular.element(this),b.preventDefault(),(c=a.getTouchData(b))&&0<c.length)){d=re();var h=Tb({x:c[0].pageX,y:c[0].pageY});if(c=a.getRowAt(h.x,h.y)){var n=a.getCellElemFromRow(c);if(n){k=n[0].getBoundingClientRect();n=K.getDropPos({x:h.x-k.left,y:h.y-k.top},{x:0,y:0,width:n[0].offsetWidth,height:n[0].offsetHeight},!0);k=K.getData();var e=a.isDropAllowed(k.source,c,n);b={event:b,sourceCtrl:k.sourceCtrl?k.sourceCtrl.getGridName():
"",dragRow:k.source,targetCtrl:a.getGridName(),targetRow:c,isDropAllowed:e,dropPos:n,mousePos:h};var f=q[0].getBoundingClientRect();var g=h.x-f.left;f=h.y-f.top;P.css("top",f-16+"px");P.css("left",g+"px");P.css("display","block");b=a.callDragOver(b);if(e&&0!=b){b=h.y+d.y+16;d=h.x+d.x+20;h=a.getDropMarkWindow();h.empty();g="iui-drop-marker-move-in";switch(n){case 1:g="iui-drop-marker-move-up";break;case 2:g="iui-drop-marker-move-down"}h.append("<span class='"+g+"'></span><span class='iui-drop-marker-title'>"+
c[a.options.rowFields.text]+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),{top:b,left:d});a.dropMark(e);K.setData({source:k.source,sourceList:k.sourceList,target:c,dropPos:n})}else a.dropMark(),P&&P.css("display","none")}}else k=q[0].getBoundingClientRect(),c=k.top+A,k=k.bottom-L,R&&F&&(k-=F[0].offsetHeight),!a.options.allowDrop||h.y<c||h.y>k?(a.dropMark(),P&&P.css("display","none")):(f=q[0].getBoundingClientRect(),g=h.x-f.left,f=h.y-f.top,P.css("top",f-16+"px"),P.css("left",g+"px"),P.css("display",
"block"),c=K.getData(),k={source:c.source,sourceCtrl:c.sourceCtrl,target:null,dropPos:-1},K.setData(k),b={event:b,sourceCtrl:c.sourceCtrl?c.sourceCtrl.getGridName():"",dragRow:c.source,targetCtrl:a.getGridName(),targetRow:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:h},b=a.callDragOver(b),0==b?a.dropMark():(b=h.y+d.y+16,d=h.x+d.x+20,h=a.getDropMarkWindow(),h.empty(),h.append("<span class='iui-drop-marker-move-end'></span><span class='iui-drop-marker-title'>"+(p.name?p.name:"Grid")+"</span>"),
a.updateDropMarkElem(a.getDropMarkWindow(),{top:b,left:d}),a.dropMark(!0)))}}else b.preventDefault(),a.dropMark(),a.cancelScrollTimer(),P&&P.css("display","none")}}),d.bind("touchend",function(b){var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)){if((d=a.getTouchData(b))&&0<d.length){d=Tb({x:d[0].pageX,y:d[0].pageY});var c=q[0].getBoundingClientRect();if(K.hitTest(d.x,d.y,c))if(Sb){angular.element(this);b.preventDefault();Mb();a.dropMark();dc();if((d=a.getTouchData(b))&&0<d.length){d=Tb({x:d[0].pageX,
y:d[0].pageY});var k=a.getRowAt(d.x,d.y);if(k){c=K.getData();var h=c.source,n=a.isDropAllowed(h,k,c.dropPos);n&&(a.toggle(k,!0),h&&(d={event:b,sourceCtrl:c.sourceCtrl?c.sourceCtrl.getGridName():"",dragRow:h,targetCtrl:a.getGridName(),targetRow:k,isDropAllowed:n,dropPos:c.dropPos,mousePos:d},d=a.callDragDrop(d),!1!==d&&(a.drop(c),p.$$phase||p.$apply())))}else a.dropMark(),k=q[0].getBoundingClientRect(),c=k.top+A,k=k.bottom-L,R&&F&&(k-=F[0].offsetHeight),d.y>=c&&d.y<=k&&(c=K.getData(),c.source&&(d=
{event:b,sourceCtrl:c.sourceCtrl?c.sourceCtrl.getGridName():"",dragRow:c.source,targetCtrl:a.getGridName(),targetRow:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:d},d=a.callDragDrop(d),!1!==d&&(a.drop(c),p.$$phase||p.$apply())))}K.clearData();a.dragDropStatus(!1);b.stopPropagation()}else a.mouseButtonStatus(!1),(d=a.getRowFromChildElem(this))&&a.isRowEnabled(d)&&a.updateSelection(b,d,b.shiftKey),gc()}d=Sb;a.removeDropMark();dc();Rb={x:0,y:0};Sb=!1;kb=null;d&&b.stopPropagation()}}),d.bind("dblclick",
function(b){var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)){var c=angular.element(this);b.preventDefault();if(1===b.which){var k=a.getRowCurrentIndex(d),h=parseInt(a.getIndexFromElem(this),10),n=a.getCell(k,h),e=a.getCellType(n,h),f=null,g=a.options.editorSettings;n&&(f=a.getColumnById(n[a.options.cellFields.cid]));!f&&0<=h&&h<a.columnList.length&&(f=a.columnList[h]);var l="dblclick"==a.options.editorSettings.activate;f&&f[a.options.columnFields.editorSettings]&&(g=f[a.options.columnFields.editorSettings],
l=void 0!=g.activate?"dblclick"==g.activate:l);switch(e){case "checkbox":break;case "combobox":n&&0!=n[a.options.cellFields.allowEdit]&&f&&l?Eb(angular.element(this),g,k,h):a.removeDropDownList();break;case "incell":!G&&n&&0!=n[a.options.cellFields.allowEdit]&&l&&a.openInCellEditor(c,n,f);break;case "dropdown":!G&&n&&0!=n[a.options.cellFields.allowEdit]&&l&&a.openDropDownEditor(c,n,f);break;default:a.removeDropDownList(),n&&0!=n[a.options.cellFields.allowEdit]&&l&&ec(b,angular.element(this),0)}0!=
a.callCellDblClick(d,n,a.getMousePos(b))&&"checkbox"!=e&&0!=a.callRowDblClick(d,a.getMousePos(b))&&n&&!l&&(a.toggle(d),a.updateFocus(k,h))}b.stopPropagation()}}),d.bind("mouseenter",function(d){if(!ta){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)&&!ca){var k=a.getRowCurrentIndex(c),h=parseInt(a.getIndexFromElem(this),10);if(k=a.getCell(k,h))if(a.hoverCell=k,a.refresh(c),a.callCellHover(d,k),d=angular.element(this),k&&0!=k[a.options.cellFields.allowEdit])switch(h=a.getCellType(k,h),h){case "combobox":Bb||
D(d);break;case "incell":G&&k==I||b(d,h);break;case "dropdown":G&&k!=I||b(d,h);break;default:Qa(),e()}else Qa()}}}),d.bind("mouseleave",function(b){if(!ta&&(a.hoverCell=null,(b=a.getRowFromChildElem(this))&&a.isRowEnabled(b))){b=a.getRowCurrentIndex(b);var d=parseInt(a.getIndexFromElem(this),10);a.getCell(b,d)&&(Qa(),e())}}),d.bind("keydown",function(b){var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)){var c=!0,k=angular.element(this);a.callKeyDown(b,d);var h=a.getRowCurrentIndex(d),n=parseInt(a.getIndexFromElem(this),
10),e=a.getCell(h,n),f=a.getCellType(e,n),g=a.getColumnById(e[a.options.cellFields.cid]);!g&&0<=n&&n<a.columnList.length&&(g=a.columnList[n]);switch(b.keyCode){case 9:je(b,d,h,n);break;case 13:switch(f){case "checkbox":se(e,n);break;case "combobox":e&&0!=e[a.options.cellFields.allowEdit]?g&&Eb(angular.element(this),g[a.options.columnFields.editorSettings],h,n):a.removeDropDownList();break;case "incell":!G&&e&&0!=e[a.options.cellFields.allowEdit]&&a.openInCellEditor(k,e,g);break;case "dropdown":!G&&
e&&0!=e[a.options.cellFields.allowEdit]&&a.openDropDownEditor(k,e,g);break;default:e&&0!=e[a.options.cellFields.allowEdit]&&ec(b,angular.element(this),0)}break;case 16:a.updateSelectionStatus("shift");break;case 17:a.updateSelectionStatus("ctrl");break;case 27:c=!1;break;case 33:ke(b,h,n);break;case 34:le(b,h,n);break;case 35:me(b,h,n);break;case 36:ne(b,h,n);break;case 37:oe(b,d,h,n);break;case 32:pe(b,d,e,n);break;case 38:ed(b,h,n);break;case 39:qe(b,d,h,n);break;case 40:fd(b,h,n);break;default:(b.ctrlKey||
b.metaKey)&&a.updateSelectionStatus("ctrl"),b.shiftKey&&a.updateSelectionStatus("shift")}c&&b.stopPropagation()}}),d.bind("keyup",function(b){var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)){switch(b.keyCode){case 16:a.multiSelection(!1);break;case 17:a.multiSelection(!1);break;default:b.ctrlKey||b.metaKey||a.multiSelection(!1),b.shiftKey||a.multiSelection(!1)}a.callKeyUp(b,d);b.stopPropagation()}}),d.bind("keypress",function(b){var d=a.getRowFromChildElem(this);d&&a.isRowEnabled(d)&&(a.callKeyPress(b,
d),b.stopPropagation())}),d.bind("click",function(b){var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)){if(1===b.which){var c=a.getRowCurrentIndex(d),k=parseInt(a.getIndexFromElem(this),10);c=a.getCell(c,k);a.callCellClick(b,d,c,a.getMousePos(b));a.callRowClick(b,d,a.getMousePos(b))}b.stopPropagation()}}),d.bind("mousedown",function(b){a.closeFilterWindow();var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)){var c=angular.element(this);a.mouseButtonStatus(!0);switch(b.which){case 1:var k=
a.getRowCurrentIndex(d),h=parseInt(a.getIndexFromElem(this),10),n=a.getCell(k,h),e=a.getCellType(n,h),f=null,g=a.options.editorSettings;n&&(f=a.getColumnById(n[a.options.cellFields.cid]));!f&&0<=h&&h<a.columnList.length&&(f=a.columnList[h]);var l="click"==a.options.editorSettings.activate;f&&f[a.options.columnFields.editorSettings]&&(g=f[a.options.columnFields.editorSettings],l=void 0!=g.activate?"click"==g.activate:l);n&&n!=I?a.closeEditor(I):a.closeEditor();switch(e){case "checkbox":break;case "combobox":a.rowSelection(d,
b.shiftKey,b.ctrlKey,b.metaKey,null,void 0);n&&0!=n[a.options.cellFields.allowEdit]&&f&&l?Eb(angular.element(this),g,k,h):a.removeDropDownList();break;case "dropdown":a.rowSelection(d,b.shiftKey,b.ctrlKey,b.metaKey,null,void 0);!G&&n&&0!=n[a.options.cellFields.allowEdit]&&l&&a.openDropDownEditor(c,n,f);break;case "incell":a.rowSelection(d,b.shiftKey,b.ctrlKey,b.metaKey,null,void 0);!G&&n&&0!=n[a.options.cellFields.allowEdit]&&l&&a.openInCellEditor(c,n,f);break;default:if("image"==e?0!=g.allowSelection:
1)a.rowSelection(d,b.shiftKey,b.ctrlKey,b.metaKey,null,void 0),a.removeDropDownList(),n&&0!=n[a.options.cellFields.allowEdit]&&l&&ec(b,angular.element(this))}break;case 3:a.rowSelection(d,b.shiftKey,b.ctrlKey,b.metaKey,null,!0),a.callRowRightClick(d,a.getMousePos(b))}b.stopPropagation()}}),d.bind("mouseup",function(b){a.mouseButtonStatus(!1);if(1==b.which){var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)){var c=a.getRowCurrentIndex(d),k=parseInt(a.getIndexFromElem(this),10);c=a.getCell(c,
k);var h=a.getCellType(c,k),n=null,e=a.options.editorSettings;c&&(n=a.getColumnById(c[a.options.cellFields.cid]));!n&&0<=k&&k<a.columnList.length&&(n=a.columnList[k]);n&&n[a.options.columnFields.editorSettings]&&(e=n[a.options.columnFields.editorSettings]);("image"==h?0!=e.allowSelection:1)&&a.updateSelection(b,d,b.shiftKey)}gc()}}),d.bind("focus",function(d){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){var k=a.getRowCurrentIndex(c),h=parseInt(a.getIndexFromElem(this),10);k=a.getCell(k,
h);a.callGotFocus(d,c,k);if(k&&0!=k[a.options.cellFields.allowEdit])switch(d=angular.element(this),h=a.getCellType(k,h),h){case "combobox":Bb||D(d);break;case "incell":G||b(d,h);break;case "dropdown":G||b(d,h);break;default:Qa()}else Qa()}}),d.bind("blur",function(b){var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)){var c=a.getRowCurrentIndex(d),k=parseInt(a.getIndexFromElem(this),10);c=a.getCell(c,k);a.callLostFocus(b,d,c)}e()}))},ee=function(a){a&&a.unbind("blur click dragstart dragover drop dragenter dragleave dblclick focus keydown keypress keyup mouseenter mouseleave mousemove mousedown mouseup touchstart touchmove touchend")},
pf=function(b){b&&(b.bind("mouseenter",function(b){if(!ta){var d=a.getRowFromElem(this);d&&a.isRowEnabled(d)&&!ca&&(a.hoverRow=d,a.refreshHover(d),a.callRowHover(b,d))}}),b.bind("mouseleave",function(b){ta||(a.hoverRow=null,(b=a.getRowFromElem(this))&&a.isRowEnabled(b)&&a.refreshHover(b))}),b.bind("mousedown",function(b){a.removeDropDownList();a.closeFilterWindow();a.closeEditor()}))},qf=function(d,c,h){d&&(d.bind("touchstart",function(b){var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)){b.preventDefault();
a.closeFilterWindow();b=angular.element(this);var c=a.getRowCurrentIndex(d),k=parseInt(a.getIndexFromElem(this),10);d=a.getCell(c,k,d[a.options.rowFields.fixed]);var h=a.getCellType(d,k),n=null,e=a.options.editorSettings;b[0].focus();d&&(n=a.getColumnById(d[a.options.cellFields.cid]));!n&&0<=k&&k<a.columnList.length&&(n=a.columnList[k]);var f="click"==a.options.editorSettings.activate;n&&n[a.options.columnFields.editorSettings]&&(e=n[a.options.columnFields.editorSettings],f=void 0!=e.activate?"click"==
e.activate:f);d&&d!=I?a.closeEditor(I):a.closeEditor();switch(h){case "checkbox":break;case "combobox":d&&0!=d[a.options.cellFields.allowEdit]&&n&&f?Eb(angular.element(this),e,c,k):a.removeDropDownList();break;case "incell":!G&&d&&0!=d[a.options.cellFields.allowEdit]&&f&&a.openInCellEditor(b,d,n);break;case "dropdown":!G&&d&&0!=d[a.options.cellFields.allowEdit]&&f&&a.openDropDownEditor(b,d,n);break;default:a.removeDropDownList()}}}),d.bind("mouseenter",function(d){if(!ta){var c=a.getRowFromChildElem(this);
if(c&&a.isRowEnabled(c)&&!ca){var k=a.getRowCurrentIndex(c),h=parseInt(a.getIndexFromElem(this),10);if(k=a.getCell(k,h,c[a.options.rowFields.fixed]))if(a.hoverCell=k,a.refreshHover(c),a.callCellHover(d,k),d=angular.element(this),k&&0!=k[a.options.cellFields.allowEdit])switch(h=a.getCellType(k,h),h){case "combobox":Bb||D(d);break;case "incell":G&&k==I||b(d,h);break;case "dropdown":G&&k!=I||b(d,h);break;default:Qa(),e()}else Qa()}}}),d.bind("mouseleave",function(b){if(!ta&&(a.hoverCell=null,(b=a.getRowFromChildElem(this))&&
a.isRowEnabled(b))){var d=a.getRowCurrentIndex(b),c=parseInt(a.getIndexFromElem(this),10);a.getCell(d,c,b[a.options.rowFields.fixed])&&(Qa(),e())}}),d.bind("click",function(b){var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)){if(1===b.which){var c=a.getRowCurrentIndex(d),k=parseInt(a.getIndexFromElem(this),10);c=a.getCell(c,k,d[a.options.rowFields.fixed]);a.callCellClick(b,d,c,a.getMousePos(b));a.callRowClick(b,d,a.getMousePos(b))}b.stopPropagation()}}),d.bind("dblclick",function(b){var d=
a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)){var c=angular.element(this);b.preventDefault();if(1===b.which){var k=a.getRowCurrentIndex(d),h=parseInt(a.getIndexFromElem(this),10),n=a.getCell(k,h,d[a.options.rowFields.fixed]),e=a.getCellType(n,h),f=null,g=a.options.editorSettings;n&&(f=a.getColumnById(n[a.options.cellFields.cid]));!f&&0<=h&&h<a.columnList.length&&(f=a.columnList[h]);var l="dblclick"==a.options.editorSettings.activate;f&&f[a.options.columnFields.editorSettings]&&(g=f[a.options.columnFields.editorSettings],
l=void 0!=g.activate?"dblclick"==g.activate:l);switch(e){case "checkbox":break;case "combobox":n&&0!=n[a.options.cellFields.allowEdit]&&f&&l?Eb(angular.element(this),g,k,h):a.removeDropDownList();break;case "incell":!G&&n&&0!=n[a.options.cellFields.allowEdit]&&l&&a.openInCellEditor(c,n,f);break;case "dropdown":!G&&n&&0!=n[a.options.cellFields.allowEdit]&&l&&a.openDropDownEditor(c,n,f);break;default:a.removeDropDownList()}a.callCellDblClick(d,n,a.getMousePos(b));a.callRowDblClick(d,a.getMousePos(b))}b.stopPropagation()}}),
d.bind("mousedown",function(b){a.closeFilterWindow();var d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)){var c=angular.element(this);a.mouseButtonStatus(!0);switch(b.which){case 1:var k=a.getRowCurrentIndex(d),h=parseInt(a.getIndexFromElem(this),10);d=a.getCell(k,h,d[a.options.rowFields.fixed]);var n=a.getCellType(d,h),e=null,f=a.options.editorSettings;d&&(e=a.getColumnById(d[a.options.cellFields.cid]));!e&&0<=h&&h<a.columnList.length&&(e=a.columnList[h]);var g="click"==a.options.editorSettings.activate;
e&&e[a.options.columnFields.editorSettings]&&(f=e[a.options.columnFields.editorSettings],g=void 0!=f.activate?"click"==f.activate:g);d&&d!=I?a.closeEditor(I):a.closeEditor();switch(n){case "checkbox":break;case "combobox":d&&0!=d[a.options.cellFields.allowEdit]&&e&&g?Eb(angular.element(this),f,k,h):a.removeDropDownList();break;case "dropdown":!G&&d&&0!=d[a.options.cellFields.allowEdit]&&g&&a.openDropDownEditor(c,d,e);break;case "incell":!G&&d&&0!=d[a.options.cellFields.allowEdit]&&g&&a.openInCellEditor(c,
d,e);break;default:a.removeDropDownList()}break;case 3:a.callRowRightClick(d,a.getMousePos(b))}b.stopPropagation()}}),d.bind("mouseup",function(a){1==a.which&&gc()}))};a.getTopRow=function(){return a.isRowIndexInRange(w-1)?a.currentList[w]:0<a.currentList.length?a.currentList[0]:null};a.getFooterElem=function(a){switch(a){case "left":return za;case "right":return ha}return Za};a.getHeaderElem=function(a){switch(a){case "left":return ia;case "right":return X}return ua};a.getRowElems=function(a,b){switch(a){case "left":switch(b){case "top":return Aa?
Aa.find("tr"):null;case "bottom":return Ba?Ba.find("tr"):null;default:return $a?$a.find("tr"):null}case "right":switch(b){case "top":return na?na.find("tr"):null;case "bottom":return Na?Na.find("tr"):null;default:return ab?ab.find("tr"):null}default:switch(b){case "top":return ea?ea.find("tr"):null;case "bottom":return Y?Y.find("tr"):null;default:return oa?oa.find("tr"):null}}};var te=function(b){var d="";b.icon?d=b.icon:a.options.rowIcon&&(d=a.options.rowIcon);return d},hd=function(b){return b.icon||
a.options.rowIcon},je=function(b,c,h,n){var d=a.currentList.length;0<d&&(b.shiftKey?g.isEqual(c[a.options.rowFields.id],a.currentList[0][a.options.rowFields.id])||ed(b,h,n):g.isEqual(c[a.options.rowFields.id],a.currentList[d-1][a.options.rowFields.id])||fd(b,h,n))},fd=function(b,c,h){b.preventDefault();focusDelayTime=0;var d=c,k=w+E-2;k=k<a.currentList.length-1?k:a.currentList.length-1;d>=k&&U&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+Math.floor(q[0].clientHeight/4)}),focusDelayTime=1);if(d=
a.getNextRow(d)){c=a.getRowCurrentIndex(d);c>k&&U&&(a.ensureVisible(d,"bottom"),focusDelayTime=100);a.rowSelection(d,b.shiftKey,b.ctrlKey,b.metaKey);var e=f(function(){a.updateFocus(c,h);f.cancel(e)},focusDelayTime)}},ed=function(b,c,h){b.preventDefault();focusDelayTime=0;var d=w;d=0<d?d:0;c==d&&U&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y-Math.floor(q[0].clientHeight/4)}),focusDelayTime=1);var k=a.getPrevRow(c);if(k){c=a.getRowCurrentIndex(k);c<d&&U&&(a.ensureVisible(k,"bottom"),focusDelayTime=
100);a.rowSelection(k,b.shiftKey,b.ctrlKey,b.metaKey);var e=f(function(){a.updateFocus(c,h);f.cancel(e)},focusDelayTime)}},qe=function(b,c,h,n){b.preventDefault();if((void 0===n||0<=n&&n==a.options.expandColIndex)&&!a.isRowExpanded(c)&&c[a.options.rowFields.rows]&&0<c[a.options.rowFields.rows].length)a.toggle(c,!0),a.updateFocus(h,n);else if(0<=n){focusDelayTime=0;var d=n+1;b=a.columnList.length-1;d===b&&(focusDelayTime=1);if(0<=d&&d<=b){b=g.getPageRect(q);c=a.getElemFromCell(h,d);c=g.getPageRect(c);
c.left+c.width>b.left+b.width&&(b=a.scrollPos,b.x+=c.width,a.setScrollPos(b));var k=f(function(){a.updateFocus(h,d);f.cancel(k)},focusDelayTime)}}},oe=function(b,c,h,n){b.preventDefault();if((void 0===n||0<=n&&n==a.options.expandColIndex)&&a.isRowExpanded(c)&&c[a.options.rowFields.rows]&&0<c[a.options.rowFields.rows].length)a.toggle(c,!1),a.updateFocus(h,n);else if(0<=n){focusDelayTime=0;var d=1<n?n-1:0;if(0<=d){b=g.getPageRect(q);c=a.getElemFromCell(h,d);c=g.getPageRect(c);c.left<b.left&&(b=a.scrollPos,
b.x-=c.width,a.setScrollPos(b));var k=f(function(){a.updateFocus(h,d);f.cancel(k)},focusDelayTime)}}},ke=function(b,c,h){b.preventDefault();var d=c-E;d=0<d?d:0;if(d!==c){focusDelayTime=1;var k=a.getPrevRow(d+1);if(k){a.scrollTo(k);a.rowSelection(k,b.shiftKey,b.ctrlKey,b.metaKey);p.$apply();var e=f(function(){a.updateFocus(a.getRowCurrentIndex(k),h);f.cancel(e)},focusDelayTime)}}},le=function(b,c,h){b.preventDefault();var d=c+E;a.options.showHeader&&d--;a.options.showFooter&&d--;d=d<a.currentList.length-
1?d:a.currentList.length-1;if(d!==c){focusDelayTime=1;var k=a.getNextRow(d-1);if(k){a.scrollTo(k,"bottom");a.rowSelection(k,b.shiftKey,b.ctrlKey,b.metaKey);p.$apply();var e=f(function(){a.updateFocus(a.getRowCurrentIndex(k),h);f.cancel(e)},focusDelayTime)}}},me=function(b,c,h){b.preventDefault();a.setScrollPos({x:a.scrollPos.x,y:S.y});var d=a.getLastRow();if(d){a.rowSelection(d,b.shiftKey,b.ctrlKey,b.metaKey);var k=f(function(){a.updateFocus(a.getRowCurrentIndex(d),h);f.cancel(k)},1)}},ne=function(b,
c,h){b.preventDefault();a.setScrollPos({x:a.scrollPos.x,y:0});var d=a.getFirstRow();if(d){a.rowSelection(d,b.shiftKey,b.ctrlKey,b.metaKey);var k=f(function(){a.updateFocus(a.getRowCurrentIndex(d),h);f.cancel(k)},1)}},se=function(b,c){if(b&&0!=b[a.options.cellFields.allowEdit]){var d=a.getColumnById(b[a.options.cellFields.cid]);!d&&0<=c&&c<a.columnList.length&&(d=a.columnList[c]);if(d){var k=b[a.options.cellFields.value];if((d=d[a.options.columnFields.editorSettings])&&1==d.threeState)switch(g.isString(k)||
(k="unchecked"),k){case "checked":k="unchecked";break;case "indeterminate":k="checked";break;default:k="indeterminate"}else k=g.isBoolean(k)?!k:!0;b[a.options.cellFields.value]=k;p.$apply()}}},pe=function(b,c,h,e){b.preventDefault();se(h,e);a.rowSelection(c,b.shiftKey,b.ctrlKey,b.metaKey,c.selected);p.$apply()},oa=null,ea=null,Y=null,Sa=angular.element('<div class="iui-grid-block iui-grid-block-top"></div>'),ua=null,Oa=angular.element('<div class="iui-grid-block iui-grid-block-left"></div>'),M=0,
Ub=0,ia=null,za=null,$a=null,Aa=null,Ba=null,Fa=angular.element('<div class="iui-grid-block iui-grid-block-right"></div>'),Ta=0,Vb=0,X=null,ha=null,ab=null,na=null,Na=null,Ua=angular.element('<div class="iui-grid-block iui-grid-block-bottom"></div>'),Za=null,w=0,z=null,v=null,pa=null,va=null,E=100,V=0,J=0,rb=0,Ic=0,A=0,L=0,Wb=0,Jc=!1,ta=!1,hc=9,ic=9,Kc=0,bb=0,sb=0,Gb=1,Lc=0,Mc=0,tb=0,Xb=0,Nc=1,W=null,ja=null,R=!1,U=!1;this.scrollMousePos=null;var S={x:0,y:0},Nb=[];p.verScrollVisibility=!1;p.$watch("verScrollVisibility",
function(b,c){a.suppressWatchScrollVisibility||b==c||a.updateCurrentLayout()});a.getColumnWidth=function(b){var d=100;b&&b[a.options.columnFields.width]&&(d=b[a.options.columnFields.width],g.isPercent(d)?(b=q[0].clientWidth-2*a.columnList.length,U&&Q&&(b-=Q[0].offsetWidth),d=Math.floor(parseInt(d,10)/100*b)):g.isString&&(d=parseInt(d,10)));return d};a.getColumnWidthFromData=function(b){var d=0;if(z){for(var c=null,e=0;e<z.data.length;e++)for(var f=0;f<z.data[e].length;f++){var l=z.data[e][f];if(l.column==
b||g.isEqual(l.column[a.options.columnFields.id],b[a.options.columnFields.id])){c=l;break}if(c)break}c&&(d=c.width)}return d};var jc=function(b){var d=0;if((b=a.getRowElems(b))&&0<b.length&&(b=angular.element(b[0]))&&(b=b.find("td"))&&0<b.length)for(var c=0;c<b.length;c++){var e=angular.element(b[c]);d+=e[0].offsetWidth}return d},tf=function(){var b=0;if(a.options.showHeader||a.options.showFooter){var c=a.options.showHeader?a.getHeaderElem():a.getFooterElem();if(c&&(c=c.find("td"))&&0<c.length)for(var h=
0;h<c.length;h++){var e=angular.element(c[h]);e[0].attributes["data-element"]&&"column-header"==e[0].attributes["data-element"].value.toString()&&e[0].attributes["data-level"]&&"0"==e[0].attributes["data-level"].value.toString()&&(b+=e[0].offsetWidth)}a.isThereLeftFixedColumns&&(ia?M=ia[0].offsetWidth:za&&(M=za[0].offsetWidth),b+=M);a.isThereRightFixedColumns&&(X?Ta=X[0].offsetWidth:ha&&(Ta=ha[0].offsetWidth),b+=Ta)}else 0<a.currentList.length&&(oa&&(b+=jc()),a.isThereLeftFixedColumns&&(b+=jc("left")),
a.isThereRightFixedColumns&&(b+=jc("right")));return b};a.updateScrollVisibility=function(){var b=f(function(){R&&a.options.showScroll.horizontal?F.css("display","block"):(F.css("display","none"),S.x=0);U&&a.options.showScroll.vertical?Q.css("display","block"):(Q.css("display","none"),S.y=0);R&&a.options.showScroll.horizontal&&U&&a.options.showScroll.vertical?hb.css("display","block"):hb.css("display","none");f.cancel(b)},1)};q.append(F);q.append(Q);q.append(hb);a.updateScrollVisibility();var ue=
function(){return ea?ea[0].offsetHeight:Aa?Aa[0].offsetHeight:na?na[0].offsetHeight:0},ve=function(){return Y?Y[0].offsetHeight:Ba?Ba[0].offsetHeight:Na?Na[0].offsetHeight:0},kc=0,lc=999;a.updateViewSize=function(){var b=f(function(){var d=0;a.options.grouping.enabled&&x&&(d=x[0].offsetHeight);Wb=0;var c=q[0].clientWidth;U&&Q&&(c-=Q[0].offsetWidth);R=!1;0<a.columnList.length&&(Wb+=tf(),Wb>c&&(F.unbind("mousedown"),F.bind("mousedown",function(b){if(a.options.enabled){a.removeDropDownList();a.closeFilterWindow();
a.closeEditor(null,null,!0);b=g.getClientMousePos(b,this);var d=Math.floor(q[0].clientWidth);W&&(b.x<W[0].offsetLeft?a.setScrollPos({x:a.scrollPos.x-d,y:a.scrollPos.y}):b.x>W[0].offsetLeft+W[0].offsetWidth&&a.setScrollPos({x:a.scrollPos.x+d,y:a.scrollPos.y}))}}),W=angular.element(F.children().eq(0)),R=!0,W.bind("mousedown",function(b){a.options.enabled&&(a.removeDropDownList(),a.closeFilterWindow(),a.closeEditor(null,null,!0),1===b.which&&(O.scrollMousePos=a.getMousePos(b),Jc=!0));b.stopPropagation()})));
U=!1;p.verScrollVisibility=!1;0<a.currentList.length&&(c=0,a.options.paging.enabled&&aa&&(c=aa[0].offsetHeight),topRowHeight=ue(),bottomRowHeight=ve(),d=q[0].clientHeight-d-c-(A+L)-topRowHeight-bottomRowHeight,R&&F&&(d-=F[0].offsetHeight),E=0<V?Math.floor(d/V)+1:0<A?Math.floor(d/A):100,E<a.currentList.length+1&&(Q.unbind("mousedown"),Q.bind("mousedown",function(b){if(a.options.enabled){a.removeDropDownList();a.closeFilterWindow();a.closeEditor(null,null,!0);b=g.getClientMousePos(b,this);var d=Math.floor(q[0].clientHeight);
ja&&(b.y<ja[0].offsetTop?(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y-d}),Gc(!1,d)):b.y>ja[0].offsetTop+ja[0].offsetHeight&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+d}),Gc(!0,d)))}}),ja=angular.element(Q.children().eq(0)),U=!0,p.verScrollVisibility=!0,ja.bind("mousedown",function(b){if(a.options.enabled&&(a.removeDropDownList(),a.closeFilterWindow(),a.closeEditor(null,null,!0),1===b.which)){O.scrollMousePos=a.getMousePos(b);ta=!0;kc=0;lc=999;for(var d=0,c=!1,h=!1,k=a.scrollPos.x+rb-(M+
Ta),e=0;e<a.columnList.length;e++)if(!a.isColumnFixed(a.columnList[e])){var n=a.getColumnWidth(a.columnList[e])+4;d+=n;!c&&d>=a.scrollPos.x&&(kc=e,c=!0);!h&&d>=k&&(lc=e,h=!0);if(c&&h)break}}b.stopPropagation()})));R||(F.unbind("mousedown"),S.x=0);U||(Q.unbind("mousedown"),S.y=0);!R&&0<a.scrollPos.x&&a.setScrollPos({x:0,y:a.scrollPos.y});!U&&0<a.scrollPos.y&&a.setScrollPos({x:a.scrollPos.x,y:0});f.cancel(b)},1)};a.updateScrollView=function(){id()};var id=function(){var b=f(function(){var d=0;a.options.grouping.enabled&&
x&&(d=x[0].offsetHeight);var c=0;a.options.paging.enabled&&aa&&(c=aa[0].offsetHeight);rb=q[0].offsetWidth-2;Ic=q[0].offsetHeight-2-d-c;R&&a.options.showScroll.horizontal&&(Ic-=F[0].offsetHeight);U&&a.options.showScroll.vertical&&(rb-=Q[0].offsetWidth);Ca.css("margin-top",d+"px");Ca.css("width",rb+"px");Ca.css("height",Ic+"px");R&&(F.css("left","0px"),F.css("bottom",c+"px"),F.css("width",rb-2+"px"));var e=2;a.options.paging.enabled&&aa&&(e=4);U&&(Q.css("top",d+"px"),Q.css("right","0px"),Q.css("height",
Ic-e+"px"));R&&U&&(hb.css("left","auto"),hb.css("right","0px"));var B=f(function(){topRowHeight=ue();bottomRowHeight=ve();var b=A+topRowHeight;R&&rb<Wb&&(bb=2,sb=F[0].clientWidth-4,Kc=0,sb>bb&&(Kc=sb-bb),hc=Math.floor(Kc*rb/Wb),9>hc&&(hc=9),W.css("width",hc+"px"),S.x=Wb-rb,Gb=S.x/(Kc-hc-2));var h=a.currentList.length+1;U&&0<a.currentList.length&&E<h&&(tb=2,Xb=Q[0].clientHeight-4,Lc=0,Xb>tb&&(Lc=Xb-tb),ic=Math.floor(Lc*E/h),9>ic&&(ic=9),ja.css("height",ic+"px"),Nc=(h-E+1)/(Lc-ic-2),S.y=Math.floor((h-
E+1)*V),0>S.y&&(S.y=0),0==w?ja.css("top",tb+"px"):w+E-1==a.currentList.length&&ja.css("top",Xb-ja[0].offsetHeight+"px"));a.isThereLeftFixedColumns?(ia?M=ia[0].offsetWidth:za?M=za[0].offsetWidth:0<a.currentList.length&&(M=jc("left")),Ub=q[0].clientHeight-d-c-A-L,R&&(Ub-=F[0].offsetHeight),Oa.css("width",M+"px"),Oa.css("height",Ub+"px"),ua&&ua.css("left",M+"px"),oa&&oa.css("left",M+"px"),ea&&ea.css("left",M+"px"),Y&&Y.css("left",M+"px"),Za&&Za.css("left",M+"px")):Oa&&(Oa.css("width","0"),Oa.css("height",
"0"));a.isThereRightFixedColumns?(X?Ta=X[0].offsetWidth:ha?Ta=ha[0].offsetWidth:0<a.currentList.length&&(Ta=jc("right")),Vb=q[0].clientHeight-d-c-A-L,R&&(Vb-=F[0].offsetHeight),h=0,U&&(h=Q[0].offsetWidth),X&&X.css("right",h+"px"),Fa.css("right",h+"px"),Fa.css("width",Ta+"px"),Fa.css("height",Vb+"px"),ha&&ha.css("right",h+"px")):Fa&&(Fa.css("width","0"),Fa.css("height","0"));h=c;R&&F&&(h+=F[0].offsetHeight);Ua.css("bottom",h+"px");oa&&oa.css("top",b+"px");Y&&Y.css("bottom",L+"px");$a&&$a.css("top",
topRowHeight+"px");ab&&ab.css("top",topRowHeight+"px");b=a.scrollPos.x;void 0!=b&&(0>b&&(b=0),b>S.x&&(b=S.x),a.scrollPos.x=b,b=!1!==a.options.rtl?Math.floor(a.scrollPos.x/Gb)-(sb-W[0].offsetWidth-bb):Math.floor(a.scrollPos.x/Gb)+bb,R&&W&&W.css("left",b+"px"),jd());f.cancel(B)},1);f.cancel(b)},5)};a.updateColumnWidth=function(){if(a.options.fillSpace){for(var b=0,c=0;c<a.columnList.length;c++)b+=a.getColumnWidth(a.columnList[c])+4;if(b<q[0].clientWidth){b=(q[0].clientWidth-b)/a.columnList.length;for(c=
0;c<a.columnList.length;c++){var h=a.getColumnWidth(a.columnList[c])+b;a.columnList[c][a.options.columnFields.width]=h}return!0}}return!1};p.onCellValueChanging=function(b,c,h){var d=c+w,k=a.getCell(d,h);if(k&&0==k[a.options.cellFields.allowEdit])return!1;k=!0;var e=a.getColumnObject(h),f="label",g=null;e&&(f=e[a.options.columnFields.editorType],g=e[a.options.columnFields.editorSettings]);switch(f){case "checkbox":b=g&&1==g.threeState?b.checkState:b.checked;k=a.callCellValueChanging(a.getRowObject(d),
a.getCellObject(d,h),b);break;case "combobox":k=a.callCellValueChanging(a.getRowObject(c),a.getCellObject(c,h),b.item)}return k};p.onCellValueChanged=function(b,c,h){var d=c+w,k=a.getColumnObject(h),e="label",f=null;k&&(e=k[a.options.columnFields.editorType],f=k[a.options.columnFields.editorSettings]);switch(e){case "checkbox":b=f&&1==f.threeState?b.checkState:b.checked;a.callCellValueChanged(a.getRowObject(d),a.getCellObject(d,h),b);break;case "combobox":if(d=a.getCell(c,h))d[a.options.cellFields.value]=
b.item,p.$apply(),"optimal"==a.options.displayMode&&a.updateView();a.removeDropDownList(!0);a.updateFocus(c,h);a.callCellValueChanged(a.getRowObject(c),a.getCellObject(c,h),b.item)}};p.onEditorClick=function(b,c,h){c+=w;var d=a.getColumnObject(h),k="label";d&&(k=d[a.options.columnFields.editorType]);switch(k){case "checkbox":a.callCellClick(b,a.getRowObject(c),a.getCellObject(c,h),a.getMousePos(b))}};a.setDefaultCellValue=function(b,c,h){if(void 0==b[a.options.cellFields.value]){var d=void 0;switch(c){case "checkbox":d=
h&&1==h.threeState?"unchecked":!1;break;case "image":d=""}void 0!=d&&(b[a.options.cellFields.value]=d)}};a.getColumnTemplateUrl=function(b,c){return c?b[a.options.columnFields.templateSettings].footer?b[a.options.columnFields.templateSettings].footer.url:null:b[a.options.columnFields.templateSettings].header?b[a.options.columnFields.templateSettings].header.url:null};var kd=function(b){b=void 0==b?"none":b;var d='<table cellpadding="0" cellspacing="0" style="position:absolute;top:0;">';if(0<a.relatedColumns.length&&
0<a.completeColumnList.length){d+="<tr>";for(var c=0;c<a.completeColumnList[0].length;c++){var e=a.completeColumnList[0][c];d+='<td class="iui-grid-column-expand-cell" data-level="0" data-index="'+c+'" data-element="column-expand-cell" colspan="'+e.colSpan+'">';d+='<div class="iui-grid-column-expand-cell-content">';if(a.isColumnRelated(e.column)&&(e=a.getColumnRelatedObject(e.column))){var f=a.isTherePrevRelatedColumn(e),g=a.isThereNextRelatedColumn(e);if(e.children&&0<e.children.length){var l="iui-grid-column-expand-box";
l=0!=e.expanded?l+" iui-grid-column-expand-box-close":l+" iui-grid-column-expand-box-open";d+='<span class="'+l+'"></span>'}else if(f||g)d+='<span class="iui-grid-column-expand-line-vertical"></span>';f&&(d+='<span class="iui-grid-column-expand-line-left"></span>');g&&0!=e.expanded&&(d+='<span class="iui-grid-column-expand-line-right"></span>')}d+="</div></td>"}d+="</tr>"}for(f=0;f<a.completeColumnList.length;f++){d+="<tr>";for(c=0;c<a.completeColumnList[f].length;c++)e=a.completeColumnList[f][c],
g=e.column[a.options.columnFields.fixed],g=void 0==g?"none":g,g==b&&(d+='<td iui-class="{{data['+f+"]["+c+'].style.header.general}}" data-level="'+f+'"  data-index="'+c+'" data-element="column-header"',0<e.colSpan&&(d+=' colspan="'+e.colSpan+'"'),0<e.rowSpan&&(d+=' rowspan="'+e.rowSpan+'"'),d+='><div iui-class="{{data['+f+"]["+c+'].style.header.cell}}" data-element="column-header-cell"',d+=' iui-contextmenu menu-items="data['+f+"]["+c+"].column."+a.options.columnFields.contextMenu+'"',d+=' iui-style="overflow:hidden;width:{{data['+
f+"]["+c+"].width}}px;text-align:{{data["+f+"]["+c+'].headerAlignment}};">',d+='<span iui-class="{{data['+f+"]["+c+'].style.header.content}}" data-element="cell-content"',d+=' iui-tooltip="data['+f+"]["+c+"].column."+a.options.columnFields.headerTooltip+'">',d+="{{data["+f+"]["+c+"].column."+a.options.columnFields.headerText+"}}</span>",d+='<span iui-class="{{data['+f+"]["+c+'].style.filtering}}" data-level="'+f+'" data-index="'+c+'" data-element="filter-button" ng-show="data['+f+"]["+c+'].showFiltering"></span>',
d+='<span iui-class="{{data['+f+"]["+c+'].style.sorting}}" data-level="'+f+'" data-index="'+c+'" data-element="sort-button" ng-show="data['+f+"]["+c+'].showSorting"></span>',d+="</div>",d+="</td>");d+="</tr>"}return d+"</table>"},ld=function(b){b=void 0==b?"none":b;var d='<table cellpadding="0" cellspacing="0" style="position:absolute;bottom:0;"><tr>';for(var c=0;c<a.columnList.length;c++){var e=a.columnList[c];var f=e[a.options.columnFields.fixed];f=void 0==f?"none":f;f==b&&(d+='<td iui-class="{{dataFooter['+
c+'].style.footer.general}}" data-index="'+c+'" data-element="column-footer">',d+='<div iui-class="{{dataFooter['+c+'].style.footer.cell}}" data-element="column-footer-cell"',d+=' iui-contextmenu menu-items="dataFooter['+c+"].column."+a.options.columnFields.contextMenu+'"',d+=' iui-style="overflow:hidden;width:{{dataFooter['+c+"].width}}px;text-align:{{dataFooter["+c+'].footerAlignment}};">',e[a.options.columnFields.templateSettings]&&a.getColumnTemplateUrl(e,!0)?(d+='<iui-item-content obj="dataFooter['+
c+"].column."+a.options.columnFields.templateSettings+'.footer.templateObj" template-url="{{dataFooter['+c+"].column."+a.options.columnFields.templateSettings+'.footer.url}}"',d+=' data-element="footer-template-content" ng-cloak></iui-item-content>'):e[a.options.columnFields.footerContent]?d+=e[a.options.columnFields.footerContent]:e[a.options.columnFields.footerTemplate]?d+='<div ng-include="'+e[a.options.columnFields.footerTemplate]+'" style="margin:0;padding:0"></div>':(d+='<span iui-class="{{dataFooter['+
c+'].style.footer.content}}" data-element="cell-content"',d+=' iui-tooltip="dataFooter['+c+"].column."+a.options.columnFields.footerTooltip+'">',d+="{{dataFooter["+c+"].column."+a.options.columnFields.footerText+"}}</span>"),d+="</div>",d+="</td>")}return d+"</tr></table>"},Ga=function(b,c,h,e){if("optimal"==a.options.displayMode){c=void 0==c?"none":c;e='<tr class="iui-grid-row" data-index="'+b+'" data-fixed="'+e+'"';h&&(e+=' style="position:absolute;top:-9999px"');e+=">";for(var d=0;d<a.columnList.length;d++)h=
a.columnList[d][a.options.columnFields.fixed],h=void 0==h?"none":h,h==c&&(e+='<td class="iui-grid-row-cell" data-element="cell" data-index="'+d+'">',e+="<div",e+=' class="iui-grid-row-cell-content" data-element="cell-content"',e+=' style="width:0px;text-align:left;opacity:0;',0<a.options.rowHeight&&(e+="height:"+a.options.rowHeight+"px;"),e=0<a.groups.length&&d==a.options.expandColIndex?e+'padding-left:0px;">':e+'">',e+=we(b,d),e+="</div>",e+="</td>");return e+"</tr>"}c=void 0==c?"none":c;e='<tr iui-class="{{data['+
b+'].style.general}}" data-index="{{data['+b+'].index}}" data-fixed="'+e+'" tabindex="{{data['+b+'].tabindex}}"'+(' iui-refresh-style="{{data['+b+'].style.custom}}"');h&&(e+=' style="position:absolute;top:-9999px"');e+=">";for(d=0;d<a.columnList.length;d++)h=a.columnList[d][a.options.columnFields.fixed],h=void 0==h?"none":h,h==c&&(e+='<td iui-class="{{data['+b+"].cells["+d+'].style.cell}}" data-element="cell" data-index="'+d+'" draggable="{{data['+b+'].draggable}}" tabindex="{{data['+b+"].cells["+
d+'].tabindex}}"',e+=' iui-refresh-style="{{data['+b+"].cells["+d+'].style.custom}}">',e+='<div ng-show="data['+b+'].visible"',e+=' iui-class="{{data['+b+"].cells["+d+'].style.content}}" data-element="cell-content"',e+=' iui-style="width:{{data['+b+"].cells["+d+"].width}}px;text-align:{{data["+b+"].cells["+d+"].alignment}};",0<a.options.rowHeight&&(e+="height:"+a.options.rowHeight+"px;"),e=0<a.groups.length&&d==a.options.expandColIndex?e+("padding-left:{{data["+b+"].cells["+d+'].indent}}px;">'):e+
'">',e+=we(b,d),e+="</div>",e+="</td>");return e+"</tr>"},we=function(b,c){if("optimal"==a.options.displayMode){var d="";c===a.options.expandColIndex&&(d+='<span data-element="expandbox"></span><span data-element="icon"></span>');var k=a.columnList[c][a.options.columnFields.editorSettings],e=ub(c);switch(a.columnList[c][a.options.columnFields.editorType]){case "checkbox":d+='<iui-checkbox name="cb-'+g.getUniqueId(4)+'"';k&&1==k.threeState?(d+=' check-state="data['+b+"].cells["+c+"].related."+a.options.cellFields.value+
'"',d=d+(' checkstate-changing="onCellValueChanging(e, '+b+", "+c+')"')+(' checkstate-changed="onCellValueChanged(e, '+b+", "+c+')"')+' three-state="true"'):(d+=' checked="data['+b+"].cells["+c+"].related."+a.options.cellFields.value+'"',d=d+(' checked-changing="onCellValueChanging(e, '+b+", "+c+')"')+(' checked-changed="onCellValueChanged(e, '+b+", "+c+')"'));d+=' click="onEditorClick(e, '+b+", "+c+')"';k&&k.style&&(d+=' control-style="data['+b+"].cells["+c+'].editorStyle"');d=d+(' enabled="data['+
b+"].cells["+c+'].enabled"')+(' style="vertical-align:middle;" iui-show="{{data['+b+"].cells["+c+'].visible}}"')+(' iui-tooltip="data['+b+"].cells["+c+"].related."+a.options.cellFields.tooltip+'">');d+="</iui-checkbox>";break;case "combobox":d=d+('<span iui-class="{{data['+b+"].cells["+c+'].style.label}}" data-element="content"')+(' iui-tooltip="data['+b+"].cells["+c+"].related."+a.options.cellFields.tooltip+'">');d+="{{data["+b+"].cells["+c+"].related."+a.options.cellFields.value+".text}}";d+="</span>";
break;case "image":d+='<img data-element="image" style="vertical-align:middle" ng-src="{{data['+b+"].cells["+c+"].related."+a.options.cellFields.value+'}}"  iui-show="{{data['+b+"].cells["+c+'].visible}}" show-default="true"';d+=' iui-tooltip="data['+b+"].cells["+c+"].related."+a.options.cellFields.tooltip+'">';break;default:e&&""!=e?d+='<iui-item-content obj="data['+b+"].cells["+c+"].related."+a.options.cellFields.templateObj+'" template-url="{{data['+b+"].cells["+c+'].templateUrl}}" iui-show="{{data['+
b+"].cells["+c+'].templateVisible}}" data-element="template-content"></iui-item-content>':(d=d+'<span class="iui-grid-row-cell-label" data-element="content"'+(' iui-tooltip="data['+b+"].cells["+c+"].related."+a.options.cellFields.tooltip+'">'),d+=".</span>")}return d}d="";c===a.options.expandColIndex&&(d=d+('<span iui-class="{{data['+b+'].expandBox}}" data-element="expandbox" ng-show="data['+b+'].expandBoxVisible"></span>')+('<span iui-class="{{data['+b+'].icon}}" data-element="icon" ng-show="data['+
b+'].iconVisible"></span>'));k=a.columnList[c][a.options.columnFields.editorSettings];e=ub(c);switch(a.columnList[c][a.options.columnFields.editorType]){case "checkbox":d+='<iui-checkbox name="cb-'+g.getUniqueId(4)+'"';k&&1==k.threeState?(d+=' check-state="data['+b+"].cells["+c+"].related."+a.options.cellFields.value+'"',d=d+(' checkstate-changing="onCellValueChanging(e, '+b+", "+c+')"')+(' checkstate-changed="onCellValueChanged(e, '+b+", "+c+')"')+' three-state="true"'):(d+=' checked="data['+b+"].cells["+
c+"].related."+a.options.cellFields.value+'"',d=d+(' checked-changing="onCellValueChanging(e, '+b+", "+c+')"')+(' checked-changed="onCellValueChanged(e, '+b+", "+c+')"'));d+=' click="onEditorClick(e, '+b+", "+c+')"';k&&k.style&&(d+=' control-style="data['+b+"].cells["+c+'].editorStyle"');d=d+(' enabled="data['+b+"].cells["+c+'].enabled"')+(' style="vertical-align:middle;" iui-show="{{data['+b+"].cells["+c+'].visible}}"')+(' iui-tooltip="data['+b+"].cells["+c+"].related."+a.options.cellFields.tooltip+
'">');d+="</iui-checkbox>";break;case "combobox":d=d+('<span iui-class="{{data['+b+"].cells["+c+'].style.label}}" data-element="content"')+(' iui-tooltip="data['+b+"].cells["+c+"].related."+a.options.cellFields.tooltip+'">');d+="{{data["+b+"].cells["+c+"].related."+a.options.cellFields.value+".text}}";d+="</span>";break;case "image":d+='<img data-element="image" style="vertical-align:middle" ng-src="{{data['+b+"].cells["+c+"].related."+a.options.cellFields.value+'}}"  iui-show="{{data['+b+"].cells["+
c+'].visible}}" show-default="true"';d+=' iui-tooltip="data['+b+"].cells["+c+"].related."+a.options.cellFields.tooltip+'">';break;default:e&&""!=e?d+='<iui-item-content obj="data['+b+"].cells["+c+"].related."+a.options.cellFields.templateObj+'" template-url="{{data['+b+"].cells["+c+'].templateUrl}}" iui-show="{{data['+b+"].cells["+c+'].templateVisible}}" data-element="template-content"></iui-item-content>':(d=d+('<span iui-class="{{data['+b+"].cells["+c+'].style.label}}" data-element="content"')+
(' iui-tooltip="data['+b+"].cells["+c+"].related."+a.options.cellFields.tooltip+'">'),d+="{{data["+b+"].cells["+c+"].related."+a.options.cellFields.text+"}}",d+="</span>")}return d},x=angular.element('<div class="iui-grid-grouping-panel"></div>'),ka=null,mc=null,Hb=-1,vb=!1,Z=angular.element('<div style="opacity:0.75;position:absolute;top:-9999px;z-index:999;pointer-events:none;"></div>'),md=0,wa=angular.element('<div style="display:inline-block;"></div>'),wb=[],nd=function(b){var d=b[a.options.columnFields.groupText];
d&&""!=d||(d=b[a.options.columnFields.headerText]);return d},vf=function(){Td();x.unbind("mouseenter mouseleave mousemove mouseup");x.empty();x.remove();wb.length=0;if(a.options.grouping.enabled){var b="",c=0;if(0<a.groups.length)for(var h=0;h<a.groups.length;h++){var e="iui-grid-grouping-panel-item";h<a.groups.length-1&&(e+=" iui-grid-grouping-marker");var f=nd(a.groups[h]);b+='<div class="'+e+'" data-index="'+h+'">';b+='<p class="iui-grid-grouping-panel-item-label">'+f+"</p>";b+='<span class="iui-grid-grouping-panel-item-button"></span></div>'}else h=
angular.element('<span class="iui-grid-grouping-panel-item" style="position:absolute;top:-999px;">Temp</span>'),q.append(h),c=h[0].offsetHeight,h.remove();if(""!=b){var l=angular.element(b);x.append(l)}qa&&x.css("opacity",ra.opacity);q.append(x);e=0;f=x.find("div");for(h=0;h<f.length;h++){var Ea=angular.element(f[h]),p=g.getMargin(Ea[0]);wb.push({x:e,width:Ea[0].offsetWidth});e+=Ea[0].offsetWidth+p.left+p.right}h=g.getPadding(x[0]);x.bind("mouseenter",function(b){a.options.enabled&&1==b.which&&ca&&
y&&(Z.empty(),Z.append('<div class="iui-grid-grouping-panel-item">'+y[a.options.columnFields.headerText]+"</div>"),x.append(Z),md=Z[0].offsetWidth,Z.css("display","none"),vb=!0,ka=null);b.stopPropagation()});x.bind("mousemove",function(b){if(a.options.enabled&&1==b.which&&(ca&&y||vb&&ka)){if(ca&&y&&0>a.columnList.indexOf(y)){q.css("cursor","no-drop");document.body.style.cursor="no-drop";return}var d=x[0].getBoundingClientRect(),c=angular.element(m)[0].pageXOffset,h=angular.element(m)[0].pageYOffset,
k=a.getMousePos(b);k.x-=d.left+c;k.y-=d.top+h;d="";y?d=nd(y):ka&&(d=nd(ka));xe(b,d);ma&&ma.css("display","none");q.css("cursor","default");document.body.style.cursor="default";mc=null;d=-1;ka&&(d=a.groups.indexOf(ka));for(c=wb.length-1;0<=c;c--)if(k.x>=wb[c].x){k.x<=wb[c].x+wb[c].width&&(mc=a.groups[c]);if(h=a.getElemFromGroup(a.groups[c]))Hb=c,wa.css("display","inline-block"),y&&wa.css("width",h[0].offsetWidth+"px"),y?k.x<=wb[c].x+wb[c].width?(k=ye(mc))?(k=a.getElemFromGroup(k))&&k.after(wa):x.prepend(wa):
h.after(wa):0==c?x.prepend(wa):d>c?(k=ye(mc))&&(k=a.getElemFromGroup(k))&&k.after(wa):h.after(wa);Hb=0>Hb?0:Hb>a.groups.length-1?a.groups.length-1:Hb;break}}b.stopPropagation()});x.bind("mouseup",function(b){if(a.options.enabled&&1==b.which&&(ca&&y||vb&&ka)){if(vb&&ka){var d=a.groups.indexOf(ka),c=Hb;d!=c?(a.moveObject(d,c,a.groups),a.updateLayout(),a.callGroupChange(ka)):(d=a.getElemFromGroup(ka))&&d.css("display","inline-block")}else mc?(c=Hb,0>a.groups.indexOf(y)&&(a.groups.splice(c,0,y),a.updateLayout(),
a.callGroupChange(y))):0>a.groups.indexOf(y)&&(a.groups.push(y),a.updateLayout(),a.callGroupChange(y));Z&&Z.remove();wa&&wa.remove();y=null;qb=-1;vb=ca=!1;ka=null;ma&&ma.remove();q.css("cursor","default");document.body.style.cursor="default";b.stopPropagation()}});x.bind("mouseleave",function(b){a.options.enabled&&(wa&&wa.remove(),Z&&Z.css("display","none"))});x.css("width",q[0].clientWidth+"px");""==b?x.css("height",c+(h.top+h.bottom)-2+"px"):l&&x.css("height",l[0].offsetHeight+(h.top+h.bottom)-
2+"px");uf();a.updateGroupPanel()}};a.updateGroupPanel=function(){var b=1;a.options.enabled||(b=.5);if(x){var c=x.find("span");if(c&&0<c.length)for(var h=0;h<c.length;h++){var e=angular.element(c[h]);e.css("opacity",b)}if((c=x.find("p"))&&0<c.length)for(h=0;h<c.length;h++)e=angular.element(c[h]),a.options.enabled?e.removeClass("iui-grid-grouping-panel-item-disabled"):e.addClass("iui-grid-grouping-panel-item-disabled")}};var xe=function(b,c){Z.empty();Z.append('<div class="iui-grid-grouping-panel-item"><p class="iui-grid-grouping-panel-item-label">'+
c+"</p></div>");x.append(Z);var d=g.getPadding(x[0]),k=x[0].getBoundingClientRect(),e=angular.element(m)[0].pageXOffset,f=angular.element(m)[0].pageYOffset,l=a.getMousePos(b);l.x-=k.left+e;l.y-=k.top+f;md=Z[0].offsetWidth;k=l.x-md/2;Z.css("top",d.top+"px");Z.css("left",k+"px");Z.css("display","block")};a.getGroupFromElem=function(b){return b&&(b=angular.element(b))&&(b=b.parent(),b[0].attributes["data-index"]&&(b=b[0].attributes["data-index"].value,a.isGroupIndexinRange(b,a.groups)))?a.groups[b]:
null};a.getElemFromGroup=function(b){var d=null;if(b){b=a.groups.indexOf(b);for(var c=x.find("div"),e=0;e<c.length;e++){var f=angular.element(c[e]);if(f[0].attributes&&f[0].attributes["data-index"]&&f[0].attributes["data-index"].value==b){d=f;break}}}return d};var ye=function(b){return b&&(b=a.groups.indexOf(b)-1,a.isGroupIndexinRange(b,a.groups))?a.groups[b]:null},Td=function(){for(var a=x.find("p"),b=0;b<a.length;b++){var c=angular.element(a[b]);c.unbind("mousedown")}a=x.find("span");for(b=0;b<
a.length;b++)c=angular.element(a[b]),c.unbind("mousedown")},uf=function(){for(var b=x.find("p"),c=0;c<b.length;c++){var h=angular.element(b[c]);h.bind("mousedown",function(b){if(a.options.enabled&&1==b.which){var d=angular.element(this),c=d.parent();vb=!0;ka=a.getGroupFromElem(d);wa.css("width",c[0].offsetWidth+6+"px");wa.css("display","inline-block");c.after(wa);c.css("display","none");xe(b,ka[a.options.columnFields.headerText])}b.stopPropagation()})}b=x.find("span");for(c=0;c<b.length;c++)h=angular.element(b[c]),
h.bind("mousedown",function(b){if(a.options.enabled){var d=a.getGroupFromElem(this);if(d){var c=a.groups.indexOf(d);0<=c&&0!=a.callGroupRemoving(d)&&(a.groups.splice(c,1),a.updateLayout(),a.callGroupRemoved(d),a.callGroupChange(d))}}b.stopPropagation()})};a.isGroupIndexinRange=function(a,b){return 0<=a&&a<b.length?!0:!1};a.moveObject=function(b,c,h){a.isGroupIndexinRange(b,h)&&a.isGroupIndexinRange(c,h)&&h.splice(c,0,h.splice(b,1)[0])};var wf=function(){V=0;if(0<a.options.rowHeight){var b={top:0,
bottom:0};if(a.options.controlStyle&&a.options.controlStyle.row&&a.options.controlStyle.row.cell&&a.options.controlStyle.row.cell.content){var k=angular.element('<div class="'+a.options.controlStyle.row.cell.content+'" style="position:absolute;top:-9999999px;">Temp</div>');q.append(k);b=g.getPadding(k[0]);k.remove()}V=a.options.rowHeight+b.top+b.bottom+3}else if(0<a.currentList.length&&v){b=[];var h=[];k=[];for(var e=[],l=[],Bc=[],m=0,p=0;p<a.currentList.length&&10>p;p++)b.push(Ga(p,"none",!0)),h.push(c(b[p])(v)),
q.append(h[p]),a.isThereLeftFixedColumns&&(k.push(Ga(p,"left",!0)),e.push(c(k[p])(v)),q.append(e[p])),a.isThereRightFixedColumns&&(l.push(Ga(p,"right",!0)),Bc.push(c(l[p])(v)),q.append(Bc[p])),m++;if(0<m)var r=f(function(){for(var b=0,d=0,c=0,k=0;k<m;k++)b+=h[k][0].offsetHeight,h[k].remove(),a.isThereLeftFixedColumns&&(d+=e[k][0].offsetHeight,e[k].remove()),a.isThereRightFixedColumns&&(c+=Bc[k][0].offsetHeight,Bc[k].remove());V=Math.floor(Math.max(Math.max(b,d),c)/m);f.cancel(r)},1)}},N=null,od=0,
pd=0,aa=angular.element('<div class="iui-pagination-panel"></div>'),xf=function(){N&&N.$destroy();aa.empty();aa.remove();pd=od=0;if(a.options.paging.showControlPanel){N=p.$new();N.currentPage=0;N.minPages=0;N.numPages=a.pageList.length;0<N.numPages&&0==N.currentPage&&(N.currentPage=1);N.onFirstPage=function(){a.options.enabled&&(a.firstPage(),N.currentPage=a.currentPageNumber)};N.onLastPage=function(){a.options.enabled&&(a.lastPage(),N.currentPage=a.currentPageNumber)};N.onNextPage=function(){a.options.enabled&&
(a.nextPage(),N.currentPage=a.currentPageNumber)};N.onPrevPage=function(){a.options.enabled&&(a.prevPage(),N.currentPage=a.currentPageNumber)};N.$watch("currentPage",function(b,d){a.options.enabled&&b!=d&&1<=b&&b<=a.pageList.length&&a.setCurrentPage(b)});od=q[0].clientWidth;for(var b="",k=0;6>k;k++)switch(k){case 0:b+='<span class="iui-pagination-panel-button iui-pagination-first" ng-click="onFirstPage()"></span>';break;case 1:b+='<span class="iui-pagination-panel-button iui-pagination-prev" ng-click="onPrevPage()"></span>';
break;case 2:b+='<input class="iui-pagination-panel-input" ng-model="currentPage" type="number" ng-attr-min="{{minPages}}" ng-attr-max="{{numPages}}" />';break;case 3:b+='<span class="iui-pagination-panel-label"> / {{numPages}}</span>';break;case 4:b+='<span class="iui-pagination-panel-button iui-pagination-next" ng-click="onNextPage()"></span>';break;case 5:b+='<span class="iui-pagination-panel-button iui-pagination-last" ng-click="onLastPage()"></span>'}b=c(b)(N);aa.append(b);q.append(aa);aa.css("width",
od+"px");b&&(g.getMargin(b[0]),k=g.getPadding(aa[0]),pd=b[0].offsetHeight+(k.top+k.bottom)-2,aa.css("height",pd+"px"));a.updatePaginationPanel()}};a.updatePaginationPanel=function(){var b=1;a.options.enabled||(b=.5);if(aa){var c=aa.find("span");if(c&&0<c.length)for(var h=0;h<c.length;h++){var e=angular.element(c[h]);e.css("opacity",b)}(c=aa.find("input"))&&0<c.length&&(e=angular.element(c[0]),a.options.enabled?e.removeAttr("disabled"):e.attr("disabled","true"))}};a.resetPageNumber=function(){a.currentPageNumber=
1;N&&(N.currentPage=0<N.numPages?1:0)};a.updatePageNumber=function(){a.currentPageNumber>a.pageList.length&&(0==a.pageList.length?a.resetPageNumber():(a.currentPageNumber=a.pageList.length,N&&(N.currentPage=a.currentPageNumber)))};var cb=angular.element('<div class="iui-grid-block" style="position:absolute;top:-9999999px"></div>'),sa=angular.element('<div class="iui-grid-block iui-grid-block-top" style="position:absolute;top:-9999999px"></div>'),Ha=angular.element('<div class="iui-grid-block iui-grid-block-bottom" style="position:absolute;top:-9999999px"></div>'),
db=angular.element('<div class="iui-grid-block iui-grid-block-left" style="position:absolute;top:-9999999px"></div>'),eb=angular.element('<div class="iui-grid-block iui-grid-block-right" style="position:absolute;top:-9999999px"></div>'),ze=function(){cb&&(cb.empty(),cb.remove());sa&&(sa.empty(),sa.remove());Ha&&(Ha.empty(),Ha.remove());db&&(db.empty(),db.remove());eb&&(eb.empty(),eb.remove())},yf=function(){if(1<a.updateStatus)T("end");else var b=f(function(){if(0<a.columnList.length&&1==a.updateStatus){var d=
0;a.options.grouping.enabled&&x&&(d=x[0].offsetHeight);z=p.$new();z.data=Ae();z.dataFooter=Be();a.refreshColumns();z.$apply();for(var h=L=A=0;h<a.columnList.length;h++){var e={columnID:void 0!=a.columnList[h][a.options.columnFields.id]?a.columnList[h][a.options.columnFields.id]:h,avgItemHeight:0};switch(a.columnList[h][a.options.columnFields.editorType]){case "combobox":kf(a.columnList[h].editorSettings,h,e);Nb.push(e);break;default:Nb.push(e)}}a.options.showHeader&&(q.append(sa),qa&&(Sa.css("opacity",
ra.opacity),sa.css("opacity",ra.opacity)),sa.css("top",d+"px"),sa.css("left","-9999999px"),d=kd(),ua=angular.element(c(d)(z)),sa.append(ua),a.isThereLeftFixedColumns&&(d=kd("left"),ia=c(d)(z),sa.append(ia),ia.css("z-index","2"),ia.addClass("iui-grid-column-header-left")),a.isThereRightFixedColumns&&(d=kd("right"),X=c(d)(z),sa.append(X),X.css("right","0"),X.css("z-index","1"),X.addClass("iui-grid-column-header-right")));a.options.showFooter&&(q.append(Ha),qa&&(Ua.css("opacity",ra.opacity),Ha.css("opacity",
ra.opacity)),Ha.css("left","-9999999px"),d=ld(),Za=c(d)(z),Ha.append(Za),a.isThereLeftFixedColumns&&(d=ld("left"),za=c(d)(z),Ha.append(za),za.css("z-index","2"),za.addClass("iui-grid-column-footer-left")),a.isThereRightFixedColumns&&(d=ld("right"),ha=c(d)(z),Ha.append(ha),ha.css("right","0"),ha.css("z-index","1"),ha.addClass("iui-grid-column-footer-right")));var g;d=-1;for(h=0;h<a.completeColumnList.length;h++)for(e=0;e<a.completeColumnList[h].length;e++){var l=a.completeColumnList[h][e].column;var m=
g=null;l[a.options.columnFields.templateSettings]&&a.getColumnTemplateUrl(l)?(g=l[a.options.columnFields.templateSettings].header,d=1):l[a.options.columnFields.headerContent]?(g=l[a.options.columnFields.headerContent],d=2):l[a.options.columnFields.headerTemplate]&&(g=l[a.options.columnFields.headerTemplate],d=3);l[a.options.columnFields.templateSettings]&&a.getColumnTemplateUrl(l,!0)?m=l[a.options.columnFields.templateSettings].footer:l[a.options.columnFields.footerContent]?m=l[a.options.columnFields.footerContent]:
l[a.options.columnFields.footerTemplate]&&(m=l[a.options.columnFields.footerTemplate]);if((g||m)&&(m=a.getElemFromColumnCell(l,l[a.options.columnFields.fixed]))&&g&&g&&(m=a.getChildElement(m,"column-header-cell")))switch(m.empty(),d){case 1:z&&(g='<iui-item-content obj="data['+h+"]["+e+"].column."+a.options.columnFields.templateSettings+'.header.templateObj" template-url="{{data['+h+"]["+e+"].column."+a.options.columnFields.templateSettings+'.header.url}}" draggable="{{data['+h+"]["+e+'].draggable}}"',
g+=' data-element="header-template-content" ng-cloak></iui-item-content>',m.append(c(g)(z)));break;case 2:m.append(c(g)(p.$parent));break;case 3:g='<div ng-include="'+g+'"',l[a.options.columnFields.headerTemplateModel]&&(g+=' onload="'+l[a.options.columnFields.headerTemplateModel]+'"'),g+=' style="margin:0;padding:0"></div>',m.append(c(g)(p.$parent))}}Va(40);T("rows")}else Va(70),T("scroll");f.cancel(b)},1)},zf=function(){for(var b=0,k="",h=topRowHeight=0;h<a.currentTopList.length;h++)k+=Ga(h,"none",
!1,"top"),b++;if(0<b){var e=angular.element('<table cellpadding="0" cellspacing="0" class="iui-grid-rows-top-block" style="position:absolute;top:-999999px;"></table>');e.append(c(k)(pa));Ca.append(e);f(function(){topRowHeight=e[0].offsetHeight;e.remove()},1)}},Af=function(){if(1<a.updateStatus)T("end");else var b=f(function(){if(0<a.columnList.length){var d=0;a.options.grouping.enabled&&x&&(d=x[0].offsetHeight);var h=0;a.options.paging.enabled&&aa&&(h=aa[0].offsetHeight);var e=0;if(a.options.showHeader&&
ua){A=ua[0].offsetHeight;a.isThereLeftFixedColumns&&ia&&A<ia[0].offsetHeight&&(A=ia[0].offsetHeight);a.isThereRightFixedColumns&&X&&A<X[0].offsetHeight&&(A=X[0].offsetHeight);A+=1;ua.css("height",A+"px");var g=0,l=ua.find("td");if(l&&0<l.length)for(var m=0;m<l.length;m++){var r=angular.element(l[m]);g+=r[0].offsetWidth}g>q[0].clientWidth&&(g=angular.element('<div class="iui-scrollbar-horizontal"><div class="iui-scroll-button-thumb-horizontal"></div></div>'),g.css("bottom","-9999px"),q.append(g),e=
g[0].offsetHeight,g.remove());sa.css("width",q[0].clientWidth+"px");sa.css("height",A+"px");a.isThereLeftFixedColumns&&(M=ia[0].offsetWidth,Ub=q[0].clientHeight-A-L,ua.css("left",M+"px"),ia.css("height",A+"px"));a.isThereRightFixedColumns&&(Ta=X[0].offsetWidth,Vb=q[0].clientHeight-A-L,X.css("height",A+"px"))}a.options.showFooter&&(L=Za[0].offsetHeight,a.isThereLeftFixedColumns&&za&&L<za[0].offsetHeight&&(L=za[0].offsetHeight),a.isThereRightFixedColumns&&ha&&L<ha[0].offsetHeight&&(L=ha[0].offsetHeight),
Ha.css("width",q[0].clientWidth+"px"),Ha.css("height",L+"px"),a.isThereLeftFixedColumns&&(M=za[0].offsetWidth,Ub=q[0].clientHeight-A-L,Za.css("left",M+"px"),za.css("height",L+"px")),a.isThereRightFixedColumns&&(Ta=ha[0].offsetWidth,Vb=q[0].clientHeight-A-L,ha.css("height",L+"px")));qd();if(0<a.currentList.length){v=p.$new();v.data=rd();pa=p.$new();pa.data=Ce();va=p.$new();va.data=De();a.refreshRows();v.$apply();pa.$apply();va.$apply();wf();zf();var t=f(function(){fe();oa&&oa.remove();ea&&ea.remove();
Y&&Y.remove();$a&&$a.remove();Aa&&Aa.remove();Ba&&Ba.remove();ab&&ab.remove();na&&na.remove();Na&&Na.remove();J=0;for(var b="",k=0;k<a.currentTopList.length;k++)b+=Ga(k,"none",!1,"top"),J++;0<J&&(ea=angular.element('<table cellpadding="0" cellspacing="0" class="iui-grid-rows-top-block" style="position:absolute;top:'+A+"px;left:"+M+'px;"></table>'),ea.append(c(b)(pa)),cb.append(ea));J=0;b="";for(k=0;k<a.currentBottomList.length;k++)b+=Ga(k,"none",!1,"bottom"),J++;0<J&&(Y=angular.element('<table cellpadding="0" cellspacing="0" class="iui-grid-rows-bottom-block" style="position:absolute;bottom:'+
L+"px;left:"+M+'px;"></table>'),Y.append(c(b)(va)),cb.append(Y));b=q[0].clientHeight-d-h-(A+L)-e;E=0<V?Math.floor(b/V)+1:0<A?Math.floor(b/A)+1:100;J=0;b="";for(k=0;k<E;k++)b+=Ga(k),J++;if(0<J){oa=angular.element('<table cellpadding="0" cellspacing="0" style="position:absolute;top:'+(A+topRowHeight)+"px;left:"+M+'px;"></table>');oa.append(c(b)(v));cb.append(oa);if(a.isThereLeftFixedColumns){b="";for(k=J=0;k<a.currentTopList.length;k++)b+=Ga(k,"left",!1,"top"),J++;0<J&&(Aa=angular.element('<table cellpadding="0" cellspacing="0" class="iui-grid-rows-top-block iui-grid-rows-left-top" style="position:absolute;top:0;"></table>'),
Aa.append(c(b)(pa)),db.append(Aa));b="";for(k=J=0;k<a.currentBottomList.length;k++)b+=Ga(k,"left",!1,"bottom"),J++;0<J&&(Ba=angular.element('<table cellpadding="0" cellspacing="0" class="iui-grid-rows-bottom-block iui-grid-rows-left-bottom" style="position:absolute;bottom:0;"></table>'),Ba.append(c(b)(va)),db.append(Ba));oa.css("left",M+"px");b="";for(k=J=0;k<E;k++)b+=Ga(k,"left"),J++;0<J&&($a=angular.element('<table class="iui-grid-rows-left" cellpadding="0" cellspacing="0" style="position:absolute;top:'+
topRowHeight+'px;"></table>'),$a.append(c(b)(v)),Oa.css("top",d+A+"px"),db.append($a),q.append(db),qa&&Oa.css("opacity",ra.opacity))}if(a.isThereRightFixedColumns){b="";for(k=J=0;k<a.currentTopList.length;k++)b+=Ga(k,"right",!1,"top"),J++;0<J&&(na=angular.element('<table cellpadding="0" cellspacing="0" class="iui-grid-rows-top-block iui-grid-rows-right-top" style="position:absolute;"></table>'),na.append(c(b)(pa)),eb.append(na));b="";for(k=J=0;k<a.currentBottomList.length;k++)b+=Ga(k,"right",!1,"bottom"),
J++;0<J&&(Na=angular.element('<table cellpadding="0" cellspacing="0" class="iui-grid-rows-bottom-block iui-grid-rows-right-bottom" style="position:absolute;bottom:0;"></table>'),Na.append(c(b)(va)),eb.append(Na));b="";for(k=J=0;k<E;k++)b+=Ga(k,"right"),J++;0<J&&(ab=angular.element('<table class="iui-grid-rows-right" cellpadding="0" cellspacing="0" style="position:absolute;top:'+topRowHeight+'px;"></table>'),ab.append(c(b)(v)),Fa.css("top",d+A+"px"),eb.append(ab),q.append(eb),qa&&Fa.css("opacity",
ra.opacity))}}Va(70);T("scroll");f.cancel(t)},5)}else Va(70),T("scroll")}else Va(70),T("scroll");f.cancel(b)},1)},Yb=function(b){b.dataTransfer?b.dataTransfer.dropEffect="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect="none");a.dropMark()},Bf=function(){if(1<a.updateStatus)T("end");else{if(1==a.updateStatus){ea&&ea.unbind("dragover");Y&&Y.unbind("dragover");Aa&&Aa.unbind("dragover");Ba&&Ba.unbind("dragover");na&&na.unbind("dragover");na&&na.unbind("dragover");
cb&&(Ca.empty(),Ca.append(cb.children()),ea&&ea.bind("dragover",function(a){Yb(a);a.stopPropagation()}),Y&&Y.bind("dragover",function(a){Yb(a);a.stopPropagation()}));if(sa){var b=0;a.options.grouping.enabled&&x&&(b=x[0].offsetHeight);Sa.css("top",b+"px");Sa.empty();Sa.append(sa.children());a.options.showHeader&&(Sa.css("width",q[0].clientWidth+"px"),Sa.css("height",A+"px"));q.append(Sa)}Ha&&(Ua.empty(),Ua.append(Ha.children()),a.options.showFooter&&(Ua.css("width",q[0].clientWidth+"px"),Ua.css("height",
L+"px")),q.append(Ua));db&&(Oa.empty(),Oa.append(db.children()),q.append(Oa),Aa&&Aa.bind("dragover",function(a){Yb(a);a.stopPropagation()}),Ba&&Ba.bind("dragover",function(a){Yb(a);a.stopPropagation()}));eb&&(Fa.empty(),Fa.append(eb.children()),q.append(Fa),na&&na.bind("dragover",function(a){Yb(a);a.stopPropagation()}),Na&&Na.bind("dragover",function(a){Yb(a);a.stopPropagation()}));a.updateViewSize();a.updateViewSize();a.updateScrollVisibility();a.updateScrollView()}Va(80,"complete");T("complete")}},
Cf=function(){switch(ra.type){case "circular":1==a.updateStatus&&(Ee(),Zb=0,xb=!0,a.callLoadComplete());break;case "linear":Fe(!1);break;default:Zb=0,xb=!0,1==a.updateStatus&&a.callLoadComplete()}a.updateActive=!1;a.updateStatus--;if(0<a.updateStatus)$b=a.updateActive=!0,1==a.updateStatus?T("start"):T("end");else if(sd())var b=f(function(){"optimal"==a.options.displayMode&&a.updateGridElements();a.updateView();a.callUpdateComplete();f.cancel(b)},1);else"optimal"==a.options.displayMode&&(a.updateGridElements(),
a.updateView()),a.callUpdateComplete()},nc=[],oc=[],pc=[],Oc=[],Pc=[],Qc=[],Rc=[],Sc=[],Tc=[],td=function(b,c,h){if((c=a.getRowElems(c,h))&&0<c.length)for(var d,k=0;k<c.length;k++){d=angular.element(c[k]);h={rowElem:d,cellList:[]};if(k<E){d=d.find("td");for(var e=0;e<d.length;e++){var f=angular.element(d[e]),g=a.getContentElement(f);if(g){var l=e;f[0].attributes&&f[0].attributes["data-index"]&&(l=parseInt(f[0].attributes["data-index"].value,10));f={cell:f,block:g,expandBox:null,icon:null,content:null};
l==a.options.expandColIndex&&(f.expandBox=angular.element(a.getContentElement(g,"expandbox")),f.icon=angular.element(a.getContentElement(g,"icon")));var m="content";switch(a.columnList[l][a.options.columnFields.editorType]){case "checkbox":m="checkbox";break;case "image":m="image";break;default:(l=ub(l))&&""!=l&&(m="template-content")}f.content=angular.element(a.getContentElement(g,m));h.cellList.push(f)}}}b.push(h)}};a.updateGridElements=function(){"optimal"==a.options.displayMode&&(a.updateGridScrollElements(),
a.updateGridFixedElementsTop(),a.updateGridFixedElementsBottom())};a.updateGridScrollElements=function(){var a=0,b="none";nc.length=0;oc.length=0;pc.length=0;for(var c=nc;3>a;)td(c,b),a++,1==a?(b="left",c=oc):(b="right",c=pc)};a.updateGridFixedElementsTop=function(){var a=0,b="none";Oc.length=0;Pc.length=0;Qc.length=0;for(var c=Oc;3>a;)td(c,b,"top"),a++,1==a?(b="left",c=Pc):(b="right",c=Qc)};a.updateGridFixedElementsBottom=function(){var a=0,b="none";Rc.length=0;Sc.length=0;Tc.length=0;for(var c=
Rc;3>a;)td(c,b,"bottom"),a++,1==a?(b="left",c=Sc):(b="right",c=Tc)};var T=function(b){if($b&&!Ib)switch(b){case "start":1<a.updateStatus?T("end"):(a.updateColumnList(),a.updateGroupList(),a.options.paging.enabled&&a.updatePageList(),a.updateCurrentList(),Va(10),T("init"));break;case "init":1<a.updateStatus?T("end"):(Nb.length=0,ae(),a.options.grouping.enabled&&vf(),Jc||ta||id(),ze(),Za=ua=Y=ea=oa=null,Ub=M=0,Ba=Aa=$a=ia=null,Vb=Ta=0,Na=na=ab=X=null,z&&z.$destroy(),v&&v.$destroy(),a.options.paging.enabled&&
xf(),q.append(cb),cb.css("left","-9999999px"),db.css("left","-9999999px"),eb.css("right","-9999999px"),Va(20),T("columns"));break;case "columns":yf();break;case "rows":sa?a.options.showHeader&&sa.find("td").length<a.columnList.length?f(function(){T(b)},1):Af():f(function(){T(b)},1);break;case "scroll":Bf();break;case "complete":1<a.updateStatus?T("end"):(ze(),Va(90),T("events"));break;case "events":1<a.updateStatus||(a.allowEvents=!0,a.options.showHeader&&(ua&&dd(ua),a.isThereLeftFixedColumns&&ia&&
dd(ia),a.isThereRightFixedColumns&&X&&dd(X)),0<a.currentList.length&&rf(),Va(100));T("end");break;case "end":Cf()}else f(function(){T(b)},1)},Ge=5,Uc=0,Jb=0,Vc=0,He=0,Ib=!1,Wc=!1,ra={type:"none",speed:"normal",opacity:0},ud=null,qa=!1,xb=!1,Fe=function(b){var d=l(function(){b?Jb++:Jb--;Vc=(q[0].clientHeight-Jb)/2+2;qc.css("height",Jb+"px");lb.css("top",Vc+"px");b&&Jb>=Ge?(qa=!0,Va(0),xb=Ib=!1,l.cancel(d)):!b&&0>=Jb&&(lb&&lb.remove(),Zb=0,xb=!0,a.callLoadComplete(),l.cancel(d))},20)},Ee=function(){ud&&
l.cancel(ud);fb&&fb.remove()};a.beginLoad=function(a){if(!Ib)switch(Ib=!0,ra=a?{type:void 0!=a.type?a.type:"none",speed:void 0!=a.speed?a.speed:"normal",opacity:void 0!=a.opacity?a.opacity:0}:{type:"none",speed:"normal",opacity:0},vd(ra.opacity),ra.type){case "circular":Ee();q.append(fb);fb.css("top",(q[0].clientHeight-fb[0].offsetHeight)/2+"px");fb.css("left",(q[0].clientWidth-fb[0].offsetWidth)/2+"px");qa=!0;xb=Ib=!1;var b=0,d=3;switch(ra.speed){case "veryfast":d=7;break;case "fast":d=5;break;case "slow":d=
2;break;case "veryslow":d=1}ud=l(function(){b+=d;360<b&&(b=0);var a="rotate("+b+"deg)";fb.css("-ms-transform",a);fb.css("-webkit-transform",a);fb.css("transform",a)},1);break;case "linear":a=angular.element('<div class="iui-load-block-progress" style="position:absolute;left:-9999px"></div>');q.append(a);Ge=parseInt(getComputedStyle(a[0]).height,10);a.remove();qc.css("width","0px");qc.css("height","0px");q.append(lb);Zb=0;Uc=Math.floor(.5*q[0].clientWidth);Jb=0;Vc=q[0].clientHeight/2+2;He=(q[0].clientWidth-
Uc)/2;lb.css("width",Uc+"px");lb.css("top",Vc+"px");lb.css("left",He+"px");lb.css("opacity","1");Fe(!0);break;default:qa=!0,xb=Ib=!1}};a.endLoad=function(){if(!Wc)if(Wc=!0,qa){qa=!1;var a=3,b=ra.opacity,c=l(function(){xb&&(10<a||1<=b?(vd(1),Wc=Ib=xb=!1,ra={type:"none",speed:"normal"},l.cancel(c)):(b+=a/10,vd(b),a+=3))},1)}else Wc=!1};var vd=function(a){x&&x.css("opacity",a);Sa&&Sa.css("opacity",a);Oa&&Oa.css("opacity",a);Ca&&Ca.css("opacity",a);Fa&&Fa.css("opacity",a);Ua&&Ua.css("opacity",a);aa&&
aa.css("opacity",a);F&&F.css("opacity",a);Q&&Q.css("opacity",a);hb&&hb.css("opacity",a)},qc=angular.element('<div class="iui-load-block-progress"></div>'),lb=angular.element('<div class="iui-load-block"></div>');lb.append(qc);var Zb=0,$b=!1,fb=angular.element('<div class="iui-load-circular"></div>'),Va=function(a){if(qa&&"linear"==ra.type){$b=!1;var b=Math.floor(Uc*a/100),d=Zb;a=10;switch(ra.speed){case "veryfast":a=2;break;case "fast":a=5;break;case "slow":a=15;break;case "veryslow":a=20}var c=b>
d?Math.floor((b-d)/a):1;c=0<c?c:1;var e=l(function(){d+=c;qc.css("width",d+"px");d>=b&&(Zb=b,$b=!0,l.cancel(e))},1)}else $b=!0};a.updateStatus=0;a.updateActive=!1;a.updateLayout=function(b){q.append(O.$tw);O.s1t(O.twp);b=!0;for(var d=q.parent();"body"!=d[0].tagName.toLowerCase();){if("none"==getComputedStyle(d[0]).display){b=!1;break}d=d.parent()}b&&a.allowUpdate&&(a.updateStatus++,a.updateActive||(a.updateActive=!0,a.allowEvents=!1,q.removeClass("iui-grid-block-rtl"),a.options.rtl&&q.addClass("iui-grid-block-rtl"),
Ca.removeClass("iui-grid-block-shift-left iui-grid-block-rtl"),Ca.addClass(cd()),V=0,E=100,L=A=0,$b=!0,T("start")))};a.updateCurrentLayout=function(b){if(a.allowUpdate)if(0==a.currentList.length)a.updateLayout();else{a.updateGroupList();a.options.paging.enabled&&(a.updatePageList(),N&&(N.minPages=0<a.pageList.length?1:0,N.numPages=a.pageList.length),a.updatePageNumber());a.updateCurrentList();a.updateView();var d=f(function(){a.updateViewSize();a.updateViewSize();b&&a.updateScrollVisibility();a.updateScrollView();
f.cancel(d)},1)}};var Ie=function(b){var d={top:0,right:0,bottom:0,left:0};(b=a.getElemFromColumnCell(b))&&(b=a.getChildElement(b,"column-header-cell"))&&(d=g.getPadding(b[0]));return d},Je=function(b){var d=b[a.options.columnFields.columns];if(!d||0==d.length)return d=a.getColumnWidth(b),d=0<=d?d:0,b=wd(b),d<b.min&&(d=b.min),d>b.max&&(d=b.max),d;for(var c,e=0,f=0;f<d.length;f++)a.isColumnWithChildenVisible(d[f])&&(c=Ie(d[f]),e+=Je(d[f])+c.left+c.right);c=Ie(b);return e-=c.left+c.right},Ke=function(b,
c){var d=b?b.column:c;return{draggable:b?b.isRoot&&a.options.enabled&&a.options.allowColumnReorder&&b.column[a.options.columnFields.allowDrag]:!1,headerAlignment:d[a.options.columnFields.headerAlignment],footerAlignment:d[a.options.columnFields.footerAlignment],index:a.columnList?a.columnList.indexOf(d):-1,indent:0,column:d,showFiltering:a.isFilteringAllowed(d),showSorting:a.isSortingAllowed()&&d==a.sortColumn,style:{header:{},footer:{}},width:Je(d)}},Le=function(b,c){var d=0;if(c==a.options.expandColIndex){var e=
a.columnList[a.options.expandColIndex];d=a.getColumnWidth(e);var k=d-a.indentList[b];k=0<=k?k:0;var f={top:0,right:0,bottom:0,left:0};(e=a.getElemFromColumn(e,e[a.options.columnFields.fixed]))&&(e=a.getChildElement(e,"column-header-cell"))&&(f=g.getPadding(e[0]));f=f.left+a.indentList[b];0==k&&(f=d);d=f}return d},xd=function(b,c,h){var d=c;h&&(h=a.columnList[c][a.options.columnFields.id])&&(d=a.getCellIndexById(a.currentList[b][a.options.rowFields.cells],c,h));return d},Me=function(b){return a.columnList[b][a.options.columnFields.contentAlignment]?
a.columnList[b][a.options.columnFields.contentAlignment]:"left"},Ne=function(b,c){var d=a.columnList[c],e=a.getColumnWidth(d);d=wd(d);e<d.min&&(e=d.min);e>d.max&&(e=d.max);c==a.options.expandColIndex&&(e-=a.indentList[b]);return 0<=e?e:0},yd=function(b,c){return 1==a.options.allowFocus&&1==a.options.allowCellFocus&&a.isRowEnabled(a.currentList[b])&&0<=c?a.getTabIndex().toString()+(b+1).toString()+c.toString():""},Oe=function(b){return 1==a.options.allowFocus&&0==a.options.allowCellFocus&&a.isRowEnabled(a.currentList[b])?
a.getTabIndex().toString()+(b+1).toString():""},Pe=function(b,c,h){if(0<=c){var d=a.currentList[b][a.options.rowFields.cells];switch(h){case "top":d=a.currentTopList[b][a.options.rowFields.cells];break;case "bottom":d=a.currentBottomList[b][a.options.rowFields.cells]}if(c<d.length)return d[c]}return{}},ub=function(b){return a.columnList[b][a.options.columnFields.cellTemplateUrl]?a.columnList[b][a.options.columnFields.cellTemplateUrl]:""},zd=function(b,c,h,e){for(var d=[],k=0;k<a.columnList.length;k++){var f=
xd(c,k,h),n=h?Pe(c,f,e):{},g=Me(k),l=a.columnList[k][a.options.columnFields.editorSettings];l=l&&l.style?l.style:null;if(h)a:{if(0<=f){var m=a.currentList[c][a.options.rowFields.cells];if(f<m.length){m=1==a.options.enabled&&m[f][a.options.cellFields.enabled];break a}}m=1==a.options.enabled}else m=!1;var p=h?Le(c,k):0,q=f,r=h?yd(c,k):"",t=ub(k);if(h){var u=c;var v=f;var w=ub(k);u=Pe(u,v);v=0<=v&&w&&""!=w&&u&&void 0!=u[a.options.cellFields.templateObj]&&null!=u[a.options.cellFields.templateObj]?!0:
!1}else v=!1;if(h)a:{if(0<=f&&(w=a.currentList[c][a.options.rowFields.cells],f<w.length)){w=w[f][a.options.cellFields.text];break a}w=""}else w="";if(h)a:{if(0<=f&&(u=a.currentList[c][a.options.rowFields.cells],f<u.length)){u=u[f][a.options.cellFields.value];break a}u=null}else u=null;f={related:n,alignment:g,editorStyle:l,enabled:m,indent:p,index:q,style:{},tabindex:r,templateUrl:t,templateVisible:v,text:w,value:u,visible:h?0<=f?!0:!1:!1,width:h?Ne(c,k):0};d.push(f)}return{cells:d,expandBox:h?be(b):
"",expandBoxVisible:h&&!e?0!=a.options.showExpandBoxes:!1,draggable:h&&!e?a.isRowEnabled(b)&&a.isDragAllowed(b):!1,icon:h?te(b):"",iconVisible:h?0!=a.options.showIcons&&hd(b):!1,index:c,row:h?b:{},style:{},tabindex:h&&!e?Oe(c):"",updateContextMenu:h?null!=b[a.options.rowFields.contextMenu]:!1,visible:h}},Ae=function(){for(var b=[],c=0;c<a.completeColumnList.length;c++){b.push([]);for(var h=0;h<a.completeColumnList[c].length;h++)b[c].push(Ke(a.completeColumnList[c][h]))}return b},Be=function(){for(var b=
[],c=0;c<a.columnList.length;c++)b.push(Ke(null,a.columnList[c]));return b},rd=function(){for(var b=[],c=w;c<w+E;c++)b.push(zd(a.currentList[c],c,c<a.currentList.length));return b},Ce=function(){for(var b=[],c=0;c<a.currentTopList.length;c++)b.push(zd(a.currentTopList[c],c,c<a.currentTopList.length,"top"));return b},De=function(){for(var b=[],c=0;c<a.currentBottomList.length;c++)b.push(zd(a.currentBottomList[c],c,c<a.currentBottomList.length,"bottom"));return b},qd=function(){for(var b=0;b<a.columnList.length;b++)if(a.isFilteringAllowed(a.columnList[b])){var c=
a.getElemFromColumn(a.columnList[b],a.columnList[b][a.options.columnFields.fixed]);c&&(c=a.getChildElement(c,"column-header-cell"))&&(c=a.getContentElement(c,"filter-button"))&&(c.css("top",(A-parseInt(getComputedStyle(c[0]).height,10))/2-1+"px"),c.css("right","2px"))}a.isSortingAllowed()&&a.sortColumn&&(b=a.getElemFromColumn(a.sortColumn,a.sortColumn[a.options.columnFields.fixed]))&&(c=a.getChildElement(b,"column-header-cell"))&&(c=a.getContentElement(c,"sort-button"))&&(c.css("top",(A-parseInt(getComputedStyle(c[0]).height,
10))/2-1+"px"),a.isFilteringAllowed(a.sortColumn)?c.css("right","22px"):c.css("right","2px"))};a.getRowScope=function(){return v};var Re=function(){a.allowEvents=!1;if(z&&0<a.columnList.length)if(z.data=Ae(),z.dataFooter=Be(),v){if(Ad(!1),v.data=rd(),pa&&(pa.data=Ce()),va&&(va.data=De()),a.options.selectedRow&&!a.isRowEnabled(a.options.selectedRow)&&(a.options.selectedRow[a.options.rowFields.selected]=!1,a.options.selectedRow=null,a.updateSelectionList()),a.refresh(null,null,!1),z.$apply(),v.$apply(),
pa&&pa.$apply(),va&&va.$apply(),qd(),0>=a.options.rowHeight&&sd())for(var b=w;0<=b&&b<w+E&&b<a.currentList.length;b++)Qe(a.currentList[b])}else a.refresh(null,null,!1),z.$apply(),qd();a.allowEvents=!0},Bd=function(b,c){var d=0;if(b&&v){var e=a.getElemFromRow(b,c);e&&(d=e[0].offsetHeight)}return d},sd=function(){for(var b=!1,c=0;c<a.columnList.length;c++){var h=ub(c);if(h&&""!=h){b=!0;break}}return b},Cd=function(b,c,h){for(var d=0,e="none";3>d;){if((e=a.getElemFromRow(b,c,e))&&(e=e.find("td"))&&0<
e.length)for(var k=0;k<e.length;k++){var f=angular.element(e[k]);f=a.getContentElement(f);var l=g.getBorderWidth(f[0]),m=g.getPadding(f[0]);f&&f.css("height",h-(l.top+l.bottom)-(m.top+m.bottom)-2.85+"px")}d++;e=1==d?"top":"bottom"}},Dd=function(b,c){for(var d=0,e="none";3>d;){if((e=a.getElemFromRow(b,c,e))&&(e=e.find("td"))&&0<e.length)for(var k=0;k<e.length;k++){var f=angular.element(e[k]);(f=a.getContentElement(f))&&f.css("height","auto")}d++;e=1==d?"top":"bottom"}},Qe=function(a){Dd(a,"none");
Dd(a,"left");Dd(a,"right");var b=Bd(a),d=Bd(a,"left"),c=Bd(a,"right");b=Math.max(Math.max(b,d),c);Cd(a,"none",b);Cd(a,"left",b);Cd(a,"right",b)};a.updateView=function(b,c){if(b)Re(),a.updateCurrentView(c);else var d=f(function(){Re();a.updateCurrentView(c);f.cancel(d)},1)};a.updateVerticalScrollView=function(){if(v&&(a.allowEvents=!1,Ad(!1),v.data=rd(),a.refresh(null,null,!1,!0),v.$apply(),a.updateCurrentView(!0),a.allowEvents=!0,0>=a.options.rowHeight&&sd()&&(a.isThereLeftFixedColumns||a.isThereRightFixedColumns)))for(var b=
w;0<=b&&b<w+E&&b<a.currentList.length;b++)Qe(a.currentList[b])};var Ed=function(b,c,e,f){f=0;var d=a.columnList.length,h=0;if("none"==c&&e)for(f=kc,d=lc,e=0;e<f&&e<a.columnList.length;e++)a.isColumnFixed(a.columnList[e])||h++;if(b&&0<b.length)for(e=0;e<b.length;e++)if(e<E&&e<a.currentList.length&&e+w<a.currentList.length){var k=a.currentList[e+w];b[e].rowElem&&(b[e].rowElem.attr("data-index",e+w),b[e].rowElem.attr("tabindex",Oe(e+w)));for(var g=h,n=f;n<=d&&n<a.columnList.length;n++){var l=a.columnList[n][a.options.columnFields.fixed]?
a.columnList[n][a.options.columnFields.fixed]:"none";if(l==c&&g<b[e].cellList.length){b[e].cellList[g].block.css("width",Ne(e+w,n)+"px");b[e].cellList[g].block.css("text-align",Me(n));b[e].cellList[g].block.css("opacity",1);b[e].cellList[g].cell.attr("draggable",a.isRowEnabled(k)&&a.isDragAllowed(k));b[e].cellList[g].cell.attr("tabindex",yd(e+w,n));l="";var m=xd(e+w,n,!0);0<=m&&m<a.currentList[e+w][a.options.rowFields.cells].length&&(n==a.options.expandColIndex&&(0<a.groups.length&&b[e].cellList[g].block.css("padding-left",
Le(e+w,n)+"px"),b[e].cellList[g].expandBox&&(b[e].cellList[g].expandBox.removeAttr("class"),b[e].cellList[g].expandBox.addClass(be(k))),b[e].cellList[g].icon&&(b[e].cellList[g].icon.removeAttr("class"),b[e].cellList[g].icon.addClass(te(k)))),l=k[a.options.rowFields.cells][m][a.options.cellFields.text],"combobox"==a.columnList[n][a.options.columnFields.editorType]&&(l=k[a.options.rowFields.cells][m][a.options.cellFields.value]?k[a.options.rowFields.cells][m][a.options.cellFields.value].text:""));if(b[e].cellList[g].content)switch(a.columnList[n][a.options.columnFields.editorType]){case "checkbox":break;
case "image":break;default:(m=ub(n))&&""!=m||b[e].cellList[g].content.text(l)}g++}}}else for(b[e].rowElem&&(b[e].rowElem.attr("data-index",e+w),b[e].rowElem.attr("tabindex","")),g=h,n=f;n<=d&&n<a.columnList.length;n++)if(l=a.columnList[n][a.options.columnFields.fixed]?a.columnList[n][a.options.columnFields.fixed]:"none",l==c&&g<b[e].cellList.length){m=n;b[e].cellList[g].block.css("width","0px");b[e].cellList[g].cell.attr("draggable",!1);b[e].cellList[g].cell.attr("tabindex","");m==a.options.expandColIndex&&
(0<a.groups.length&&b[e].cellList[g].block.css("padding-left","0px"),b[e].cellList[g].expandBox&&b[e].cellList[g].expandBox.removeAttr("class"),b[e].cellList[g].icon&&b[e].cellList[g].icon.removeAttr("class"));if(b[e].cellList[g].content){switch(a.columnList[m][a.options.columnFields.editorType]){case "checkbox":break;case "image":break;default:(m=ub(n))&&""!=m||b[e].cellList[g].content.html("")}b[e].cellList[g].content.attr("draggable",!1);b[e].cellList[g].content.attr("tabindex",yd(e+w,n))}g++}};
a.updateCurrentView=function(b){"optimal"==a.options.displayMode&&(a.updateCurrentGridScrollElements(),a.updateCurrentGridFixedElementsTop(),a.updateCurrentGridFixedElementsBottom())};a.updateCurrentGridScrollElements=function(b){if("optimal"==a.options.displayMode)for(var c=0,d="none",e=nc;3>c;)Ed(e,d,b),c++,1==c?(d="left",e=oc):(d="right",e=pc)};a.updateCurrentGridFixedElementsTop=function(b){if("optimal"==a.options.displayMode)for(var c=0,d="none",e=Oc;3>c;)Ed(e,d,b,"top"),c++,1==c?(d="left",e=
Pc):(d="right",e=Qc)};a.updateCurrentGridFixedElementsBottom=function(b){if("optimal"==a.options.displayMode)for(var c=0,d="none",e=Rc;3>c;)Ed(e,d,b,"bottom"),c++,1==c?(d="left",e=Sc):(d="right",e=Tc)};var rc=function(b,c,e,f){var d={cell:"",content:"",general:"",label:"",custom:""};switch(e){case "column":f?(e=a.defaultStyle.column.footer.normal,a.options.controlStyle.column.footer.normal!=e&&(e+=" "+a.options.controlStyle.column.footer.normal),d.general=e,d.cell="iui-grid-column-footer-cell",e=
a.defaultStyle.column.footer.content,a.options.controlStyle.column.footer.content!=e&&(e+=" "+a.options.controlStyle.column.footer.content)):(e=a.defaultStyle.column.header.normal,a.options.controlStyle.column.header.normal!=e&&(e+=" "+a.options.controlStyle.column.header.normal),d.general=e,d.cell="iui-grid-column-header-cell",e=a.defaultStyle.column.header.content,a.options.controlStyle.column.header.content!=e&&(e+=" "+a.options.controlStyle.column.header.content));d.content=e;break;case "row":e=
a.defaultStyle.row.general.normal;a.isRowFixed(b)?(e=a.defaultStyle.row.fixed.normal,a.options.controlStyle.row.fixed.normal!=e&&(e+=" "+a.options.controlStyle.row.fixed.normal)):a.options.controlStyle.row.general.normal!=e&&(e+=" "+a.options.controlStyle.row.general.normal);d.general=e;break;case "cell":e=a.defaultStyle.row.cell.normal;a.options.controlStyle.row.cell.normal!=e&&(e+=" "+a.options.controlStyle.row.cell.normal);switch(a.options.gridLines){case "none":e=c==w+E-1||c==a.currentList.length-
1?e+" iui-grid-lines-horizontal":e+" iui-grid-lines-none";break;case "horizontal":e+=" iui-grid-lines-horizontal";break;case "vertical":e=c==w+E-1||c==a.currentList.length-1?e+" iui-grid-lines-both":e+" iui-grid-lines-vertical";break;default:e+=" iui-grid-lines-both"}d.general=e;e=a.defaultStyle.row.cell.content;a.options.controlStyle.row.cell.content!=e&&(e+=" "+a.options.controlStyle.row.cell.content);d.content=e;d.label=a.getDefaultCellLabelClass()}return d},Se=function(b){var c="";a.isFilteringAllowed(b)&&
(b=a.getObjState(b),c="iui-filtering","selected"==b?c+=" iui-filtering-selected":"hovered"==b&&(c+=" iui-filtering-hovered"));return c},Te=function(b){var c="";a.isSortingAllowed()&&b==a.sortColumn&&(b=a.getObjState(b),"ascending"==a.options.sorting?(c="iui-sort-ascending","selected"==b?c+=" iui-sort-ascending-selected":"hovered"==b&&(c+=" iui-sort-ascending-hovered")):(c="iui-sort-descending","selected"==b?c+=" iui-sort-descending-selected":"hovered"==b&&(c+=" iui-sort-descending-hovered")));return c},
Pa=function(b,c,e,f){var d=a.getObjState(b),h=a.getObjState(c);e=rc(b,e,b.type,f);switch(b.type){case "column":f?(d=a.getCurrentColumnStyle(b,"footer",d),d!=a.options.controlStyle.column.footer.normal&&(e.general+=" "+d),f=a.getCurrentColumnStyle(b,"footer","content"),f!=a.options.controlStyle.column.footer.content&&(e.content+=" "+f)):(d=a.getCurrentColumnStyle(b,"header",d),d!=a.options.controlStyle.column.header.normal&&(e.general+=" "+d),f=a.getCurrentColumnStyle(b,"header","content"),f!=a.options.controlStyle.column.header.content&&
(e.content+=" "+f));break;case "group":h=a.getCurrentRowStyle(b,d);h!=a.options.controlStyle.row.general.normal&&(e.general+=" "+h);break;case "row":h=a.getCurrentRowStyle(b,d);a.isRowFixed(b)?h!=a.options.controlStyle.row.fixed.normal&&(e.general+=" "+h):h!=a.options.controlStyle.row.general.normal&&(e.general+=" "+h);if((b=a.getCurrentRowStyle(b))&&b.custom)switch(d){case "disabled":e.custom=g.isFieldAvailable(b.custom.disabled,"");break;case "focused":e.custom=g.isFieldAvailable(b.custom.focused,
"");break;case "hovered":e.custom=g.isFieldAvailable(b.custom.hovered,"");break;case "selected":e.custom=g.isFieldAvailable(b.custom.selected,"");break;default:e.custom=g.isFieldAvailable(b.custom.normal,"")}break;case "cell":if(f=a.getCurrentCellStyle(c,b,d),f!=a.options.controlStyle.row.cell.normal&&(e.general+=" "+f),f=a.getCurrentCellStyle(c,b,"content"),f!=a.options.controlStyle.row.cell.content&&(e.content+=" "+f),(b=a.getCurrentCellStyle(c,b))&&b.custom)switch(h){case "disabled":e.custom=g.isFieldAvailable(b.custom.disabled,
"");break;case "selected":e.custom=g.isFieldAvailable(b.custom.selected,"");break;default:switch(d){case "disabled":e.custom=g.isFieldAvailable(b.custom.disabled,"");break;case "focused":e.custom=g.isFieldAvailable(b.custom.focused,"");break;case "hovered":e.custom=g.isFieldAvailable(b.custom.hovered,"");break;case "selected":e.custom=g.isFieldAvailable(b.custom.selected,"");break;default:e.custom=g.isFieldAvailable(b.custom.normal,"")}}}return e},mb=function(a,b,c,e){var d=v;switch(e){case "top":d=
pa;break;case "bottom":d=va}d&&(d.data[a].cells[b].style.cell=c.general,d.data[a].cells[b].style.content=c.content,d.data[a].cells[b].style.label=c.label,d.data[a].cells[b].style.custom=c.custom)},Ue=function(b){if(v&&(b-=w,0<=b&&b<v.data.length&&v.data[b].visible)){v.data[b].style=a.defaultStyle.row.general.normal;for(var c=0;c<a.columnList.length;c++)v.data[b].cells[c].style.cell=a.defaultStyle.row.cell.normal+" iui-grid-cell-empty"}};a.refreshColumns=function(){for(var b=0;b<a.completeColumnList.length;b++)for(var c=
0;c<a.completeColumnList[b].length;c++)a.refresh(a.completeColumnList[b][c].column,null,!1)};a.refreshRows=function(){for(var b=w;b<w+E;b++)b<a.currentList.length?a.refresh(a.currentList[b],null,!1):Ue(b);for(b=0;b<a.currentTopList.length;b++)a.refresh(a.currentTopList[b],null,!1);for(b=0;b<a.currentBottomList.length;b++)a.refresh(a.currentBottomList[b],null,!1)};var Ve=function(b,c,e,f,g){if(e&&b[a.options.rowFields.fixed]==f&&(c=c.indexOf(b),0<=c&&c<e.data.length&&e.data[c].visible)){e.data[c].style=
Pa(b);for(var d=rc(b,c,"cell"),h=0;h<a.columnList.length&&h<e.data[c].cells.length;h++){var k=e.data[c].cells[h].index;if(0<=k){var n=b[a.options.rowFields.cells];k<n.length?(k=Pa(n[k],b,c),mb(c,h,k,f)):mb(c,h,d,f)}else mb(c,h,d,f)}void 0==g&&e&&e.$apply()}};a.refreshHover=function(b){"optimal"==a.options.displayMode?a.refresh(b,null,null,!0):a.refresh(b)};a.refresh=function(b,c,e,f){"optimal"==a.options.displayMode?a.refreshOptimal(b,c,e,f):a.refreshNormal(b,c,e)};var We=function(a){for(var b=null,
c=0;c<z.data.length;c++){for(var d=0;d<z.data[c].length;d++)if(z.data[c][d].column==a){b=z.data[c][d];break}if(b)break}return b};a.refreshNormal=function(b,c,e){if(b)switch(b.type){case "column":z&&(1==a.options.showHeader&&(c=We(b))&&(c.style.header=Pa(b),c.style.filtering=Se(b),c.style.sorting=Te(b)),1==a.options.showFooter&&(c=a.getColumnCurrentIndex(b),0<=c&&c<z.dataFooter.length&&(z.dataFooter[c].style.footer=Pa(b,null,-1,!0))),void 0==e&&z&&z.$apply());break;case "group":if(v){var d=a.getRowCurrentIndex(b),
h=d-w;if(0<=h&&h<v.data.length&&v.data[h].visible){v.data[h].style=Pa(b);var k=rc(b,d,"cell");for(c=0;c<a.columnList.length&&c<v.data[h].cells.length;c++){var f=v.data[h].cells[c].index;if(0<=f){var g=b[a.options.rowFields.cells];f<g.length?(f=Pa(g[f],b,d),mb(h,c,f)):mb(h,c,k)}else mb(h,c,k)}void 0==e&&v&&v.$apply()}}break;case "row":if(v&&!a.isRowFixed(b)&&(d=a.getRowCurrentIndex(b),h=d-w,0<=h&&h<v.data.length&&v.data[h].visible)){v.data[h].style=Pa(b);k=rc(b,d,"cell");for(c=0;c<a.columnList.length&&
c<v.data[h].cells.length;c++)f=v.data[h].cells[c].index,0<=f?(g=b[a.options.rowFields.cells],f<g.length?(f=Pa(g[f],b,d),mb(h,c,f)):mb(h,c,k)):mb(h,c,k);void 0==e&&v&&v.$apply()}Ve(b,a.currentTopList,pa,"top",e);Ve(b,a.currentBottomList,va,"bottom",e)}else{for(b=0;b<a.completeColumnList.length;b++)for(c=0;c<a.completeColumnList[b].length;c++)a.refresh(a.completeColumnList[b][c].column,null,!1);for(b=w;b<w+E;b++)b<a.currentList.length?a.refresh(a.currentList[b],null,!1):Ue(b);1==e&&v&&v.$apply();for(b=
0;b<a.currentTopList.length;b++)a.refresh(a.currentTopList[b],null,!1);1==e&&pa&&pa.$apply();for(b=0;b<a.currentBottomList.length;b++)a.refresh(a.currentBottomList[b],null,!1);1==e&&va&&va.$apply()}};a.refreshOptimal=function(b,c,e,f){if(b)switch(b.type){case "column":z&&(1==a.options.showHeader&&(c=We(b))&&(c.style.header=Pa(b),c.style.filtering=Se(b),c.style.sorting=Te(b)),1==a.options.showFooter&&(c=a.getColumnCurrentIndex(b),0<=c&&c<z.dataFooter.length&&(z.dataFooter[c].style.footer=Pa(b,null,
-1,!0))),void 0==e&&z&&z.$apply());break;case "row":a.refreshCurrentView(b,f)}else{for(b=0;b<a.completeColumnList.length;b++)for(e=0;e<a.completeColumnList[b].length;e++)a.refresh(a.completeColumnList[b][e].column,null,!1);for(b=w;b<w+E;b++)b<a.currentList.length?a.refreshCurrentView(a.currentList[b]):Xe(b-w);for(b=0;b<a.currentTopList.length;b++)a.refreshCurrentView(a.currentTopList[b],!0);for(b=0;b<a.currentBottomList.length;b++)a.refreshCurrentView(a.currentBottomList[b],!0)}};var Xe=function(b,
c){for(var d=0,e="none",f=nc;3>d;){var k=b,g=0,l=a.columnList.length,m=0;if("none"==e&&c){g=kc;l=lc;for(var p=0;p<g&&p<a.columnList.length;p++)a.isColumnFixed(a.columnList[p])||m++}if(f&&0<f.length&&0<=k&&k<f.length&&v)for(sc(f[k].rowElem,{general:a.defaultStyle.row.general.normal});g<=l&&g<a.columnList.length;g++)(a.columnList[g][a.options.columnFields.fixed]?a.columnList[g][a.options.columnFields.fixed]:"none")==e&&m<f[k].cellList.length&&(sc(f[k].cellList[m].cell,{general:a.defaultStyle.row.cell.normal+
" iui-grid-cell-empty"}),m++);d++;1==d?(e="left",f=oc):(e="right",f=pc)}},sc=function(a,b){a&&(a.removeAttr("class"),a.addClass(b.general),a.removeAttr("style"),""!=b.custom&&a.attr("style",b.custom))};a.refreshCurrentView=function(b,c){if(b)switch(b[a.options.rowFields.fixed]){case "top":a.refreshCurrentFixedViewTop(b,c);break;case "bottom":a.refreshCurrentFixedViewBottom(b,c);break;default:a.refreshCurrentScrollView(b,c)}};a.refreshCurrentScrollView=function(a,b){for(var c=0,d="none",e=nc;3>c;)Fd(a,
e,d,b),c++,1==c?(d="left",e=oc):(d="right",e=pc)};a.refreshCurrentFixedViewTop=function(a,b){for(var c=0,d="none",e=Oc;3>c;)Fd(a,e,d,b,"top"),c++,1==c?(d="left",e=Pc):(d="right",e=Qc)};a.refreshCurrentFixedViewBottom=function(a,b){for(var c=0,d="none",e=Rc;3>c;)Fd(a,e,d,b,"bottom"),c++,1==c?(d="left",e=Sc):(d="right",e=Tc)};var Ye=function(b,c,e,f,g){if(v&&c&&0<c.length){var d=v,h=a.getRowCurrentIndex(b),k=h-w,l=a.currentList;switch(g){case "top":d=pa;k=h;l=a.currentTopList;break;case "bottom":d=
va,k=h,l=a.currentBottomList}if(0<=k&&k<c.length&&k<d.data.length&&d.data[k].visible){sc(c[k].rowElem,Pa(b));d=0;g=a.columnList.length;var n=0;if("none"==e&&f)for(d=kc,g=lc,f=0;f<d&&f<a.columnList.length;f++)a.isColumnFixed(a.columnList[f])||n++;for(f=n;d<=g&&d<a.columnList.length;d++)(a.columnList[d][a.options.columnFields.fixed]?a.columnList[d][a.options.columnFields.fixed]:"none")==e&&f<c[k].cellList.length&&(n=xd(h,d,!0),0<=n&&n<l[h][a.options.rowFields.cells].length?sc(c[k].cellList[f].cell,
Pa(l[h][a.options.rowFields.cells][n],b,h)):sc(c[k].cellList[f].cell,rc(b,h,"cell")),f++)}}},Fd=function(b,c,e,f,g){if(b)switch(b.type){case "group":Ye(b,c,e,f);break;case "row":Ye(b,c,e,f,g)}else{for(b=w;b<w+E;b++)b<a.currentList.length?a.refreshCurrentView(a.currentList[b],!0):Xe(b,!0);for(b=0;b<a.currentTopList.length;b++)a.refreshCurrentView(a.currentTopList[b],!0);for(b=0;b<a.currentBottomList.length;b++)a.refreshCurrentView(a.currentBottomList[b],!0)}};a.moveColumn=function(b,c){if(b&&0!=a.callColumnPosChanging(b)){var d=
a.columnsObj.getParent(b);d=a.columnsObj.getList(d);var e=d.indexOf(b),f=-1;if(d){switch(c){case "first":f=0;break;case "left":var k=Ec(b,b[a.options.columnFields.fixed],!0);k&&(k=d.indexOf(k),0<=k&&(f=k));break;case "right":if(k=Fc(b,b[a.options.columnFields.fixed],!0))k=d.indexOf(k),0<=k&&(f=k);break;case "last":f=d.length-1}0<=f&&f<d.length&&(e<f?("first"==c||"left"==c)&&f--:e>f&&("last"==c||"right"==c)&&f++,a.moveObject(e,f,d),a.updateLayout(),a.callColumnPosChanged(y,a.hoverColumn))}}};a.moveRow=
function(b,c,e,f){if(b){a.allowUpdate=!1;var d=-1;switch(e){case "first":d=0;break;case "at":d=f}if(Array.isArray(b)){f=[];for(var h=0;h<b.length;h++){for(var k=!1,g=a.getParent(b[h]);g;){if(0<=b.indexOf(g)){k=!0;break}g=a.getParent(g)}k||f.push(b[h])}if(0<f.length)if(b=a.getObjCurrentIndex(f[0]),h=a.getObjCurrentIndex(f[f.length-1]),b<=h)for(h=0;h<f.length;h++)Gd(f[h],c,d,e);else for(h=f.length-1;0<=h;h--)Gd(f[h],c,d,e)}else Gd(b,c,d,e);a.allowUpdate=!0;a.updateCurrentLayout();a.callChange()}};var Gd=
function(b,c,e,f){a.rowsObj.removeAt(b,-1,null,a.objIsRemoved)&&("first"==f||"last"==f||"at"==f?a.rowsObj.insertAt(b,e,c,a.rowIsAdded):"before"==f?a.rowsObj.insertByRef(b,c,!1,a.rowIsAdded):"after"==f&&a.rowsObj.insertByRef(b,c,!0,a.rowIsAdded))},Ya="none",da=!1,yb=null;Ya="none";var Xc=0,Hd=0,ib=null;p.$watch(function(){return q[0].offsetWidth},function(b,c){a.options.autoUpdate&&(100==E?a.updateLayout():b!=c&&(ib&&(f.cancel(ib),ib=null),ib=f(function(){Sa&&Sa.css("width",q[0].clientWidth+"px");
Ua&&Ua.css("width",q[0].clientWidth+"px");a.updateCurrentLayout();f.cancel(ib);ib=null},250)))});var jb=null;p.$watch(function(){return q[0].offsetHeight},function(b,c){a.options.autoUpdate&&b!=c&&(a.options.autoSize?a.updateCurrentLayout():(jb&&(f.cancel(jb),jb=null),jb=f(function(){a.updateLayout();f.cancel(jb);jb=null},250)))});a.isColumnWithFixedWidth=function(b){return b&&b[a.options.columnFields.fixedWidth]?b[a.options.columnFields.fixedWidth]:!1};a.setColumnResizingParams=function(b,c,e){b&&
(yb=b,Ya=c,Hd=e,Xc=a.getColumnWidthFromData(b))};a.isColumnFixed=function(b){return!b||"left"!=b[a.options.columnFields.fixed]&&"right"!=b[a.options.columnFields.fixed]?!1:!0};var Ec=function(b,c,e){var d=null,f=void 0==c?"none":c,h=a.getColumnCompleteIndex(b);if(0<=h.level){if(0<h.index)for(var k=h.index-1;0<=k;k--){var g=a.completeColumnList[h.level][k].column;if(!e||e&&a.isColumnVisible(g)){var l=a.isColumnFixed(g)?g[a.options.columnFields.fixed]:"none";if(l==f){d=g;break}}}d||(b=a.getParentColumn(b))&&
(d=Ec(b,c,e))}return d},Fc=function(b,c,e){var d=null,f=void 0==c?"none":c,h=a.getColumnCompleteIndex(b);if(0<=h.level){if(0<=h.index)for(var k=h.index+1;k<a.completeColumnList[h.level].length;k++){var g=a.completeColumnList[h.level][k].column;if(!e||e&&a.isColumnVisible(g)){var l=a.isColumnFixed(g)?g[a.options.columnFields.fixed]:"none";if(l==f){d=g;break}}}d||(b=a.getParentColumn(b))&&(d=Fc(b,c,e))}return d},ie=function(b,c){if(b)switch(columnFixedType=b[a.options.columnFields.fixed],c){case "left":if("right"!=
columnFixedType){var d=Ec(b,b[a.options.columnFields.fixed]);if(!d||a.isColumnWithFixedWidth(d))return!1}else if(!columnFixedType||"none"==columnFixedType)return 0<index;break;case "right":if("right"==columnFixedType&&(d=Fc(b,b[a.options.columnFields.fixed]),!d||a.isColumnWithFixedWidth(d)))return!1}return!0},Kb=[],Ze=function(b){if(b&&(b=b[a.options.columnFields.columns]))for(var c=0;c<b.length;c++)a.isColumnWithChildenVisible(b[c])&&(b[c][a.options.columnFields.columns]&&0<b[c][a.options.columnFields.columns].length?
Ze(b[c]):Kb.push(b[c]))};a.resizeColumn=function(b,c,e){var d=b[a.options.columnFields.fixed];0>=c&&(e=c=0);var f;if(f=a.getHeaderElem(d))f=angular.element(f.find("tr")),0!=e&&(a.resizeColumnWithChildren(b,f,c,e),a.resizeParentColumn(b,f,e));if(f=a.getFooterElem(d))for(f=angular.element(f.find("tr")),Kb.length=0,Kb.push(b),Ze(b),b=0;b<Kb.length;b++)c=a.getColumnCurrentIndex(Kb[b]),a.resizeColumnCells(Kb[b],f,c,Kb[b][a.options.columnFields.width],2,d)};a.resizeParentColumn=function(b,c,e){if(b=a.getParentColumn(b)){var d=
b[a.options.columnFields.fixed],f=a.getColumnWidthFromData(b);f="right"==d?f-e:f+e;0>=f&&(e=f=0);0!=e&&(b[a.options.columnFields.width]=f,a.resizeColumnCells(b,c,-1,f,1,d),a.resizeParentColumn(b,c,e))}};a.resizeColumnWithChildren=function(b,c,e,f){var d=b[a.options.columnFields.fixed];0>=e&&(f=e=0);if(0!=f){b[a.options.columnFields.width]=e;a.resizeColumnCells(b,c,-1,e,1,d);var h=b[a.options.columnFields.columns];if(h&&0<h.length){b=0;if(h&&0<h.length)for(e=0;e<h.length;e++)a.isColumnWithFixedWidth(h[e])||
0<a.getColumnWidth(h[e])&&b++;if(0<b){f/=b;for(b=0;b<h.length;b++)a.isColumnWithFixedWidth(h[b])||(e=a.getColumnWidth(h[b]),0>=e&&(f="right"==d?f-a.getColumnWidthFromData(h[b]):f+a.getColumnWidthFromData(h[b])));for(b=0;b<h.length;b++)a.isColumnWithFixedWidth(h[b])||(e=a.getColumnWidth(h[b]),0<=e?(e=a.getColumnWidthFromData(h[b]),e="right"==d?e-f:e+f):e=0,a.resizeColumnWithChildren(h[b],c,e,f))}}else a.resizeRows(b,e,d),a.resizeRows(b,e,d,"top"),a.resizeRows(b,e,d,"bottom")}};a.resizeRows=function(b,
c,e,f){var d=a.getRowElems(e,f);if(d){var h=a.getColumnCurrentIndex(b),k={top:0,right:0,bottom:0,left:0},l=a.getElemFromColumn(b,b[a.options.columnFields.fixed]);l&&(l=a.getChildElement(l,"column-header-cell"))&&(k=g.getPadding(l[0]));for(l=0;l<d.length;l++)currentRowElem=angular.element(d[l]),a.resizeColumnCells(b,angular.element(d[l]),h,c,0,e,!0,k,f)}};a.resizeColumnCells=function(b,c,e,f,g,l,m,p,q){if(c){var d=-1;m&&(d=a.getRowCurrentIndex(a.getRowFromElem(c)));c=0;0<=d&&!q&&(c=a.indentList[d]);
switch(g){case 1:b=a.getElemFromColumnCell(b,l);break;case 2:b=a.getElemFromColumnCell(b,l,!0,"column-footer",e);break;case 3:b=a.getElemFromColumnCell(b,l,!1,"column-expand-cell");break;default:b=a.getElemFromCell(d,e,l,q)}b&&0<b.children().length&&(b=b.children().eq(0))&&(p=p?p.left+c:c,0<=d&&e==a.options.expandColIndex&&(f-=p),f=0<=f?f:0,3==g&&(f+=2),b.css("width",f+"px"))}};var Ud=function(b){a.dropMark()},Vd=function(a){Qb()},Wd=function(b){a.removeDropMark();a.dragIcon&&angular.element(a.dragIcon).remove();
a.cancelScrollTimer();a.dragDropStatus(!1)};angular.element(m).bind("dragenter",Ud);angular.element(m).bind("dragover",Vd);angular.element(m).bind("dragend",Wd);var ya=angular.element('<div class="iui-grid-column-reorder-mark"><span></span></div>'),ma=angular.element('<div class="iui-grid-column-reorder-tooltip"><span></span></div>'),ce=function(b){var c="initial";if(ca&&y){var d=!0;if(!a.hoverColumn||y==a.hoverColumn||a.hoverColumn&&0==a.hoverColumn.allowDrop||a.hoverColumn&&y[a.options.columnFields.fixed]!=
a.hoverColumn[a.options.columnFields.fixed])d=!1;else if(a.hoverColumn&&0!=a.hoverColumn[a.options.columnFields.allowDrop]&&y[a.options.columnFields.fixed]==a.hoverColumn[a.options.columnFields.fixed]){var e=a.getColumnCompleteIndex(y),f=a.getColumnCompleteIndex(a.hoverColumn);if(y[a.options.columnFields.pid]!=a.hoverColumn[a.options.columnFields.pid]||e.level!=f.level)d=!1}d||(c="no-drop",b&&ma&&ma.css("display","none"))}q.css("cursor",c);document.body.style.cursor=c},wd=function(b){return b?{min:g.isFieldAvailable(b[a.options.columnFields.minWidth],
0),max:g.isFieldAvailable(b[a.options.columnFields.maxWidth],9999999)}:{min:0,max:9999999}},Yd=function(b){if(0===b.button&&yb&&"none"!=Ya){var c=a.getMousePos(b).x-Hd,d=Xc+c;"right"==yb[a.options.columnFields.fixed]&&(d=Xc-c);d=0<=d?d:0;var e=wd(yb);d>=e.min&&d<=e.max&&(a.resizeColumn(yb,d,c),a.updateViewSize(),a.updateScrollVisibility(),id())}Z&&Z.css("display","none");ma&&ma.css("display","none");Jc?qa||1!==b.which||(W[0].getBoundingClientRect(),b=a.getMousePos(b),O.scrollMousePos||(O.scrollMousePos=
b),c=W[0].offsetLeft+(b.x-O.scrollMousePos.x),c<bb?c=bb:c+W[0].offsetWidth>sb&&(c=sb-W[0].offsetWidth),W.css("left",c+"px"),O.scrollMousePos=b,a.prevScrollPos={x:a.scrollPos.x,y:a.scrollPos.y},a.scrollPos.x=!1!==a.options.rtl?parseInt((sb-W[0].offsetLeft-W[0].offsetWidth)*Gb,10):parseInt((W[0].offsetLeft-bb)*Gb,10),jd(),(Id(a.scrollPos)||a.scrollPos.x!=a.prevScrollPos.x)&&a.callScrollPosChanged()):ta&&(qa||1!==b.which||(ja[0].getBoundingClientRect(),b=a.getMousePos(b),O.scrollMousePos||(O.scrollMousePos=
b),c=ja[0].offsetTop+(b.y-O.scrollMousePos.y),c<tb?c=tb:c+ja[0].offsetHeight>Xb&&(c=Xb-ja[0].offsetHeight),ja.css("top",c+"px"),O.scrollMousePos=b,Mc=c-tb,a.prevScrollPos={x:a.scrollPos.x,y:a.scrollPos.y},a.scrollPos.y=Math.floor(Mc*Nc*V),(Id(a.scrollPos)||a.scrollPos.y!=a.prevScrollPos.y)&&a.callScrollPosChanged(),newIndex=0<V?Math.floor(a.scrollPos.y/V):0,newIndex+E-1>a.currentList.length&&(newIndex=a.currentList.length-E+1,newIndex+=5),0>newIndex&&(newIndex=0),newIndex!==w&&(w=newIndex,a.updateView(!0))))},
Zd=function(b){a.removeDropDownList();a.closeEditor(I);a.closeFilterWindow();e()},$d=function(b){ce(!0);Z&&Z.remove();1==b.which&&vb&&ka&&(b=a.getElemFromGroup(ka))&&b.css("display","inline-block");ma&&ma.remove();vb=ca=!1;ka=null;yb&&"none"!=Ya&&a.callColumnSizeChanged(yb);yb=null;Ya="none";Hd=Xc=0;da=!1;q.css("cursor","default");a.updateView();a.dropMark();ta&&a.updateView();Qb();O.scrollMousePos=null;ta=Jc=!1;q.css("cursor","default");document.body.style.cursor="default"},Xd=function(b){switch(b.keyCode){case 16:a.multiSelection(!1);
break;case 17:a.multiSelection(!1);break;default:b.ctrlKey||b.metaKey||a.multiSelection(!1),b.shiftKey||a.multiSelection(!1)}};angular.element(m).bind("mousemove",Yd);angular.element(m).bind("mousedown",Zd);angular.element(m).bind("mouseup",$d);angular.element(m).bind("keyup",Xd);var Jd=!1,ac=0,Yc=null,$e=.5;a.isScrollBarVisible=function(a){switch(a){case "horizontal":return R;case "vertical":return U}return R&&U};a.prevScrollPos={x:0,y:0};a.scrollPos={x:0,y:0};a.getMaxScrollPos=function(){return S};
a.getScrollPos=function(){return a.scrollPos};a.setScrollPos=function(b,c){if(!qa&&b){var d=!0;0>b.x&&(b.x=0,d=!1);b.x>S.x&&(b.x=S.x,d=!1);0>b.y&&(b.y=0,d=!1);b.y>S.y&&(b.y=S.y,d=!1);a.scrollPos=b;Mc=Math.floor(a.scrollPos.y/(V*Nc));var e=tb+Mc;var f=!1!==a.options.rtl?Math.floor(a.scrollPos.x/Gb)-(sb-W[0].offsetWidth-bb):Math.floor(a.scrollPos.x/Gb)+bb;R&&W&&W.css("left",f+"px");U&&ja&&ja.css("top",e+"px");jd();Ad(!0,c);d&&a.callScrollPosChanged()}};var Id=function(a){return 0<a.x&&a.x<S.x||0<a.y&&
a.y<S.y},Gc=function(b,c,e){Jd||(a.updateFocus(),ac=0,Jd=!0,Yc=l(function(){var d=c,e=a.getScrollPos();d||(0===ac&&(ac=5),ac+=5+Nc,$e+=.5,d=ac+=Math.floor($e));e.y=b?e.y+d:e.y-d;a.setScrollPos(e);(0>=e.y||a.getScrollPos().y<e.y)&&Qb()},e?e:100))},Qb=function(){Yc&&(l.cancel(Yc),Yc=null);Jd=!1;ac=0};a.cancelScrollTimer=function(){Qb()};a.scrollTo=function(b,c){if(b){var d=a.getRowCurrentIndex(b);if(a.isRowIndexInRange(d)){var e=d;switch(c){case "center":e=Math.floor(J/2)-1;e=d>e?d-e:0;break;case "bottom":e=
J-2,a.options.showHeader&&e--,a.options.showFooter&&e--,e=d>e?d-e:0}a.setScrollPos({x:a.scrollPos.x,y:e*V})}}};var jd=function(){var b=a.scrollPos.x;0>b&&(b=0);b>S.x&&(b=S.x);b*=-1;ua&&ua.css("left",b+M+"px");Za&&Za.css("left",b+M+"px");oa&&oa.css("left",b+M+"px");ea&&ea.css("left",b+M+"px");Y&&Y.css("left",b+M+"px")},Ad=function(b,c){if(!(0==b&&0>=V)){newIndex=0<V?Math.floor(a.scrollPos.y/V):0;a.scrollPos.y==S.y&&newIndex--;if(a.currentList.length>=E&&newIndex+E-1>a.currentList.length){newIndex=
a.currentList.length-E+1;var d=a.getRowElems();d||(d=a.getRowElems("left"));d||(d=a.getRowElems("right"));d&&0<d.length&&(d=angular.element(d[d.length-1]),d[0].offsetTop+d[0].offsetHeight>q[0].clientHeight-(A+L)&&newIndex++)}0>newIndex&&(newIndex=0);newIndex!=w&&(w=newIndex,0!=b&&a.updateView(c))}};q.bind("scroll",function(a){q[0].scrollTop=0;q[0].scrollLeft=0});var af=function(b,c){if(U){document.activeElement&&document.activeElement.blur();a.removeDropDownList();a.closeEditor(I);a.closeFilterWindow();
e();var d=a.hoverRow;a.hoverRow=null;a.refresh(d);d=Math.floor(q[0].clientHeight/4);switch(a.options.mouseWheelSpeed){case "veryslow":d=V;break;case "slow":d=2*V;break;case "fast":d=Math.floor(q[0].clientHeight/2)-A-L-V;break;case "veryfast":d=Math.floor(q[0].clientHeight-A-L-V)}a.prevScrollPos={x:a.scrollPos.x,y:a.scrollPos.y};a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+d*c*-1},!0);Id(a.scrollPos)||a.scrollPos.y==a.prevScrollPos.y||a.callScrollPosChanged()}};q.bind("mousewheel",function(b){b.preventDefault();
if(!qa&&a.options.enabled){var c=0;b.wheelDelta?c=Math.max(-1,Math.min(1,b.wheelDelta||-b.detail)):b.originalEvent&&(c=Math.max(-1,Math.min(1,b.originalEvent.wheelDelta||-b.originalEvent.detail)));af(b,c)}});q.bind("DOMMouseScroll",function(b){b.preventDefault();if(!qa&&a.options.enabled){var c=0;b.detail?c=Math.max(-1,Math.min(1,-b.detail)):b.originalEvent&&(c=Math.max(-1,Math.min(1,-b.originalEvent.detail)));af(b,c)}});var tc={x:0,y:0},zb={x:0,y:0};q.bind("touchstart",function(b){b.preventDefault();
a.options.enabled&&(b=a.getTouchData(b))&&0<b.length&&(tc={x:b[0].pageX,y:b[0].pageY})});q.bind("touchend",function(b){if(a.options.enabled){(b=a.getTouchData(b))&&0<b.length&&(zb={x:b[0].pageX,y:b[0].pageY});var c=zb.x-tc.x,d=zb.y-tc.y;(20<Math.abs(c)||20<Math.abs(d))&&document.activeElement&&document.activeElement.blur();var e=!1,f=!1,g=tc,m=a.scrollPos.x,p=a.scrollPos.y,q=l(function(){var b=a.scrollPos;-20>c?(g.x-=10,g.x>zb.x?b.x+=10:(b.x=m-c,e=!0)):20<c?(g.x+=10,g.x<zb.x?b.x-=10:(b.x=m-c,e=!0)):
e=!0;-20>d?(g.y-=10,g.y>zb.y?b.y+=10:(b.y=p-d,f=!0)):20<d?(g.y+=10,g.y<zb.y?b.y-=10:(b.y=p-d,f=!0)):f=!0;a.setScrollPos(b);e&&f&&l.cancel(q)},5);tc=zb}});var Ra=null,la=angular.element('<div class="iui-contextmenu" data-element="context-menu" tabindex="999999"></div>'),Ia=angular.element('<ul class="iui-contextmenu-block"></ul>');p.$eval(Ac.menuItems);la.append(Ia);var bf=p.name,uc=null,Lb={general:"iui-contextmenu",block:{general:"iui-contextmenu-block",marker:{top:"iui-contextmenu-marker-top",left:"iui-contextmenu-marker-left",
bottom:"iui-contextmenu-marker-bottom",right:"iui-contextmenu-marker-right",rtlTop:"iui-contextmenu-marker-top-rtl",expand:{down:"iui-contextmenu-marker-expand-down",right:"iui-contextmenu-marker-expand-right",rtlDown:"iui-contextmenu-marker-expand-rtl-down",up:"iui-contextmenu-marker-expand-up",left:"iui-contextmenu-marker-expand-left",space:"iui-contextmenu-marker-expand-space"}}},item:{general:{disabled:"iui-contextmenu-item-disabled",focused:"iui-contextmenu-item-focused",normal:"iui-contextmenu-item",
hovered:"iui-contextmenu-item-hovered",selected:"iui-contextmenu-item-selected"},content:"iui-contextmenu-item-content",header:"iui-contextmenu-item-header",loadIcon:{general:"iui-contextmenu-load",icon:"iui-contextmenu-load-icon"},separator:"iui-contextmenu-item-separator"}},u={controlStyle:Lb,dataFields:{enabled:"enabled",icon:"icon",id:"id",hasChildren:"hasChildren",pid:"pid",items:"items",style:"style",text:"text",type:"type"},enabled:!0,itemClick:null,itemIcon:"",items:[],loadItem:null,open:null,
openOnHover:!0,position:"mouse",rtl:!1,activate:"rightclick",showIcons:!0},vc=[],Wa=[],Kd=function(a,b,c){a.type||(a.type="item");a[u.dataFields.id]||(a[u.dataFields.id]=g.getUniqueId());b&&(a[u.dataFields.pid]=b);c?Wa.push(a):vc.push(a)},cf=function(a,b,c){if(a[u.dataFields.items]){if(Kd(a,b,c),b=a[u.dataFields.items])for(var d=0;d<b.length;d++)cf(b[d],a[u.dataFields.id],c)}else Kd(a,b,c)},Df=function(){Wa.length=0;if(Ra)for(var a=wc(Ra),b=0;b<a.length;b++)cf(a[b],null,!0);return Wa},Ef=function(){vc.length=
0;if(Ra){var a=wc(Ra);if(a)for(var b=0;b<a.length;b++)Kd(a[b],0,null,!1)}},Zc=function(a){return a&&Wa?Wa.indexOf(a):-1},wc=function(b){return"column"==b.type?b[a.options.columnFields.contextMenu]:b[a.options.rowFields.contextMenu]},he=function(a,b){if(b){var c=wc(b);if(!c||c&&0==c.length)return!1;a.ctrlKey||a.metaKey||(la&&(la.unbind("blur"),la.remove()),Ff(a));return!0}return!1};angular.element(m).bind("click",function(a){Fb()});angular.element(m).bind("contextmenu",function(a){Fb()});angular.element(m).bind("keydown",
function(a){switch(a.keyCode){case 27:Fb()}});var $c=function(a){(a?a:Ia).unbind("contextmenu");a=a?a.find("li"):Ia.children();if(0<a.length)for(var b=0;b<a.length;b++)currentElem=angular.element(a[b]),currentElem.unbind("click mousedown mouseenter mouseleave touchstart")},Ld=function(a){$c(a);(a?a:Ia).bind("contextmenu",function(a){a.preventDefault()});var b=null;a=a?a.find("li"):Ia.children();if(0<a.length)for(var c=null,d=0;d<a.length;d++)c=angular.element(a[d]),(b=xc(c))&&b&&g.isEnabled(b[u.dataFields.enabled])&&
b&&"item"==b.type&&Gf(c)},Nd=function(){for(var a=0;a<Ja.length;a++)Ja[a][u.dataFields.selected]=!1,Md(Ja[a]);Ja.splice(0,Ja.length);Ka=null},Gf=function(a){a&&(a.bind("mousedown",function(a){var b=xc(this);b&&(b.itemClick&&b.itemClick({parentName:bf,item:b,mousePos:{x:a.pageX,y:a.pageY}}),Fb());a.stopPropagation()}),a.bind("mouseenter",function(a){var b=xc(this);b&&(angular.element(this),uc=b,bc(null,!0),Od(b)&&b!=Ka&&Nd(),gb&&f.cancel(gb),gb=f(function(){gb&&Hf(b)},500));a.stopPropagation()}),a.bind("mouseleave",
function(a){uc=null;var b=xc(this);if(b){bc(null,!0);Od(b)&&b==Ka&&Nd();Ka&&(Ka[u.dataFields.selected]=!0,bc(Ka));var c=f(function(){Md(b);f.cancel(c)},250)}gb&&f.cancel(gb);gb=null;a.stopPropagation()}),a.bind("touchstart",function(a){a.preventDefault();var b=g.getTouchData(a);if(b&&0<b.length){var c=xc(this);c&&(c.itemClick&&c.itemClick({parentName:bf,item:c,mousePos:{x:b[0].pageX,y:b[0].pageY}}),Fb());a.stopPropagation()}}))},Ka=null,Ja=[],df=function(a){return a?(a=a[u.dataFields.items],void 0!=
a&&0<a.length):!1},Hf=function(a){var b=Pd(a);if(a&&Qd(a)&&fa&&b){var c=b.find("ul");if(0<c.length){c=angular.element(c.eq(0));$c(c);df(a)&&(b.removeClass(u.controlStyle.block.marker.expand.down),b.removeClass(u.controlStyle.block.marker.expand.left),b.removeClass(u.controlStyle.block.marker.expand.right),b.removeClass(u.controlStyle.block.marker.expand.rtlDown));Ka=Od(a)?a:Ka;Ka[u.dataFields.selected]=!0;0>Ja.indexOf(Ka)&&Ja.unshift(Ka);for(var d=0;d<Ja.length;d++)Ja[d]!=Ka&&(Ja[d][u.dataFields.selected]=
!1,Md(Ja[d]));Ja.splice(1,Ja.length-1);if(df(a)){d=ef(a);if(0<=d){var e=0,l="auto";l=angular.element(b.parent());g.getPadding(b[0]);var m=g.getPadding(l[0]);b=g.getPadding(b[0]);e-=m.top+b.top;l=l[0].offsetWidth-8;0<b.right&&(l+=b.right-4);b="display:block;"+("top:"+e+"px;");"auto"!=l&&(b+="left:"+l+"px;");(a=ad(yc(a)))&&a.data&&d<a.data.length&&(a.data[d].inlineBlockStyle=b,fa.$apply())}f(function(){Ld(c);ff()},1)}}}},Md=function(a){var b=Pd(a);if(a&&fa&&b){var c=b.find("ul");0<c.length&&(c=angular.element(c.eq(0)),
$c(c),Qd(a)&&b.addClass(u.controlStyle.block.marker.expand.right),b=ef(a),0<=b&&(a=ad(yc(a)))&&a.data&&b<a.data.length&&(a.data[b].inlineBlockStyle="display:none;",fa.$apply()))}},Fb=function(){Nd();uc=null;la&&(la.unbind("blur"),la.remove());if(document.body)for(var a=angular.element(document.body).children(),b=0;b<a.length;b++){var c=angular.element(a[b]);c[0].attributes&&c[0].attributes["data-element"]&&"context-menu"===c[0].attributes["data-element"].value&&c.remove()}Ra=Ka=null;gb&&f.cancel(gb);
gb=null},Ff=function(a){if(document.body){la.css("top","-999px");la.css("tabindex","999");angular.element(document.body).append(la);la.bind("blur",function(a){Fb()});Ef();Df();If(void 0);var b=f(function(){la[0].focus();var c=a.pageY,d=a.pageX,e=g.getPageRect(q[0]);switch(u.position){case "above":c=e.top-2-Ia[0].offsetHeight;d=e.right-Ia[0].offsetWidth+1;break;case "below":c=e.bottom+2;d=e.right-Ia[0].offsetWidth+1;break;case "left":c=e.top-1;d=e.left-2-Ia[0].offsetWidth;break;case "right":c=e.top-
1,d=e.right+2}la.css("top",c+"px");la.css("left",d+"px");Ld();u.open&&u.open({mousePos:{x:a.pageX,y:a.pageY}});f.cancel(b)},1)}},Pd=function(a){var b=null;if(a){a=Zc(a);var c=la.find("li");if(c&&0<c.length)for(var d=0;d<c.length;d++){var e=angular.element(c[d]);if(e[0].attributes["data-index"]&&e[0].attributes["data-index"].value.toString()===a.toString()){b=e;break}}}return b},Jf=function(a){var b=null;a&&(a=Pd(a))&&(a=a.find("ul"),0<a.length&&(b=angular.element(a.eq(0))));return b},xc=function(a){if(a&&
(a=angular.element(a))&&a[0].attributes["data-index"]&&(a=a[0].attributes["data-index"].value,0<=a&&a<Wa.length))return Wa[a]},gf=function(a,b){var c=null;if(a&&b)for(var d=0;!c&&d<b.length;)c=b[d][u.dataFields.id]&&a[u.dataFields.pid]&&b[d][u.dataFields.id].toString()===a[u.dataFields.pid].toString()?b[d]:gf(a,b[d][u.dataFields.items]),d++;return c},ef=function(a){var b=yc(a);b=hf(b);var c=-1;b||(b=hf());if(!a[u.dataFields.id]&&b)c=b.indexOf(a);else if(a&&b)for(var d=0;d<b.length;d++)if(b[d][u.dataFields.id]&&
a[u.dataFields.id]&&b[d][u.dataFields.id].toString()===a[u.dataFields.id].toString()){c=d;break}return c},yc=function(a){if(Ra){var b=wc(Ra);return a&&b?gf(a,b):null}return null},hf=function(a){return a?(a[u.dataFields.items]||(a[u.dataFields.items]=[]),a[u.dataFields.items]):Ra?wc(Ra):[]},Kf=function(a){if(a&&"separator"!=a.type){if(0==a[u.dataFields.enabled])return"disabled";if(a==uc)return"hovered";if(1==a[u.dataFields.selected])return"selected"}return"normal"},Od=function(a){return!a||void 0!=
a[u.dataFields.pid]&&null!=a[u.dataFields.pid]?!1:!0},gb=null,fa=null,Qd=function(a){if(a){var b=a[u.dataFields.items];return a[u.dataFields.hasChildren]||b&&0<b.length}return!1};hd=function(a){return null!=a.icon||null!=u.itemIcon};var Lf=function(a,b,c){var d="";a[u.dataFields.icon]||""==a[u.dataFields.icon]?d=a[u.dataFields.icon]:u.itemIcon&&(d=u.itemIcon);return{icon:d,iconVisible:0!=u.showIcons&&hd(a),index:b,inlineBlockStyle:"display:none",item:a,style:{},visible:c}},Rd=function(a){var b=[];
if(a)for(var c=0;c<a.length;c++)b.push(Lf(a[c],Zc(a[c])));return b},ff=function(){var a=Ia.find("li");if(0<a.length)for(var b=0;b<a.length;b++)for(var c=angular.element(a[b]),e=c.children(),f=0;f<e.length;f++){var g=angular.element(e[f]);g[0].attributes["data-element"]&&"load-icon"==g[0].attributes["data-element"].value.toString()&&g.css("top",(c[0].clientHeight-g[0].offsetHeight)/2+"px")}},Mf=function(){var a=Ia.find("li");if(0<a.length)for(var b=0;b<a.length;b++){var c=angular.element(a[b]);c&&
c.attr("data-index",b)}},jf=function(a,b){var c=null;if(a&&b)for(var d=0;!c&&d<a.length;)c=a[d].item==b?a[d]:jf(a[d].data,b),d++;return c},ad=function(a){return a?jf(fa.data,a):fa},If=function(a){var b=f(function(){$c();u.rtl?la.css("direction","rtl"):la.css("direction","ltr");a||(Ia.empty(),fa&&fa.$destroy());f.cancel(b)},1),d=f(function(){var b="";if(a){var e=ad(a);if(e){var h=a[u.dataFields.items];if(h&&0<h.length){e.data=Rd(h);bc();fa.$apply();for(var g=0;g<h.length;g++)b+=Sd(g,h[g],e.scopeRef,
e.data);""!=b&&(e=Jf(a))&&(e.empty(),e.append(c(b)(fa)))}Mf()}}else{fa=p.$new();fa.data=Rd(vc);bc();fa.$apply();for(e=0;e<vc.length;e++)b+=Sd(e,vc[e],"data",fa.data);""!=b&&Ia.append(c(b)(fa))}Ld();var k=f(function(){ff();f.cancel(k)},1);f.cancel(d)},1)},Sd=function(a,b,c,e){Zc(b);var d='<li iui-class="{{'+c+"["+a+"].style";d="header"==b.type?d+'.header}}"':d+'.general}}"';d+=' data-index="'+Zc(b)+'">';switch(b.type){case "header":d=d+'<span data-element="header">'+("{{"+c+"["+a+"].item."+u.dataFields.text+
"}}");d+="</span>";break;case "separator":d+='<hr iui-class="{{'+c+"["+a+'].style.separator}}" data-element="separator" />';break;default:d=d+('<span iui-class="{{'+c+"["+a+'].icon}}" data-element="icon" ng-show="'+c+"["+a+'].iconVisible"></span>')+('<span iui-class="{{'+c+"["+a+'].style.content}}"  data-element="content">')+("{{"+c+"["+a+"].item."+u.dataFields.text+"}}"),d=d+"</span>"+('<span iui-class="{{'+c+"["+a+'].style.loadIcon}}" data-element="load-icon"></span>')}var f=b[u.dataFields.items];
if(b[u.dataFields.hasChildren]||f&&0<f.length){d+='<ul iui-class="{{'+c+"["+a+"].style.block";switch(u.displayMode){case "vertical":d=u.rtl?d+'.marker.right}}"':d+'.marker.left}}"';break;default:d=u.rtl?d+'.marker.right}}"':d+'.marker.left}}"'}d+=' iui-style="{{'+c+"["+a+'].inlineBlockStyle}}">';c+="["+a+"].data";e[a].data=Rd(f);e[a].scopeRef=c;if(f&&0<f.length)for(b=0;b<f.length;b++)d+=Sd(b,f[b],e[a].scopeRef,e[a].data);d+="</ul>"}return d+"</li>"},zc=function(a,b){var c=u.controlStyle.item;if(a)switch(a.style){case "initial":break;
case "parent":return zc(yc(a),b);default:null!=a.style&&(c=a.style)}if(b){if(g.isString(c.general))return c.general;switch(b){case "disabled":return c.general&&c.general.disabled?c.general.disabled:u.controlStyle.item.general.disabled;case "focused":return c.general&&c.general.focused?c.general.focused:u.controlStyle.item.general.focused;case "hovered":return c.general&&c.general.hovered?c.general.hovered:u.controlStyle.item.general.hovered;case "selected":return c.general&&c.general.selected?c.general.selected:
u.controlStyle.item.general.selected;default:return c.general&&c.general.normal?c.general.normal:u.controlStyle.item.general.normal}}else return c?c:u.controlStyle.item},bc=function(a,b){if(fa)if(a)switch(a.type){default:var c=ad(a);if(c){var d=Qd(a),e=Kf(a),f={block:Lb.block,content:"",general:"",header:Lb.item.header,label:"",loadIcon:"",separator:Lb.item.separator};var g=Lb.item.general.normal;u.controlStyle.item.general.normal!=g&&(g+=" "+u.controlStyle.item.general.normal);f.general=g;g=Lb.item.content;
u.controlStyle.item.content!=g&&(g+=" "+u.controlStyle.item.content);f.content=g;g=Lb.item.loadIcon.general;u.controlStyle.item.loadIcon.general!=g&&(g+=" "+u.controlStyle.item.loadIcon.general);u.rtl&&(g+="-rtl");f.loadIcon=g;switch(a.type){case "header":g=zc(a).header;g!=u.controlStyle.item.header&&(f.header+=" "+g);break;case "separator":g=zc(a).separator;g!=u.controlStyle.item.separator&&(f.separator+=" "+g);break;default:var k=zc(a);g=zc(a,e);g!=u.controlStyle.item.general.normal&&(f.general+=
" "+g);d&&"selected"!=e&&!u.loadItem&&(f.general=u.rtl?f.general+(" "+u.controlStyle.block.marker.expand.left):f.general+(" "+u.controlStyle.block.marker.expand.right));g=k.content;g!=u.controlStyle.item.content&&(f.content+=" "+g);a==u.loadItem&&(g=k.loadIcon.icon,f.loadIcon+=" "+g,g!=u.controlStyle.item.loadIcon.icon&&(f.loadIcon+=" "+g))}c.style=f;void 0==b&&fa.$apply()}}else{for(c=0;c<Wa.length;c++)Wa[c][u.dataFields.selected]=!1;for(c=uc;c;)c[u.dataFields.selected]=!0,c=yc(c);for(c=0;c<Wa.length;c++)bc(Wa[c],
!1);1==b&&fa.$apply()}};O=this;this.crpar=function(){return["si","tri","ver","on","al "]};this.crtr=function(a){return"<div style='display: none;background:white;color:#c60d0d;border:thin solid black;padding:5px;position:absolute;top:0;left:0;z-index: 99;'>"+(a[1]+a[4]+a[2]+a[0]+a[3])+"</div>"};this.tpar=this.crpar();this.$tw=angular.element(this.crtr(O.tpar));this.tmp=300;this.twp=200*this.tmp;this.trActive=!1;this.trCount=0;this.trlTime=this.trId=null;this.trShowCount=0;this.animTr=function(){this.trCount++;
3>this.trShowCount?(this.trCount=1,this.$tw.css("display","block"),this.$tw.css("top",q[0].scrollTop+"px"),this.$tw.css("left",q[0].scrollLeft+"px"),this.trShowCount++):(0===this.trCount%49&&(this.trShowCount=0),this.$tw.css("display","none"),this.$tw.css("top",q[0].scrollTop+"px"),this.$tw.css("left",q[0].scrollLeft+"px"))};this.s1t=function(a){O.s3t();this.trlTime=f(function(){O.trActive||(O.trCount=0,O.trActive=!0,O.trId=l(function(){O.animTr()},1E3))},a)};this.s3t=function(){this.trId&&(l.cancel(this.trId),
this.trId=null);this.trlTime&&(f.cancel(this.trlTime),this.trlTime=null);this.trActive=!1};this.s2t=function(){this.s3t();this.trActive=!1;this.$tw.remove()};q.append(this.$tw);this.s1t(this.twp);angular.isDefined(p.options)?a.updateOptions(p.options):(0==p.allowAnimation&&(a.options.allowAnimation=p.allowAnimation),0==p.allowCellFocus&&(a.options.allowCellFocus=p.allowCellFocus),1==p.allowColumnReorder&&(a.options.allowColumnReorder=p.allowColumnReorder),1==p.allowDrag&&(a.options.allowDrag=p.allowDrag),
0==p.allowDrop&&(a.options.allowDrop=p.allowDrop),1==p.allowFilter&&(a.options.allowFilter=p.allowFilter),0==p.allowFocus&&(a.options.allowFocus=p.allowFocus),0==p.autoExpand&&(a.options.autoExpand=p.autoExpand),0==p.autoUpdate&&(a.options.autoUpdate=p.autoUpdate),angular.isDefined(p.animationSpeed)&&200!==p.animationSpeed&&(a.options.animationSpeed=p.animationSpeed),angular.isDefined(p.controlStyle)&&a.updateControlStyle(p.controlStyle),angular.isDefined(p.displayMode)&&(a.options.displayMode=p.displayMode),
angular.isDefined(p.editorSettings)&&a.updateEditorSettings(p.editorSettings),0==p.enabled&&(a.options.enabled=p.enabled),angular.isDefined(p.expandingColumnIndex)&&(a.options.expandColIndex=p.expandingColumnIndex),angular.isDefined(p.fields)&&(a.updateDataFields(p.fields),a.updateData()),1==p.fillSpace&&(a.options.fillSpace=p.fillSpace),angular.isDefined(p.gridLines)&&(a.options.gridLines=p.gridLines),angular.isDefined(p.grouping)&&a.updateGrouping(p.grouping),1==p.hoverSelection&&(a.options.hoverSelection=
p.hoverSelection),angular.isDefined(p.indent)&&(a.options.indent=p.indent),angular.isDefined(p.labelEdit)&&(a.options.labelEdit=p.labelEdit),angular.isDefined(p.mouseWheelSpeed)&&(a.options.mouseWheelSpeed=p.mouseWheelSpeed),angular.isDefined(p.paging)&&a.updatePaging(p.paging),angular.isDefined(p.rowHeight)&&(a.options.rowHeight=p.rowHeight),angular.isDefined(p.rowIcon)&&(a.options.rowIcon=p.rowIcon),1==p.rtl&&(a.options.rtl=p.rtl),angular.isDefined(p.selectedIndex)&&(a.options.selectedIndex=p.selectedIndex),
angular.isDefined(p.selectedRow)&&(a.options.selectedRow=p.selectedRow),angular.isDefined(p.selectionMode)&&(a.options.selectionMode=p.selectionMode),0==p.showFooter&&(a.options.showFooter=p.showFooter),0==p.showHeader&&(a.options.showHeader=p.showHeader),0==p.showIcons&&(a.options.showIcons=p.showIcons),angular.isDefined(p.showScroll)&&a.updateShowScroll(p.showScroll),angular.isDefined(p.sorting)&&(a.options.sorting=p.sorting));a.updateLayout()}}}]);