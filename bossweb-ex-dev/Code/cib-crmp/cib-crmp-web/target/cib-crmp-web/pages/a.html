<!doctype html>
<html ng-app="app">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
 <script src="../skeleton/includeJs_3rd.js"></script>
 <script src="../skeleton/includeCss_3rd.js"></script>
 <script src="../skeleton/include_ui-grid.js"></script>
 </head>
 
     
 <!-- https://blog.csdn.net/vesong87/article/details/67639872 -->
 <body>
  <div ng-controller="MainCtrl">
   <div id="user-grid" ui-grid="gridOptions" style="width:100%" class="user-grid" ui-grid-pagination ui-grid-resize-columns ui-grid-auto-resize ui-grid-selection ui-grid-edit ui-grid-exporter></div></div>
  </div>
 </body>
 <script type="text/javascript">
 var app = angular.module('app', ['ngTouch', 'ngAnimate', 'ui.grid','ui.grid.exporter', 'ui.grid.pagination','ui.grid.resizeColumns','ui.grid.autoResize','ui.grid.selection','ui.grid.edit']);
 app.controller('MainCtrl', function ($scope,$http, i18nService){
		 i18nService.setCurrentLang("zh-cn");
	     $scope.gridOptions = {
	    		 enableSorting: true, //是否排序
                 useExternalSorting: false, //是否使用自定义排序规则
                 enableGridMenu: true, //是否显示grid 菜单
                 showGridFooter: false, //是否显示grid footer
                 enableHorizontalScrollbar :  1, //grid水平滚动条是否显示, 0-不显示  1-显示
                 enableVerticalScrollbar : 1, //grid垂直滚动条是否显示, 0-不显示  1-显示  
                 
         //-------- 分页属性 ----------------
           enablePagination: true, //是否分页，默认为true
           enablePaginationControls: true, //使用默认的底部分页
           paginationPageSizes: [10, 15, 20], //每页显示个数可选项
           paginationCurrentPage:1, //当前页码
           paginationPageSize: 10, //每页显示个数
           //paginationTemplate:"<div></div>", //自定义底部分页代码
           totalItems : 0, // 总数量
           useExternalPagination: true,//是否使用分页按钮
         //----------- 选中 ----------------------
           enableFooterTotalSelected: true, // 是否显示选中的总数，默认为true, 如果显示，showGridFooter 必须为true
           enableFullRowSelection : false, //是否点击行任意位置后选中,默认为false,当为true时，checkbox可以显示但是不可选中
           enableRowHeaderSelection : true, //是否显示选中checkbox框 ,默认为true
           enableRowSelection : true, // 行选择是否可用，默认为true;
           enableSelectAll : true, // 选择所有checkbox是否可用，默认为true; 
           enableSelectionBatchEvent : true, //默认true
              isRowSelectable: function(row){ //GridRow
              if(row.entity.age > 45){
                  row.grid.api.selection.selectRow(row.entity); // 选中行
              }
           },
           modifierKeysToMultiSelect: false ,//默认false,为true时只能 按ctrl或shift键进行多选, multiSelect 必须为true;
           multiSelect: true ,// 是否可以选择多个,默认为true;
           noUnselect: false,//默认false,选中后是否可以取消选中
           selectionRowHeaderWidth:30 ,//默认30 ，设置选择列的宽度；
           
           columnDefs: [
           	         {field: 'accountName', displayName:'手机号', width: 200},
           	         {field: 'userName', displayName:'用户名', width: 100},
           	         {field: 'unitName', displayName:'单位', width: 300},
           	         {
           	           field: 'createTime', displayName: '注册时间', width: 200,
           	           cellTemplate: '<div class="ui-grid-cell-contents"><span ng-bind="grid.appScope.rDateFormat(row.entity.createTime)"></span></div>'
           	         },
           	         {
           	           field: 'roleList', displayName: '类型', width: 200,
           	           cellTemplate: '<div class="ui-grid-cell-contents"><span ng-repeat="item in row.entity.roleList" style="margin-right:5px;">{{item.roleName}}</span></div>'
           	         },
           	         {
           	           field: 'accountId', displayName: '详细信息', width: 200,
           	           cellTemplate: '<div class="ui-grid-cell-contents"><button type="button" ng-click="grid.appScope.showAccountDetail(row.entity.roleList, row.entity.accountId)" style="line-height: normal" class="btn-primary btn">查看详情</button></div>'
           	         }
           	       ],
         //---------------api---------------------
           onRegisterApi: function(gridApi) {
               $scope.gridApi = gridApi;
               //分页按钮事件
               gridApi.pagination.on.paginationChanged($scope,function(newPage, pageSize) {
                     if(getPage) { 
                         getPage(newPage, pageSize); 
                      }
               });
               //行选中事件
               $scope.gridApi.selection.on.rowSelectionChanged($scope,function(row,event){
                   if(row){
                       $scope.testRow = row.entity;
                   }
                });
           }
       };
       
       var getPage = function(curPage, pageSize) {
               var firstRow = (curPage - 1) * pageSize;
               $scope.gridOptions.totalItems = myData.length;
               $scope.gridOptions.data = myData.slice(firstRow, firstRow + pageSize);
               //或者像下面这种写法
               //$scope.myData = mydefalutData.slice(firstRow, firstRow + pageSize);
       };
           
	      
	    
	     
	     /**
	     $http({
	         method: 'GET',
	         url: 'data.json'
	     }).then(function successCallback(response) {
	    	 	$scope.gridOptions.data = response.data;
	         }, function errorCallback(response) {
	            console.log('failed');
	     });*/
	     
	     //$scope.gridOptions.data 
	     var myData = [{
	    		'accountName': '15555555555',
	    		'userName': '浮生若梦',
	    		'unitName': '无',
	    		'createTime': 1506661676435,
	    		'roleList': [{
	    			roleName: '前端',
	    			'roleId': 2
	    		},
	    		{
	    			roleName: '后端',
	    			'roleId': 3
	    		}],
	    		'accountId': 201
	    	},
	    	{
	    		'accountName': '15555555555',
	    		'userName': '浮生若梦',
	    		'unitName': '无',
	    		'createTime': 1506661676435,
	    		'roleList': [{
	    			roleName: '前端',
	    			'roleId': 2
	    		},
	    		{
	    			roleName: '后端',
	    			'roleId': 3
	    		}],
	    		'accountId': 2001
	    	},
	    	{
	    		'accountName': '15555555555',
	    		'userName': '浮生若梦',
	    		'unitName': '无',
	    		'createTime': 1506661676435,
	    		'roleList': [{
	    			roleName: '前端',
	    			'roleId': 2
	    		},
	    		{
	    			roleName: '后端',
	    			'roleId': 3
	    		}],
	    		'accountId': 2101
	    	},
	    	{
	    		'accountName': '15555555555',
	    		'userName': '浮生若梦',
	    		'unitName': '无',
	    		'createTime': 1506661676435,
	    		'roleList': [{
	    			roleName: '前端',
	    			'roleId': 2
	    		},
	    		{
	    			roleName: '后端',
	    			'roleId': 3
	    		}],
	    		'accountId': 201
	    	},
	    	{
	    		'accountName': '15555555555',
	    		'userName': '浮生若梦',
	    		'unitName': '无',
	    		'createTime': 1506661676435,
	    		'roleList': [{
	    			roleName: '前端',
	    			'roleId': 2
	    		},
	    		{
	    			roleName: '后端',
	    			'roleId': 3
	    		}],
	    		'accountId': 201
	    	},
	    	{
	    		'accountName': '15555555555',
	    		'userName': '浮生若梦',
	    		'unitName': '无',
	    		'createTime': 1506661676435,
	    		'roleList': [{
	    			roleName: '前端',
	    			'roleId': 2
	    		},
	    		{
	    			roleName: '后端',
	    			'roleId': 3
	    		}],
	    		'accountId': 201
	    	},
	    	{
	    		'accountName': '15555555555',
	    		'userName': '浮生若梦',
	    		'unitName': '无',
	    		'createTime': 1506661676435,
	    		'roleList': [{
	    			roleName: '前端',
	    			'roleId': 2
	    		},
	    		{
	    			roleName: '后端',
	    			'roleId': 3
	    		}],
	    		'accountId': 2041
	    	},
	    	{
	    		'accountName': '15555555555',
	    		'userName': '浮生若梦',
	    		'unitName': '无',
	    		'createTime': 1506661676435,
	    		'roleList': [{
	    			roleName: '前端',
	    			'roleId': 2
	    		},
	    		{
	    			roleName: '后端',
	    			'roleId': 3
	    		}],
	    		'accountId': 2701
	    	},
	    	{
	    		'accountName': '15555555555',
	    		'userName': '浮生若梦',
	    		'unitName': '无',
	    		'createTime': 1506661676435,
	    		'roleList': [{
	    			roleName: '前端',
	    			'roleId': 2
	    		},
	    		{
	    			roleName: '后端',
	    			'roleId': 3
	    		}],
	    		'accountId': 2081
	    	},
	    	{
	    		'accountName': '15555555555',
	    		'userName': '浮生若梦',
	    		'unitName': '无',
	    		'createTime': 1506661676435,
	    		'roleList': [{
	    			roleName: '前端',
	    			'roleId': 2
	    		},
	    		{
	    			roleName: '后端',
	    			'roleId': 3
	    		}],
	    		'accountId': 2071
	    	},
	    	{
	    		'accountName': '15555555555',
	    		'userName': '浮生若梦',
	    		'unitName': '无',
	    		'createTime': 1506661676435,
	    		'roleList': [{
	    			roleName: '前端',
	    			'roleId': 2
	    		},
	    		{
	    			roleName: '后端',
	    			'roleId': 3
	    		}],
	    		'accountId': 201
	    	}];
	     getPage(1, $scope.gridOptions.paginationPageSize);
	 });
 </script>
</html>