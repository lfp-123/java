<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SettleApportionRuleServiceImpl.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">cib-crmp-rule</a> &gt; <a href="index.source.html" class="el_package">com.newland.boss.cib.crmp.service.impl</a> &gt; <span class="el_source">SettleApportionRuleServiceImpl.java</span></div><h1>SettleApportionRuleServiceImpl.java</h1><pre class="source lang-java linenums">/**
 * 
 */
package com.newland.boss.cib.crmp.service.impl;

import java.io.File;
import java.io.IOException;
import java.net.URLEncoder;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.transaction.Transactional;
import org.apache.log4j.LogManager;
import org.apache.log4j.Logger;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;
import com.google.gson.JsonArray;
import com.google.gson.JsonElement;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;
import com.newland.boss.cib.crmp.common.JxlTool;
import com.newland.boss.cib.crmp.dao.SettleApportionRelaDao;
import com.newland.boss.cib.crmp.dao.SettleApportionRuleDao;
import com.newland.boss.cib.crmp.domain.SettleApportionRule;
import com.newland.boss.cib.crmp.exception.ExcelParseException;
import com.newland.boss.cib.crmp.service.SettleApportionRuleService;
import com.newland.boss.kpi.entity.DictDef;
import com.newland.boss.kpi.server.DictDefService;
import jxl.read.biff.BiffException;
import jxl.write.WriteException;

/**
 * @author ylc
 *
 *         2018-05-11
 */
@Component
@Transactional
<span class="fc" id="L44">public class SettleApportionRuleServiceImpl implements SettleApportionRuleService {</span>

	@Autowired
	private SettleApportionRuleDao settleApportionRuleDao;
	@Autowired
	private SettleApportionRelaDao settleApportionRelaDao;
	@Autowired
	private DictDefService dictDefService;

<span class="fc" id="L53">	private SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span>

<span class="fc" id="L55">	private SimpleDateFormat filesdf = new SimpleDateFormat(&quot;yyyyMMddHHmmss&quot;);</span>

<span class="fc" id="L57">	private static final Logger LOGGER = LogManager.getLogger(SettleApportionRuleServiceImpl.class);</span>

	public static final String RESULT = &quot;result&quot;;

	public static final String FILENAME = &quot;filename&quot;;

	public static final String ERROR = &quot;error&quot;;

	public static final String TRUE = &quot;true&quot;;

	public static final String FALSE = &quot;false&quot;;

	/**
	 * 根据ID查询数据字典
	 * 
	 * @return Map
	 */
	public Map&lt;Integer, String&gt; getDicMap(Integer dicId) {
<span class="fc" id="L75">		Map&lt;Integer, String&gt; dicMap = new HashMap&lt;&gt;();</span>
<span class="fc" id="L76">		List&lt;DictDef&gt; dicList = dictDefService.getDictDefByDictClass(dicId);</span>
<span class="fc bfc" id="L77" title="All 2 branches covered.">		for (DictDef dictDef : dicList) {</span>
<span class="fc" id="L78">			dicMap.put(dictDef.getEntryId(), dictDef.getEntryName());</span>
<span class="fc" id="L79">		}</span>
<span class="fc" id="L80">		return dicMap;</span>
	}

	/**
	 * 根据Name查询数据字典Id
	 * 
	 * @return Map
	 */
	public Map&lt;String, Integer&gt; getDicIdMap(Integer dicId) {
<span class="fc" id="L89">		Map&lt;String, Integer&gt; dicMap = new HashMap&lt;&gt;();</span>
<span class="fc" id="L90">		List&lt;DictDef&gt; dicList = dictDefService.getDictDefByDictClass(dicId);</span>
<span class="fc bfc" id="L91" title="All 2 branches covered.">		for (DictDef dictDef : dicList) {</span>
<span class="fc" id="L92">			dicMap.put(dictDef.getEntryName(), dictDef.getEntryId());</span>
<span class="fc" id="L93">		}</span>
<span class="fc" id="L94">		return dicMap;</span>
	}

	@Override
	public Boolean addSettleApportionRule(SettleApportionRule settleApportionRule) {

		// 默认系统创建时间
<span class="fc" id="L101">		settleApportionRule.setCreateTime(new Date());</span>

<span class="fc" id="L103">		List&lt;SettleApportionRule&gt; dateValidity = settleApportionRuleDao.judgeRuleDateValidity(settleApportionRule);</span>
<span class="pc bpc" id="L104" title="1 of 2 branches missed.">		if (dateValidity.isEmpty()) {</span>
<span class="fc" id="L105">			settleApportionRuleDao.insertSettleApportionRule(settleApportionRule);</span>
<span class="fc" id="L106">			return true;</span>
		}
<span class="nc" id="L108">		return false;</span>

	}

	@Override
	public void removeSettleApportionRule(String ruleJson) {

<span class="fc" id="L115">		JsonParser jsonParser = new JsonParser();</span>
<span class="fc" id="L116">		JsonElement jsonEl = jsonParser.parse(ruleJson);</span>
<span class="fc" id="L117">		JsonObject jsonObj = jsonEl.getAsJsonObject();</span>
<span class="fc" id="L118">		JsonArray ruleArray = jsonObj.get(&quot;ruleIdJson&quot;).getAsJsonArray(); // 选中的机构</span>

		// 循环删除角色
<span class="fc bfc" id="L121" title="All 2 branches covered.">		for (int i = 0; i &lt; ruleArray.size(); i++) {</span>
<span class="fc" id="L122">			Integer ruleId = ruleArray.get(i).getAsInt();</span>
<span class="fc" id="L123">			settleApportionRelaDao.deleteSettleApportionRelaByRuleId(ruleId);</span>
<span class="fc" id="L124">			settleApportionRuleDao.deleteSettleApportionRule(ruleId);</span>
		}
<span class="fc" id="L126">	}</span>

	@Override
	public Map&lt;String, String&gt; editSettleApportionRule(SettleApportionRule settleApportionRule) {
<span class="fc" id="L130">		Map&lt;String, String&gt; resultMap = new HashMap&lt;&gt;();</span>
<span class="fc" id="L131">		List&lt;SettleApportionRule&gt; dateValidity = settleApportionRuleDao.judgeRuleDateValidity(settleApportionRule);</span>
<span class="pc bpc" id="L132" title="3 of 4 branches missed.">		if (dateValidity.isEmpty() || dateValidity.size() == 1</span>
<span class="nc bnc" id="L133" title="All 2 branches missed.">				&amp;&amp; dateValidity.get(0).getApportionItemId().equals(settleApportionRule.getApportionItemId())) {</span>

<span class="pc bpc" id="L135" title="1 of 2 branches missed.">			if (settleApportionRule.getStatus() == 2</span>
<span class="nc bnc" id="L136" title="All 2 branches missed.">					&amp;&amp; settleApportionRelaDao.queryRelaByRuleId(settleApportionRule.getApportionItemId()) != 0) {</span>
<span class="nc" id="L137">				resultMap.put(RESULT, FALSE);</span>
<span class="nc" id="L138">				resultMap.put(ERROR, &quot;该摊分规则存在分配关系无法禁用，请先解除分配关系&quot;);</span>
			} else {
<span class="fc" id="L140">				settleApportionRuleDao.updateSettleApportionRule(settleApportionRule);</span>
				// 同时更新关系规则的生失效时间
<span class="fc" id="L142">				settleApportionRelaDao.updateSettleApportionRelaTime(settleApportionRule);</span>
<span class="fc" id="L143">				resultMap.put(RESULT, TRUE);</span>
			}

		} else {
<span class="nc" id="L147">			resultMap.put(RESULT, FALSE);</span>
<span class="nc" id="L148">			resultMap.put(ERROR, &quot;修改失败生失效时间冲突，请重新选择!&quot;);</span>
		}
<span class="fc" id="L150">		return resultMap;</span>

	}

	@Override
	public List&lt;SettleApportionRule&gt; loadAllSettleApportionRule() {
<span class="fc" id="L156">		return settleApportionRuleDao.queryAllSettleApportionRule();</span>
	}

	@Override
	public List&lt;SettleApportionRule&gt; loadSettleApportionRuleByParam(SettleApportionRule settleApportionRule) {
<span class="pc bpc" id="L161" title="1 of 2 branches missed.">		if (settleApportionRule.getApportionRuleName() != null) {</span>
<span class="fc" id="L162">			settleApportionRule.setApportionRuleName(</span>
<span class="fc" id="L163">					settleApportionRule.getApportionRuleName().replace(&quot;_&quot;, &quot;/_&quot;).replaceAll(&quot;%&quot;, &quot;/%&quot;));</span>
		}
<span class="fc" id="L165">		return settleApportionRuleDao.querySettleApportionRuleByParam(settleApportionRule);</span>
	}

	@Override
	public SettleApportionRule getSettleApportionRuleById(Integer settleApportionRuleId) {

<span class="fc" id="L171">		return settleApportionRuleDao.getSettleApportionRuleById(settleApportionRuleId);</span>
	}

	@Override
	public Map&lt;String, String&gt; modifySettleApportionRuleStatus(String ruleJson) {
<span class="fc" id="L176">		Map&lt;String, String&gt; resultMap = new HashMap&lt;&gt;();</span>
<span class="fc" id="L177">		StringBuilder result = new StringBuilder();</span>
<span class="fc" id="L178">		JsonParser jsonParser = new JsonParser();</span>
<span class="fc" id="L179">		JsonElement jsonEl = jsonParser.parse(ruleJson);</span>
<span class="fc" id="L180">		JsonObject jsonObj = jsonEl.getAsJsonObject();</span>
<span class="fc" id="L181">		JsonArray ruleArray = jsonObj.get(&quot;ruleIdArray&quot;).getAsJsonArray(); // 选中的rule</span>
<span class="fc" id="L182">		Integer ruleStatus = jsonObj.get(&quot;ruleStatus&quot;).getAsInt();// 要改变的规则状态</span>
<span class="fc" id="L183">		SettleApportionRule settleApportionRule = new SettleApportionRule();</span>
<span class="fc" id="L184">		settleApportionRule.setStatus(ruleStatus);</span>
		// 循环更新规则状态
<span class="fc bfc" id="L186" title="All 2 branches covered.">		for (int i = 0; i &lt; ruleArray.size(); i++) {</span>
<span class="fc" id="L187">			Integer ruleId = ruleArray.get(i).getAsInt();</span>
			// 判断如果把规则禁用，需要查询是否将该规则分配出去
<span class="pc bpc" id="L189" title="1 of 2 branches missed.">			if (settleApportionRelaDao.queryRelaByRuleId(ruleId) != 0) {</span>
<span class="nc" id="L190">				result.append(ruleId).append(&quot;、&quot;);</span>
<span class="nc" id="L191">				continue;</span>
			}
<span class="fc" id="L193">			settleApportionRule.setApportionItemId(ruleId);</span>
<span class="fc" id="L194">			settleApportionRuleDao.updateSettleApportionRule(settleApportionRule);</span>
		}
<span class="pc bpc" id="L196" title="1 of 2 branches missed.">		if (result.length() == 0) {</span>
<span class="fc" id="L197">			resultMap.put(RESULT, TRUE);</span>
		} else {
<span class="nc" id="L199">			resultMap.put(RESULT, FALSE);</span>
<span class="nc" id="L200">			resultMap.put(ERROR, &quot;摊分规则ID为:&quot; + result.substring(0, result.length() - 1) + &quot;的规则存在分配关系无法禁用，请先解除分配关系&quot;);</span>
		}
<span class="fc" id="L202">		return resultMap;</span>
	}

	@Override
	public Map&lt;String, String&gt; exportSettleApportionRule(SettleApportionRule settleApportionRule) {
<span class="fc" id="L207">		Map&lt;String, String&gt; resultMap = new HashMap&lt;&gt;();</span>
		// 1004规则类型数据字典
<span class="fc" id="L209">		Map&lt;Integer, String&gt; statusMap = getDicMap(1004);</span>
		// 1001资费类型数据字典
<span class="fc" id="L211">		Map&lt;Integer, String&gt; cdrTypeMap = getDicMap(1001);</span>
		// 1019资费类型数据字典
<span class="fc" id="L213">		Map&lt;Integer, String&gt; scopeMap = getDicMap(1019);</span>
<span class="fc" id="L214">		String title = &quot;SettleRuleExport&quot; + filesdf.format(new Date()) + &quot;.xls&quot;;</span>
<span class="fc" id="L215">		String path = System.getProperty(&quot;user.dir&quot;) + &quot;/downloadTemp/&quot; + title;</span>
<span class="fc" id="L216">		String[] columns = { &quot;摊分规则ID&quot;, &quot;摊分规则名称&quot;, &quot;资源类型&quot;, &quot;规则范围&quot;, &quot;摊分比例&quot;, &quot;生效时间&quot;, &quot;失效时间&quot;, &quot;规则状态&quot;, &quot;操作工号ID&quot;, &quot;创建时间&quot;,</span>
				&quot;备注说明&quot; };
<span class="fc" id="L218">		boolean[] numberFlag = { false, false, false, false, false, false, false, false, false, false, false };</span>
<span class="fc" id="L219">		List&lt;String[]&gt; dataList = new ArrayList&lt;&gt;();</span>
<span class="pc bpc" id="L220" title="1 of 2 branches missed.">		if (settleApportionRule.getApportionRuleName() != null) {</span>
<span class="fc" id="L221">			settleApportionRule.setApportionRuleName(</span>
<span class="fc" id="L222">					settleApportionRule.getApportionRuleName().replace(&quot;_&quot;, &quot;/_&quot;).replaceAll(&quot;%&quot;, &quot;/%&quot;));</span>
		}
<span class="fc" id="L224">		List&lt;SettleApportionRule&gt; saRLists = settleApportionRuleDao</span>
<span class="fc" id="L225">				.querySettleApportionRuleByParam(settleApportionRule);</span>
<span class="pc bpc" id="L226" title="1 of 2 branches missed.">		for (SettleApportionRule r : saRLists) {</span>
<span class="nc" id="L227">			String[] date = { String.valueOf(r.getApportionItemId()), String.valueOf(r.getApportionRuleName()),</span>
<span class="nc" id="L228">					cdrTypeMap.get(r.getCdrType()), scopeMap.get(r.getScope()), String.valueOf(r.getRatio()),</span>
<span class="nc" id="L229">					sdf.format(r.getInureDate()), sdf.format(r.getExpireDate()), statusMap.get(r.getStatus()),</span>
<span class="nc" id="L230">					String.valueOf(r.getOperatorId()), sdf.format(r.getCreateTime()),</span>
<span class="nc bnc" id="L231" title="All 2 branches missed.">					String.valueOf(r.getApportionDesc() == null ? &quot;&quot;</span>
<span class="nc" id="L232">							: r.getApportionDesc()) };</span>
<span class="nc" id="L233">			dataList.add(date);</span>
<span class="nc" id="L234">		}</span>
		try {
<span class="fc" id="L236">			JxlTool.exportExcel(path, columns, dataList, numberFlag);</span>
<span class="fc" id="L237">			resultMap.put(RESULT, TRUE);</span>
<span class="fc" id="L238">			resultMap.put(FILENAME, URLEncoder.encode(title, &quot;UTF-8&quot;));</span>
<span class="nc" id="L239">		} catch (WriteException | IOException e) {</span>
<span class="nc" id="L240">			LOGGER.debug(&quot;文件导出异常&quot; + e.getMessage());</span>
<span class="nc" id="L241">			resultMap.put(RESULT, FALSE);</span>
<span class="nc" id="L242">			resultMap.put(ERROR, e.getMessage());</span>
<span class="fc" id="L243">		}</span>
<span class="fc" id="L244">		return resultMap;</span>
	}

	@Override
	public Map&lt;String, String&gt; importSettleApportionRule(String tempPath, Integer operatorId) {
<span class="fc" id="L249">		Map&lt;String, String&gt; resultMap = new HashMap&lt;&gt;();</span>
<span class="fc" id="L250">		Integer counter = 1;</span>
		try {
<span class="fc" id="L252">			List&lt;String[]&gt; dataList = JxlTool.importExcel(tempPath, 0);</span>
<span class="fc" id="L253">			File file = new File(tempPath);</span>
<span class="pc bpc" id="L254" title="3 of 6 branches missed.">			if (file.exists() &amp;&amp; file.isFile() &amp;&amp; !file.delete()) {</span>
<span class="nc" id="L255">				LOGGER.debug(&quot;删除临时结算摊分上传文件失败&quot;);</span>
			}
<span class="pc bpc" id="L257" title="1 of 2 branches missed.">			for (int j = 1; j &lt; dataList.size(); j++) {</span>
				// 某行空单元格数量
<span class="fc" id="L259">				int nullData = 0;</span>

<span class="fc bfc" id="L261" title="All 2 branches covered.">				for (int i = 0; i &lt;= 7; i++) {</span>
<span class="fc bfc" id="L262" title="All 2 branches covered.">					if (&quot;&quot;.equals(dataList.get(j)[i])) {</span>
<span class="fc" id="L263">						nullData = nullData + 1;</span>
					}
				}

<span class="fc bfc" id="L267" title="All 2 branches covered.">				if (nullData == 8) {</span>
<span class="fc" id="L268">					break;</span>
<span class="pc bpc" id="L269" title="1 of 2 branches missed.">				} else if (nullData == 0) {</span>
<span class="fc" id="L270">					SettleApportionRule rule = dealDataFormat(dataList.get(j), operatorId);</span>
<span class="pc bpc" id="L271" title="1 of 2 branches missed.">					if (!this.addSettleApportionRule(rule)) {</span>
<span class="nc" id="L272">						resultMap.put(RESULT, FALSE);</span>
<span class="nc bnc" id="L273" title="All 2 branches missed.">						if (counter &gt; 1) {</span>
<span class="nc" id="L274">							resultMap.put(ERROR, &quot;导入前&quot; + (counter - 1) + &quot;行摊分规则成功,执行至第&quot; + counter + &quot;行停止,生失效时间冲突,请检查!&quot;);</span>
						} else {
<span class="nc" id="L276">							resultMap.put(ERROR, &quot;导入摊分规则失败,执行至第&quot; + counter + &quot;行停止,生失效时间冲突,请检查!&quot;);</span>
						}
<span class="nc" id="L278">						return resultMap;</span>
					}
<span class="fc" id="L280">				} else {</span>
<span class="nc" id="L281">					throw new ExcelParseException(&quot;该行有数据为空，请检查！&quot;);</span>
				}

<span class="fc" id="L284">				counter++;</span>
			}
<span class="fc" id="L286">			resultMap.put(RESULT, TRUE);</span>
<span class="fc" id="L287">			resultMap.put(&quot;msg&quot;, &quot;导入摊分规则成功,成功导入&quot; + (counter - 1) + &quot;条规则&quot;);</span>
<span class="nc" id="L288">		} catch (ExcelParseException | BiffException | IOException e) {</span>
<span class="nc" id="L289">			LOGGER.debug(&quot;Excel文件格式转换异常&quot; + e.getMessage());</span>
<span class="nc" id="L290">			resultMap.put(RESULT, FALSE);</span>
<span class="nc" id="L291">			resultMap.put(ERROR, &quot;导入摊分规则执行至第&quot; + counter + &quot;行停止,&quot; + e.getMessage());</span>
<span class="fc" id="L292">		}</span>
<span class="fc" id="L293">		return resultMap;</span>

	}

	private SettleApportionRule dealDataFormat(String[] data, Integer operatorId) {
<span class="fc" id="L298">		Map&lt;String, Integer&gt; statusMap = getDicIdMap(1004);</span>
<span class="fc" id="L299">		Map&lt;String, Integer&gt; cdrTypeMap = getDicIdMap(1001);</span>
<span class="fc" id="L300">		Map&lt;String, Integer&gt; scopeMap = getDicIdMap(1019);</span>
<span class="fc" id="L301">		String[] s = data;</span>
<span class="fc" id="L302">		SettleApportionRule rule = new SettleApportionRule();</span>
<span class="pc bpc" id="L303" title="1 of 2 branches missed.">		if (length(s[0]) &gt; 32) {</span>
<span class="nc" id="L304">			throw new ExcelParseException(&quot;规则名称太长或为空，请检查！&quot;);</span>
		} else {
<span class="fc" id="L306">			rule.setApportionRuleName(s[0]);</span>
		}
<span class="pc bpc" id="L308" title="1 of 2 branches missed.">		if (cdrTypeMap.get(s[1]) == null) {</span>
<span class="nc" id="L309">			throw new ExcelParseException(&quot;资费类型信息不匹配，请检查！&quot;);</span>
		} else {
<span class="fc" id="L311">			rule.setCdrType(cdrTypeMap.get(s[1]));</span>
		}
<span class="pc bpc" id="L313" title="1 of 2 branches missed.">		if (scopeMap.get(s[2]) == null) {</span>
<span class="nc" id="L314">			throw new ExcelParseException(&quot;规则范围信息不匹配，请检查！&quot;);</span>
		} else {
<span class="fc" id="L316">			rule.setScope(scopeMap.get(s[2]));</span>
		}
<span class="pc bpc" id="L318" title="2 of 4 branches missed.">		if (Double.valueOf(s[3]) &gt; 1 || Double.valueOf(s[3]) &lt; 0) {</span>
<span class="nc" id="L319">			throw new ExcelParseException(&quot;摊分比例应该0~1之间，请检查！&quot;);</span>
		} else {
<span class="fc" id="L321">			rule.setRatio(Double.valueOf(s[3]));</span>
		}
		try {
<span class="fc" id="L324">			rule.setInureDate(sdf.parse(s[4]));</span>
<span class="fc" id="L325">			rule.setExpireDate(sdf.parse(s[5]));</span>
<span class="nc" id="L326">		} catch (ParseException e) {</span>
<span class="nc" id="L327">			throw new ExcelParseException(&quot;生效时间或失效时间格式错误，请检查！&quot;);</span>
<span class="fc" id="L328">		}</span>
<span class="pc bpc" id="L329" title="1 of 2 branches missed.">		if (statusMap.get(s[6]) == null) {</span>
<span class="nc" id="L330">			throw new ExcelParseException(&quot;规则状态信息不匹配，请检查！&quot;);</span>
		} else {
<span class="fc" id="L332">			rule.setStatus(statusMap.get(s[6]));</span>
		}
<span class="pc bpc" id="L334" title="1 of 2 branches missed.">		if (length(s[7]) &gt; 512) {</span>
<span class="nc" id="L335">			throw new ExcelParseException(&quot;备注太长，请检查！&quot;);</span>
		} else {
<span class="fc" id="L337">			rule.setApportionDesc(s[7]);</span>
		}
<span class="fc" id="L339">		rule.setOperatorId(operatorId);</span>
<span class="fc" id="L340">		return rule;</span>
	}

	/**
	 * 计算字符串字符长度
	 * 
	 * @param str
	 * @return
	 */
	private int length(String str) {
<span class="fc" id="L350">		int strLength = 0;</span>
<span class="fc" id="L351">		String chinese = &quot;[\u0391-\uFFE5]&quot;;</span>
		/* 获取字段值的长度，如果含中文字符，则每个中文字符长度为2，否则为1 */
<span class="fc bfc" id="L353" title="All 2 branches covered.">		for (int i = 0; i &lt; str.length(); i++) {</span>
			/* 获取一个字符 */
<span class="fc" id="L355">			String temp = str.substring(i, i + 1);</span>
			/* 判断是否为中文字符 */
<span class="fc bfc" id="L357" title="All 2 branches covered.">			if (temp.matches(chinese)) {</span>
				/* 中文字符长度为2 */
<span class="fc" id="L359">				strLength += 2;</span>
			} else {
				/* 其他字符长度为1 */
<span class="fc" id="L362">				strLength += 1;</span>
			}
		}
<span class="fc" id="L365">		return strLength;</span>
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.1.201803210924</span></div></body></html>